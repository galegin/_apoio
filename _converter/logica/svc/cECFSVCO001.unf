;-------------------------------
entry espacoDireita
;-------------------------------	
	params
		string vDsFormaPgto : IN
		numeric vTam        : IN
		string vDsRetorno   : OUT
	endparams
	variables
		numeric vCont, vTamFormaPgto
	endvariables
	length vDsFormaPgto
	vTamFormaPgto = $result 
	vCont = 0
	repeat
		vCont = vCont + 1
		if (vCont <= vTamFormaPgto)
			vDsRetorno = "%%vDsRetorno%%vDsFormaPgto[vCont,vCont]"	
		else
			vDsRetorno = "%%vDsRetorno%%% "
		endif
	until(vCont = vTam)
	return(0)
end;

;-------------
operation INIT 
	;-------------
	variables
		string viParams, voParams, vFlag
		numeric vPadraoECF, vCdEmpresa
	endvariables
	
	if ($item("PADRAO_ECF",$$gParamGlb) != "")
		return(0)
	endif
	
	viParams = ""
	voParams = ""
	vCdEmpresa = $item("CD_EMPRESA",$$gParamGlb)
	putitem viParams, -1, "PADRAO_ECF"
	putitem viParams, -1, "IN_HOMOLOGACAO_AM"
	activate "ADMSVCO001".GetParamEmpresa(vCdEmpresa, viParams, voParams, $xCdErro$, $xCtxerro$)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		return(-1)
	elseif ($xCdErro$)
		$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=%%$item("DESCRICAO", $xCtxErro$)", "ADICIONAL=Operação->ECFSVCO001.Init")
		return(-1)
	elseif ($status < 0)
		return(-1)
	endif
	$inHomologacaoAM$ = $item("IN_HOMOLOGACAO_AM",voParams)
	vPadraoECF = $item("PADRAO_ECF",voParams)
	putitem/id $$gParamGlb, "PADRAO_ECF", vPadraoECF
	return(0)
End ; operation INIT

;-------------------------
public operation ABREPORTA 
	;-------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		activate "%%vCdComponente".AbrePorta(piParams,poParams,poCdErro,poCtxErro)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
			return(vStatus)
		endif
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	return (0)
End ; operation ABREPORTA

;-------------------------
public operation FECHAPORTA 
	;-------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		activate "%%vCdComponente".FechaPorta(piParams,poParams,poCdErro,poCtxErro)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
			return(vStatus)
		endif
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	return (0)
End ; operation FECHAPORTA

;-------------------------
public operation ABRECUPOM 
	;-------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	message/hint "Preparando impressão de cupom fiscal..."
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".AbreCupom(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro,poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation ABRECUPOM

;-------------------------
public operation VENDEITEM 
	;-------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
		time vInicio, vFim
		boolean vInConcomitante
	endvariables

	vInConcomitante = $item("IN_CONCOMITANTE", piParams) ;* Claudemir

	;* Claudemir - Prj/Tarefa: 102/756
	;if ($item("IN_LOG_TEMPO_VENDA", $$gParamGlb) = 1)
	;	vinicio = $clock
	;	putmess "ECFSVCOO01: VENDEITEM - Inicio le informacao da impressora %%vInicio"
	;endif ;*

	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif

	;* Claudemir - Prj/Tarefa: 102/756
	;if ($item("IN_LOG_TEMPO_VENDA", $$gParamGlb) = 1)
	;	vFim = $clock
	;	putmess "ECFSVCOO01: VENDEITEM - Fim Le informacao impressora %%vFim"
	;endif ;*		

	;* Claudemir - Prj/Tarefa: 102/756
	;if ($item("IN_LOG_TEMPO_VENDA", $$gParamGlb) = 1)
	;	vinicio = $clock
	;	putmess "ECFSVCOO01: VENDEITEM - inicio comunicacao monitor vendeItem(%%vCdComponente) %%vInicio"	
	;endif ;*

	putitem/id piParams, "IN_CONCOMITANTE", vInConcomitante ;* Claudemir
	activate "%%vCdComponente".VendeItem(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif

	;* Claudemir - Prj/Tarefa: 102/756
	;if ($item("IN_LOG_TEMPO_VENDA", $$gParamGlb) = 1)
	;	vFim = $clock 
	;	putmess "ECFSVCOO01: VENDEITEM - Fim Comunicacao monitor vendeItem(%%vCdComponente) %%vFim"
	;endif ;*

	return (0)
End ; operation VENDEITEM

;--------------------------
public operation FECHACUPOM 
	;--------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".FechaCupom(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	message/hint "Finalizando impressão de cupom fiscal..."
	return (0)
End ; operation FECHACUPOM

;----------------------------
public operation CANCELACUPOM 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".CancelaCupom(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation CANCELACUPOM

;---------------------------
public operation CANCELAITEM 
	;---------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".CancelaItem(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation CANCELAITEM

;--------------------------------------
public operation ACRESCIMODESCONTOCUPOM 
	;--------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
		boolean vInConcomitante
	endvariables

	vInConcomitante = $item("IN_CONCOMITANTE",piParams) ;* Claudemir - Prj/Tarefa: 26/31 - 25/11/2009
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	putitem/id piParams, "IN_CONCOMITANTE", vInConcomitante ;* Claudemir - Prj/Tarefa: 26/31 - 25/11/2009
	activate "%%vCdComponente".AcrescimoDescontoCupom(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation ACRESCIMODESCONTOCUPOM

;------------------------------
public operation FORMAPAGAMENTO 
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".FormaPagamento(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation FORMAPAGAMENTO

;------------------------
public operation REDUCAOZ 
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".ReducaoZ(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation REDUCAOZ

;------------------------------
public operation REGISTROTIPO60
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".REGISTROTIPO60(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation REDUCAOZ

;------------------------
public operation LEITURAX 
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".LeituraX(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LEITURAX

;------------------------
public operation FECHAMENTODODIA
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".FechamentoDoDia(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation FechamentoDoDia


;------------------------
public operation RELATORIOTIPO60ANALITICO
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".RelatorioTipo60Analitico(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation RELATORIOTIPO60ANALITICO

;------------------------
public operation RELATORIOTIPO60MESTRE
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".RelatorioTipo60Mestre(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation RELATORIOTIPO60MESTRE

;------------------------
public operation LEITURAMEMORIAFISCALREDUCAO
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".LEITURAMEMORIAFISCALREDUCAO(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LEITURAMEMORIAFISCALREDUCAO

;------------------------
public operation LEITURAMEMORIAFISCALSERIALRED
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".LEITURAMEMORIAFISCALSERIALRED(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LEITURAMEMORIAFISCALSERIALRED

;------------------------
public operation LEITURAMEMORIAFISCALDATA
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".LEITURAMEMORIAFISCALDATA(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LEITURAMEMORIAFISCALDATA

;------------------------
public operation LEITURAMEMORIAFISCALSERIALDATA
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".LEITURAMEMORIAFISCALSERIALDATA(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LEITURAMEMORIAFISCALSERIALDATA

;-----------------------------------
public operation ABRECOMPROVANTENFV 
	;-----------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".AbreComprovanteNFV(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation ABRECOMPROVANTENFV

;---------------------------------
public operation REGISTRANAOFISCAL 
	;---------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".RegistraNaoFiscal(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation REGISTRANAOFISCAL

;---------------------------------------
public operation LEINFORMACAOIMPRESSORA 
	;---------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente, vEOF, vDsLinha, vDsRetorno
		boolean vInSair
		date vDtMovimentoECF
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		if ($item("NM_FUNCAO",piParams) = "<ECF_NUMERO_CUPOM>")
			putitem/id piParams,"TP_INFO", "023"
		elseif ($item("NM_FUNCAO",piParams) = "<ECF_NUMERO_SERIE>") | ($item("NM_FUNCAO",piParams) = "<ECF_NUMERO_SERIE_C>")
			putitem/id piParams,"TP_INFO", "002"
		endif
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	activate "%%vCdComponente".LeInformacaoImpressora(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	
	return (0)
End ; operation LEINFORMACAOIMPRESSORA

;-------------------------------------
public operation ACRESCIMODESCONTOITEM 
	;-------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	;* Claudemir - Prj/Tarefa: 191/1 - 27/09/2011
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"  ;*
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".AcrescimoDescontoItem(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	
	return (0)
End ; operation ACRESCIMODESCONTOITEM

;------------------------------
public operation VERIFICAESTADO 
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams    
	variables
		string vCdComponente, vDsRetorno, vEOF, vDsLinha
		boolean vInSair
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	;viParams = ""
	;putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
	;activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
	;if ($procerror)
	;    $instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
	;    poCdErro = $xCdErro$
	;    poCtxErro = $xCtxErro$
	;    return(-1)
	;elseif($status < 0)
	;    vStatus = $status
	;    $instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
	;    poCdErro = $xCdErro$
	;    poCtxErro = $xCtxErro$
	;    return(vStatus)
	;endif
	;vDsSerie = $item("NR_SERIE", voParams)
	;clear/e "FIS_ECFSVC"
	;CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
	;retrieve/e "FIS_ECFSVC"
	;if ($status < 0)
	;    $instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
	;    poCdErro = $xCdErro$
	;    poCtxErro = $xCtxErro$
	;    return(-50)        
	;endif
	
	activate "%%vCdComponente".VerificarEstado(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation VERIFICAESTADO

;---------------------------------
public operation IMPRIMIRVINCULADO
	;---------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".ImprimeVinculado(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation ImprimirVinculado

;------------------------------------------
public operation ImprimirRelatorioGerencial 
	;------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif    
	
	activate "%%vCdComponente".ImprimirRelatorioGerencial(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation ImprimirRelatorioGerencial

;------------------------------------------
public operation FechaRelatorioGerencial 
	;------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".FechaRelatorioGerencial(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation FechaRelatorioGerencial

;------------------------------
public operation FECHAVINCULADO
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".FechaVinculado(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation FechaVinculado

;------------------------------
public operation SUPRIMENTO 
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	activate "%%vCdComponente".Suprimento(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation SUPRIMENTO

;------------------------------
public operation ABERTURADODIA 
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)    
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".AberturadoDia(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation ABERTURADODIA

;------------------------------
public operation SANGRIA 
	;------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".Sangria(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation SANGRIA

;----------------------------
public operation INICIAMODOTEF 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif

	activate "%%vCdComponente".iniciaModoTEF(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation INICIAMODOTEF

;----------------------------
public operation FINALIZAMODOTEF 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".finalizaModoTEF(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation FINALIZAMODOTEF

;-------------------------------------------------------------------------
;LSC (09/11/2006) - Tarefa: 11 - Projeto: 26 - Abrir Gaveta Impressora ECF
;-------------------------------------------------------------------------
public operation abreGaveta 
	;-------------------------------------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	;-=CANONICO=- 16/09/2010 - TAR 942 / PRJ 102
	if ($item("IN_ABRE_GAVETA_VENDA",$$gParamGlb) = 0 ) & ($item("IN_RECEBTITULO",piParams) != <TRUE>) ;0 não abre - 1 abre gaveta
		return(0)
	endif

	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".abreGaveta(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation abreGaveta

;-------------------------------------------------------------------------
;LSC (13/12/2006) - Tarefa: 126 - Projeto: 41 - Programa horário verão
;-------------------------------------------------------------------------
public operation progHoraVerao 
	;-------------------------------------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif    
	
	activate "%%vCdComponente".progHoraVerao(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation progHoraVerao

;----------------------------
public operation RELATORIOSINTEGRAMFD 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".relatorioSintegraMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation RELATORIOSINTEGRAMFD

;----------------------------
public operation GERARELATORIOSINTEGRAMFD 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".geraRelatorioSintegraMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation GERARELATORIOSINTEGRAMFD

;----------------------------
public operation DOWNLOADMFD 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".downloadMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation DOWNLOADMFD

;----------------------------
public operation DATAHORAIMPRESSORA 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".dataHoraImpressora(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation DATAHORAIMPRESSORA

;----------------------------
public operation DATAMOVIMENTO 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif

	activate "%%vCdComponente".dataMovimento(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation DATAMOVIMENTO

;----------------------------
public operation DATAMOVIMENTOULTIMAREDUCAO 
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	;viParams = ""
	;putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
	;activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
	;if ($procerror)
	;    $instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
	;    poCdErro = $xCdErro$
	;    poCtxErro = $xCtxErro$
	;    return(-1)
	;elseif($status < 0)
	;    vStatus = $status
	;    $instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
	;    poCdErro = $xCdErro$
	;    poCtxErro = $xCtxErro$
	;    return(vStatus)
	;endif
	;vDsSerie = $item("NR_SERIE", voParams)
	;clear/e "FIS_ECFSVC"
	;CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
	;retrieve/e "FIS_ECFSVC"
	;if ($status < 0)
	;    $instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
	;    poCdErro = $xCdErro$
	;    poCtxErro = $xCtxErro$
	;    return(-50)        
	;endif
	
	activate "%%vCdComponente".dataMovimentoUltimaReducao(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation DATAMOVIMENTOULTIMAREDUCAO

;------------------------------------------------------
public operation ATIVADESATIVAGUILHOTINA 
	;--------------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	activate "%%vCdComponente".ativaDesativaGuilhotina(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	
	return (0)
End ; operation ATIVADESATIVAGUILHOTINA


;-------------------------------------------------------------------------
;-=LSC=- (08/04/2008) TAR 230 PRJ 61
public operation geraRegistrosCAT52MFD
	;---------------------------------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif    
	
	activate "%%vCdComponente".geraRegistrosCAT52MFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)

end;operation geraRegistrosCAT52MFD

;------------------------------------------
;-=LSC=- (29/08/2008) TAR 388 PRJ 102
public operation abreRelatorioGerencial
	;------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif    
	
	activate "%%vCdComponente".abreRelatorioGerencial(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation abreRelatorioGerencial


;------------------------------------------
;-=LSC=- (18/09/2008) TAR 397 PRJ 102
public operation verificaTermica
	;------------------------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif    
	
	activate "%%vCdComponente".verificaTermica(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation verificaTermica

;------------------------
public operation LeituraMemoriaFiscalDataMFD
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".LeituraMemoriaFiscalDataMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LeituraMemoriaFiscalDataMFD

;------------------------
public operation LeituraMemoriaFiscalReducaoMFD
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".LeituraMemoriaFiscalReducaoMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation LeituraMemoriaFiscalReducaoMFD


;------------------------
public operation leMemoriaFiscalSerialReducaoMFD
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif

	activate "%%vCdComponente".leMemoriaFiscalSerialReducaoMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation leMemoriaFiscalSerialReducaoMFD

;------------------------
public operation leMemoriaFiscalSerialDataMFD
	;------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams
	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie
	endvariables
	
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	activate "%%vCdComponente".leMemoriaFiscalSerialDataMFD(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif
	return (0)
End ; operation leMemoriaFiscalSerialDataMFD


;----------------------------
public operation geraAtoCotep
	;----------------------------
	params
		string piParams :IN
		string poParams :OUT
		string poCdErro :OUT
		string poCtxErro :OUT
	endparams

	variables
		string vCdComponente
		numeric vStatus
		string viParams, voParams, vDsSerie, vTpDownload
	endvariables

	viParams = ""
	vTpDownload	= $item("TP_DOWNLOAD", piParams) ;* Claudemir - Prj/Tarefa: 102/875 - 26/05/2010
	vCdComponente = ""        
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		vCdComponente = "ECFSVCO002"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_AFRAC>)
		vCdComponente = "ECFSVCO005"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_YANCO>)
		vCdComponente = "ECFSVCO006"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCAL>)
		vCdComponente = "ECFSVCO011"
	elseif ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_LOCALIMPFIM>)
		vCdComponente = "ECFSVCO011"
	else
		$instancehandle->SetErroApl("ERRO=ECF0001",poCdErro,poCtxErro)
	endif
	
	if ($item("PADRAO_ECF",$$gParamGlb) = <PADRAO_BEMATECH> | $item("PADRAO_ECF",$$gParamGlb) = "")
		viParams = ""
		if ($inHomologacaoAM$ = <TRUE>)
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE_C>
		else
			putitem/id viParams, "NM_FUNCAO", <ECF_NUMERO_SERIE>
		endif
		activate "%%vCdComponente".LeInformacaoImpressora(viParams,voParams,$xCdErro$,$xCtxerro$)
		if ($procerror)
			$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-1)
		elseif($status < 0)
			vStatus = $status
			$instancehandle->SetStatus(<STS_ERRO>, $xCdErro$,$xCtxerro$, "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(vStatus)
		endif
		vDsSerie = $item("NR_SERIE", voParams)
		clear/e "FIS_ECFSVC"
		CD_SERIEFAB.FIS_ECFSVC/init = vDsSerie
		retrieve/e "FIS_ECFSVC"
		if ($status < 0)
			$instancehandle->SetStatus(<STS_ERRO>, "GEN0001", "DESCRICAO=ECF inválida para o sistema - contate suporte!", "")
			poCdErro = $xCdErro$
			poCtxErro = $xCtxErro$
			return(-50)        
		endif
	endif
	
	putitem/id viParams, "TP_DOWNLOAD", vTpDownload ;* Claudemir - Prj/Tarefa: 102/875 - 26/05/2010
	activate "%%vCdComponente".geraAtoCotep(piParams,poParams,poCdErro,poCtxErro)
	if ($procerror)
		$instancehandle->SetStatus(<STS_ERRO>, $procerror, $procerrorcontext, "")
		poCdErro = $xCdErro$
		poCtxErro = $xCtxErro$
		return(-1)
	elseif($status < 0)
		vStatus = $status
		$instancehandle->SetStatus(<STS_ERRO>, poCdErro, poCtxErro, "")
		return(vStatus)
	endif

	return (0)
End ; operation geraAtoCotep
