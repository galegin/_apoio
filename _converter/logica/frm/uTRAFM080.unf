Listing of compilation: Form 'TRAFM080'  at 30-Jan-2012 08:24:30

[         1]              #include defparam

Trigger <DEFN> from Form: TRAFM080

[        41]              #info symbol TEMPLATENAME is already or also defined as a global or local constant
[        52]              #info symbol FRM_GENERICA is already or also defined as a global or local constant
[        58]              #info symbol UNQ_FRM_GENERICA is already or also defined as a global or local constant

Trigger <EXEC> from Form: TRAFM080

[         1]              params
[         2]                 string  piParams:IN
[         3]                 string  poParams:OUT
[         4]                 numeric poCdErro:OUT
[         5]                 string  poCtxErro:OUT
[         6]              endparams
[         7]              #include LIB_PADRAO:VLD_NIVEL_USR
[I1:      5]     1        		activate "LOGSVCO003".GetNivelComponente($$gCdUsuario,$$gCdEmpresa,$componentName,$xCdNivel$,$xCdErro$,$xCtxErro$)
[I1:      6]     2-1      		if ($procerror)
[I1:      7]     3-1      			$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=LOGSVCO003.GETNIVELCOMPONENTE")
[I1:      8]     4-1      		elseif ($xCdNivel$=0)
[I1:      9]     5-1      			$instancehandle->SetStatus(-1,"APL0009","","ADICIONAL=%%$formtitle")
[I1:     10]     6-1      			exit(-1)
[I1:     11]     7-1      		endif
[         8]     8        call PreEdit()
[         9]     9        edit
[        10]    10        call PosEdit()

Trigger <ERAS> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_ERASE
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Excluir")
[I1:      3]     2        	return (-1)

Trigger <QUIT> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_QUIT
[I1:      5]     1        	call PreQuit()
[I1:      6]     2-1      	if ($status >= 0)	
[I1:      7]     3-2      		if ($formmod & $editmode = 0)
[I1:      8]     4-2      			askmess "Existem manutenções pendentes. Deseja sair e perder as alterações?","Sair,Cancelar" 
[I1:      9]     5-3      			if ($status = 1)
[I1:     10]     6-3      				rollback
[I1:     11]     7-3      				commit
[I1:     12]     8-3      				exit(-1)
[I1:     13]     9-3      			else
[I1:     14]    10-3      				return (-1) 
[I1:     15]    11-3      			endif
[I1:     16]    12-2      		else
[I1:     17]    13-2      			rollback
[I1:     18]    14-2      			commit
[I1:     19]    15-2      			exit(-1)
[I1:     20]    16-2      		endif
[I1:     21]    17-1      		return ($status)
[I1:     22]    18-1      	endif	

Trigger <STOR> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_STORE
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Salvar")

Trigger <RETS> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_RETRSEQ
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Consultar sequencial")

Trigger <RETR> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_RETRIEVE
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Consultar")

Trigger <CLR > from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_CLEAR
[I1:     11]     1        		call PreClear()
[I1:     12]     2-1      		if ($status >= 0)
[I1:     13]     3-1      			$instancehandle->Limpar()
[I1:     14]     4-2      			if ($procerror)
[I1:     15]     5-2      				$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:     16]     6-2      			else
[I1:     17]     7-2      				call PosClear()
[I1:     18]     8-2      			endif
[I1:     19]     9-1      		endif

Trigger <UKYS> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_USERKEY
[I1:      1]              variables
[I1:      2]              	string viParams, voParams, vCdCampoOri, vCdEntidadeOri, vCdComponenteOri
[I1:      3]              endvariables
[I1:      4]     1-1      if ($char = 60)
[I1:      5]     2-2      	if ($item("TP_PRIVILEGIO",$$gparamglb) = 2) | %\
[I1:      5]              		($item("TP_PRIVILEGIO",$$gparamglb) = 3)	
[I1:      7]              		;debug ;Ativa depuração do programa.
[I1:      8]     3-2      	endif
[I1:      9]     4-1      endif
[I1:     10]     5-1      if ($char = 100)
[I1:     11]     6-1      	message/info "Campo: %%$fieldname %%^ Entidade: %%$entname %%^ Componente: %%$componentname"
[I1:     12]     7-1      endif
[I1:     13]     8-1      if ($char = 101)
[I1:     14]     9-1      	vCdCampoOri = $item("CD_CAMPORELAC", $$gParamGlb)
[I1:     15]    10-1      	vCdEntidadeOri = $item("CD_ENTIDADERELAC", $$gParamGlb)
[I1:     16]    11-1      	vCdComponenteOri = $item("CD_COMPONENTERELAC", $$gParamGlb)	
[I1:     17]    12-2      	if (vCdCampoOri = $fieldname & vCdCampoOri != "") & (vCdEntidadeOri = $entname & vCdEntidadeOri != "") & (vCdComponenteOri = $componentname & vCdComponenteOri != "")
[I1:     18]    13-2      		message/info "Campo: %%vCdCampoOri %%^ Entidade: %%vCdEntidadeOri %%^ Componente: %%vCdComponenteOri"
[I1:     19]    14-2      	else
[I1:     20]    15-2      		putitem/id $$gParamGlb, "CD_CAMPORELAC", $fieldname
[I1:     21]    16-2      		putitem/id $$gParamGlb, "CD_ENTIDADERELAC", $entname
[I1:     22]    17-2      		putitem/id $$gParamGlb, "CD_COMPONENTERELAC", $componentname	
[I1:     23]    18-2      	endif
[I1:     24]    19-1      endif
[I1:     25]    20-1      if ($char = 102)
[I1:     26]    21-1      	vCdCampoOri = $item("CD_CAMPORELAC", $$gParamGlb)
[I1:     27]    22-1      	vCdEntidadeOri = $item("CD_ENTIDADERELAC", $$gParamGlb)
[I1:     28]    23-1      	vCdComponenteOri = $item("CD_COMPONENTERELAC", $$gParamGlb)
[I1:     29]    24-2      	if (vCdCampoOri = "" | vCdEntidadeOri = "" | vCdComponenteOri = "")
[I1:     30]    25-2      		message/error "Nenhum campo origem selecionado(CRTL + O)!"
[I1:     31]    26-2      		return(-1)
[I1:     32]    27-2      	endif
[I1:     33]    28-2      	if (vCdComponenteOri = $componentname)
[I1:     34]    29-2      		message/error "Relacionamento não pode ser feitos entre campos do mesmo componente - %%$componentname!"
[I1:     35]    30-2      		return(-1)
[I1:     36]    31-2      	endif
[I1:     37]    32-1      	askmess "Relacionar %%vCdCampoOri / %%vCdEntidadeOri / %%vCdComponenteOri com %%$fieldname / %%$entname / %%$componentname%%%?"
[I1:     38]    33-2      	if ($status = 1)
[I1:     39]    34-2      		viParams = ""    
[I1:     40]    35-2      		putitem/id viParams, "CD_CAMPO", $fieldname
[I1:     41]    36-2      		putitem/id viParams, "CD_ENTIDADE", $entname
[I1:     42]    37-2      		putitem/id viParams, "CD_COMPONENTE", $componentname
[I1:     43]    38-2      		activate "ADMSVCO016".gravaRelacionamento($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[I1:     44]    39-3      		if ($procerror)       
[I1:     45]    40-3      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[I1:     46]    41-3      			return(-1)
[I1:     47]    42-3      		elseif ($status < 0)
[I1:     48]    43-3      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[I1:     49]    44-3      			return(-1)
[I1:     50]    45-3      		endif
[I1:     51]    46-2      		commit
[I1:     52]    47-3      		if ($status < 0)
[I1:     53]    48-3      			rollback
[I1:     54]    49-3      			return (-1) 
[I1:     55]    50-3      		else
[I1:     56]    51-3      			$instancehandle->SetHint("ID=APLINFO002")
[I1:     57]    52-3      		endif
[I1:     58]    53-2      	endif
[I1:     59]    54-1      endif
[I1:     60]    55-1      if ($char = 103)
[I1:     61]    56-1      	viParams = ""    
[I1:     62]    57-1      	putitem/id viParams, "CD_CAMPO", $fieldname	
[I1:     63]    58-1      	putitem/id viParams, "CD_ENTIDADE", $entname
[I1:     64]    59-1      	putitem/id viParams, "CD_COMPONENTE", $componentname
[I1:     65]    60-1      	putitem/id viParams, "DS_VALOR", @"%%$fieldname%%%.%%$entname"
[I1:     66]    61-1      	newinstance "ADMFM059", "ADMFM059A", "TRANSACTION=TRUE"
[I1:     67]    62-1      	activate "ADMFM059A".exec(viParams, voParams, $xCdErro$, $xCtxerro$)
[I1:     68]    63-2      	if ($procerror)       
[I1:     69]    64-2      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[I1:     70]    65-2      		return(-1)
[I1:     71]    66-2      	endif
[I1:     72]    67-1      endif
[         2]    68-1      selectcase $char
[         3]    69-1      	case 65
[         4]              ;		$instancehandle->BT_01()
[         5]              		#include LIB_PADRAO:DEF_FHELP
[I1:      1]    70-1      	$instancehandle->Ajuda()
[I1:      2]    71-2      	if ($procerror)
[I1:      3]    72-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]    73-2      	endif
[         6]    74-1      	case 66
[         7]    75-1      	$instancehandle->BT_02()
[         8]    76-2      		if ($procerror)
[         9]    77-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        10]    78-2      		endif	
[        11]              	
[        12]    79-1      	case 67
[        13]    80-2      		if ($inF3$ = "F")
[        14]    81-2      			return(-1)
[        15]    82-2      		endif
[        16]    83-1      		$instancehandle->BT_03()
[        17]    84-2      		if ($procerror)
[        18]    85-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        19]    86-2      		endif	
[        20]    87-1      	case 68
[        21]    88-2      		if ($inF4$ = "F")
[        22]    89-2      			return(-1)
[        23]    90-2      		endif
[        24]    91-1      		$instancehandle->BT_04()
[        25]    92-2      		if ($procerror)
[        26]    93-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        27]    94-2      		endif	
[        28]    95-1      	case 69
[        29]    96-1      		$instancehandle->BT_05()
[        30]    97-2      		if ($procerror)
[        31]    98-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        32]    99-2      		endif	
[        33]   100-1      	case 70
[        34]   101-2      		if ($inF6$ = "F")
[        35]   102-2      			return(-1)
[        36]   103-2      		endif
[        37]   104-1      		$instancehandle->BT_06()
[        38]   105-2      		if ($procerror)
[        39]   106-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        40]   107-2      		endif	
[        41]                    ;--- Elia 16/09/2010 Proj. 156/408
[        42]   108-2      		if ($status < 0)
[        43]   109-2      			$instancehandle->recarregaTransacao()
[        44]   110-3      			if ($procerror)
[        45]   111-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        46]   112-3      			endif    
[        47]   113-2      		endif
[        48]              		;
[        49]   114-1      	case 71
[        50]   115-2      		if ($inF7$ = "F")
[        51]   116-2      			return(-1)
[        52]   117-2      		endif
[        53]   118-1      		$instancehandle->BT_07()
[        54]   119-2      		if ($procerror)
[        55]   120-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        56]   121-2      		endif	
[        57]              		;thamati 12/05/2010 [Proj. 0156 - Tar. 0305]
[        58]   122-2      		if ($status < 0)
[        59]   123-2      			$instancehandle->recarregaTransacao()
[        60]   124-3      			if ($procerror)
[        61]   125-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        62]   126-3      			endif    
[        63]   127-2      		endif
[        64]              		;
[        65]   128-1      	case 72
[        66]   129-2      		if ($inF8$ = "F")
[        67]   130-2      			return(-1)
[        68]   131-2      		endif
[        69]   132-1      		$instancehandle->BT_08()
[        70]   133-2      		if ($procerror)
[        71]   134-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        72]   135-2      		endif	
[        73]   136-1      	case 73
[        74]   137-2      		if ($inF9$ = "F")
[        75]   138-2      			return(-1)
[        76]   139-2      		endif
[        77]   140-1      		$instancehandle->BT_09()
[        78]   141-2      		if ($procerror)
[        79]   142-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        80]   143-2      		endif	
[        81]   144-1      	case 74
[        82]   145-1      	case 75
[        83]   146-2      		if ($inF11$ = "F")
[        84]   147-2      			return(-1)
[        85]   148-2      		endif
[        86]   149-1      		$prompt = BT_F11.SIS_BOTOES
[        87]   150-1      		macro "^DETAIL"
[        88]              ;		$instancehandle->BT_11()
[        89]              ;		if ($procerror)
[        90]              ;			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        91]              ;		endif	
[        92]              ;		if($status < 0)
[        93]              ;			$prompt = TP_TRANSACAO.TRA_TRANSACAO	
[        94]              ;		endif    
[        95]   151-1      	case 76
[        96]   152-1      		macro "^DETAIL"
[        97]   153-1      	case 90
[        98]   154-1      		$instancehandle->BT_CTRL_D() ;Entrar com o  FCXFM005(despesas)
[        99]   155-2      		if ($procerror)
[       100]   156-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       101]   157-2      		endif	
[       103]   158-1      	case 92
[       104]   159-1      		$instancehandle->BT_CTRL_G() ;Entrar com TRAFM081(dados adicionais)
[       105]   160-2      		if ($procerror)
[       106]   161-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       107]   162-2      		endif	
[       108]              		
[       109]   163-1      	case 93;s
[       110]   164-1      		$instancehandle->BT_CTRL_S() ;Entrar com FCXFM006(retirada do caixa)
[       111]   165-2      		if ($procerror)
[       112]   166-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       113]   167-2      		endif
[       115]   168-1      	case 95;a
[       116]   169-1      		$instancehandle->BT_CTRL_A() ;Entrar com FCXFM006(retirada do caixa)
[       117]   170-2      		if ($procerror)
[       118]   171-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       119]   172-2      		endif
[       120]              		 	
[       121]   173-1      	case 96;t
[       122]   174-1      		$instancehandle->BT_CTRL_T() ;Detalhe troca
[       123]   175-2      		if ($procerror)
[       124]   176-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       125]   177-2      		endif
[       126]              		
[       127]   178-1      	case 97;o
[       128]   179-1      		$instancehandle->observacao() ;Chama TRAFM066, Observação
[       129]   180-2      		if ($procerror)
[       130]   181-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       131]   182-2      		endif		
[       133]   183-1      	case 98;ctrl+f11
[       134]   184-1      		$instancehandle->BT_CTRL_F11() ;Chama impressao
[       135]   185-2      		if ($procerror)
[       136]   186-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       137]   187-2      		endif
[       138]   188-1      	case 99 ;Ctrl+Q
[       139]   189-1      		$instancehandle->simulacao()
[       140]   190-2      		if ($procerror)
[       141]   191-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       142]   192-2      		endif    
[       143]   193-1      endselectcase

Trigger <PRNT> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_PRINT
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Imprimir")
[I1:      3]     2        	return (-1)

Trigger <ASYS> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_FASYNC
[I1:      1]     1        call PrcAsync($msgid,$msgdata)
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1          $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=PrcAsync")
[I1:      4]     4-1      endif

Trigger <LPMX> from Form: TRAFM080

[         1]              ;-------------------------
[         2]******        entry prcASYNC 
[         3]              	;-------------------------
[         4]              	
[         5]     1        End ; operation prcASYNC
[         7]              ;-------------------------
[         8]******        entry preCLEAR 
[         9]              	;-------------------------
[        10]              	
[        11]     1        End ; operation preCLEAR
[        13]              ;-------------------------
[        14]******        entry posCLEAR 
[        15]              	;-------------------------
[        17]              	variables
[        18]              		string viParams, voParams
[        19]              	endvariables
[        21]              	;* Claudemir - Prj/Tarefa: 191/2 - 07/10/2011
[        22]     1-1      	if ($tpCancelaTraAndamento$ = 1)
[        23]              		;>-- MAC - TAR 111 / 2010 - 03/11/2011 ---
[        24]              ;		clear/e "GER_OPERACAO"
[        25]              ;		CD_OPERACAO.GER_OPERACAO/init	= $cdOperacaoVenda$
[        26]              ;		retrieve/e "GER_OPERACAO"
[        27]              ;		if ($status >= 0)
[        28]              ;			if (TP_DOCTO.GER_OPERACAO = 3) ; ECF concomitante
[        29]              ;
[        30]              ;			endif
[        31]              ;		endif
[        33]     2-1      		viParams = ""
[        34]     3-1      		putitem/id viParams, "CD_OPERACAO", $cdOperacaoVenda$
[        35]     4-1      		activate "GERSVCO054".dadosAdicionaisOperacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[        36]     5-2      		if ($procerror)       
[        37]     6-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        38]     7-2      			return(-1)
[        39]     8-2      		elseif ($status < 0)
[        40]     9-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[        41]    10-2      			return(-1)
[        42]    11-2      		endif
[        43]              		
[        44]    12-2      		if ($item("TP_DOCTO", voParams) = 3)
[        45]    13-2      			$instancehandle->verificaTransacaoAberta()
[        46]    14-3      			if ($procerror)
[        47]    15-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        48]    16-3      				return(-1)
[        49]    17-3      			endif				
[        50]    18-2      		endif
[        51]              		;--<
[        52]    19-1      	endif ;*
[        54]    20        	$instancehandle->carregaDadosIniciais()
[        55]    21-1      	if ($procerror)
[        56]    22-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        57]    23-1      	endif
[        58]              	
[        59]              	;FIUZA - 20/12/05 - IMPRESSAO ECF CONCOMITANTE
[        60]    24        	$InCupomAberto$ = "N"
[        61]              	
[        62]              ;	;* Claudemir - Prj/Tarefa: 191/2 - 07/10/2011
[        63]              ;	if ($tpCancelaTraAndamento$ = 1)
[        64]              ;		clear/e "GER_OPERACAO"
[        65]              ;		CD_OPERACAO.GER_OPERACAO/init	= $cdOperacaoVenda$
[        66]              ;		retrieve/e "GER_OPERACAO"
[        67]              ;		if ($status >= 0)
[        68]              ;			if (TP_DOCTO.GER_OPERACAO = 3) ; ECF concomitante
[        69]              ;				$instancehandle->verificaTransacaoAberta()
[        70]              ;				if ($procerror)
[        71]              ;					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        72]              ;					return(-1)
[        73]              ;				endif				
[        74]              ;			endif
[        75]              ;		endif
[        76]              ;	endif ;*
[        78]    25        	return(0)
[        79]    26        End ; operation posCLEAR
[        81]              ;------------------------
[        82]******        entry preEDIT 
[        83]              ;------------------------
[        85]              	variables
[        86]              		string viParams, voParams
[        87]              	endvariables
[        88]              	
[        89]              	;--Hugo em 16/01/12 Tarefa 22-2001
[        90]     1        	viParams = ""
[        91]     2        	putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO", $$gParamGlb)
[        92]     3        	activate "PESSVCO015".buscaVendedorUsuario($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[        93]     4-1      	if ($procerror)       
[        94]     5-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        95]     6-1      		return(-1)
[        96]     7-1      	endif
[        97]              	
[        98]     8-1      	if ($item("CD_VENDEDOR", voParams) != 0)
[        99]     9-1      		$cdVendedor$ = $item("CD_VENDEDOR", voParams)
[       100]    10-1      	endif
[       101]              	;
[       102]              		
[       103]              	;* Claudemir - Prj/Tarefa: 191/2 - 07/10/2011
[       104]    11-1      	if ($tpCancelaTraAndamento$ = 1)
[       105]              		;>-- MAC - TAR 111 / 2010 - 03/11/2011 ---
[       106]              ;		clear/e "GER_OPERACAO"
[       107]              ;		CD_OPERACAO.GER_OPERACAO/init	= $cdOperacaoVenda$
[       108]              ;		retrieve/e "GER_OPERACAO"
[       109]              ;		if ($status >= 0)
[       110]              ;			if (TP_DOCTO.GER_OPERACAO = 3) ; ECF concomitante
[       111]              ;
[       112]              ;			endif
[       113]              ;		endif
[       114]              		
[       115]    12-1      		viParams = ""
[       116]    13-1      		putitem/id viParams, "CD_OPERACAO", $cdOperacaoVenda$
[       117]    14-1      		activate "GERSVCO054".dadosAdicionaisOperacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       118]    15-2      		if ($procerror)       
[       119]    16-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       120]    17-2      			return(-1)
[       121]    18-2      		elseif ($status < 0)
[       122]    19-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       123]    20-2      			return(-1)
[       124]    21-2      		endif
[       125]              		
[       126]    22-2      		if ($item("TP_DOCTO", voParams) = 3)
[       127]    23-2      			$instancehandle->verificaTransacaoAberta()
[       128]    24-3      			if ($procerror)
[       129]    25-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       130]    26-3      				return(-1)
[       131]    27-3      			endif				
[       132]    28-2      		endif
[       133]              		;--<
[       134]    29-1      	endif ;*
[       137]    30-1      	if ($tpValidacaoSaldoPed$ > 0)
[       138]    31-1      		$instancehandle->setStatus(-1, "GEN001", "DESCRICAO=Este componente não pode ser utilizado pois o parametro empresa TP_VALIDACAO_SALDO_PED está cadastrado como %%$tpValidacaoSaldoPed$%%%!", "")
[       139]    32-1      		exit(-1)
[       140]    33-1      	endif
[       142]    34        	$instancehandle->carregaDadosIniciais()
[       143]    35-1      	if ($procerror)
[       144]    36-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       145]    37-1      	endif
[       146]              	
[       147]    38        	$instancehandle->carregaListas()
[       148]    39-1      	if ($procerror)
[       149]    40-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       150]    41-1      	endif
[       151]              	
[       152]    42-1      	if ($status < 0)
[       153]    43-1      		exit(-1)
[       154]    44-1      	endif
[       155]              	
[       156]    45        	$inMostraTotal$ = "T"
[       157]              	
[       158]    46-1      	if ($cdOperacaoVenda$ = 0)
[       159]    47-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Operação de venda não cadastrada!", "ADICIONAL=Parâmetro->CD_OPER_ECF")
[       160]    48-1      		exit(-1)
[       161]    49-1      	endif
[       162]              	
[       163]    50-1      	if ($cdOperacaoValeTroca$ = 0)
[       164]    51-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Operação de vale troca não cadastrada!", "ADICIONAL=Parâmetro->CD_OPER_VALETROCA")
[       165]    52-1      		exit(-1)
[       166]    53-1      	endif
[       167]              	
[       168]    54-1      	if ($cdOperacaoTroca$ = 0)
[       169]    55-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Operação de vale troca não cadastrada!", "ADICIONAL=Parâmetro->CD_OPER_TROCA")
[       170]    56-1      		exit(-1)
[       171]    57-1      	endif
[       172]              	
[       173]              	;FIUZA - 20/12/05 - IMPRESSAO ECF CONCOMITANTE
[       174]    58        	$InCupomAberto$ = "N"
[       176]    59        	$instancehandle->efetivaTEFPendente()
[       177]    60-1      	if ($procerror)
[       178]    61-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       179]    62-1      	elseif ($status < 0)
[       180]    63-2      		if ($tpTEF$ = 2)
[       181]    64-2      			exit(-1)
[       182]    65-2      		endif	
[       183]    66-1      	endif
[       185]              ;	;* Claudemir - Prj/Tarefa: 191/2 - 07/10/2011
[       186]              ;	if ($tpCancelaTraAndamento$ = 1)
[       187]              ;;		clear/e "GER_OPERACAO"
[       188]              ;;		CD_OPERACAO.GER_OPERACAO/init	= $cdOperacaoVenda$
[       189]              ;;		retrieve/e "GER_OPERACAO"
[       190]              ;;		if ($status >= 0)
[       191]              ;;			if (TP_DOCTO.GER_OPERACAO = 3) ; ECF concomitante
[       192]              ;;
[       193]              ;;			endif
[       194]              ;;		endif
[       195]              ;
[       196]              ;		viParams = ""
[       197]              ;		putitem/id viParaMs, "CD_OPERACAO", $cdOperacaoVenda$
[       198]              ;		activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       199]              ;		if ($procerror)       
[       200]              ;			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       201]              ;			return(-1)
[       202]              ;		elseif ($status < 0)
[       203]              ;			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       204]              ;			return(-1)
[       205]              ;		endif
[       206]              ;		
[       207]              ;		if ($item("TP_DOCTO", voParams) = 3)
[       208]              ;			$instancehandle->verificaTransacaoAberta()
[       209]              ;			if ($procerror)
[       210]              ;				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       211]              ;				return(-1)
[       212]              ;			endif				
[       213]              ;		endif
[       214]              ;	endif ;*
[       215]              	
[       216]    67        	return(0)
[       217]    68        End ; operation preEDIT
[       219]              ;------------------------
[       220]******        entry posEDIT 
[       221]              	;------------------------
[       222]              	
[       223]     1        End ; operation posEDIT
[       225]              ;-------------------------
[       226]******        entry preERASE 
[       227]              	;-------------------------
[       228]              	
[       229]     1        End ; operation preERASE
[       231]              ;-------------------------
[       232]******        entry posERASE 
[       233]              	;-------------------------
[       234]              	
[       235]     1        End ; operation posERASE
[       237]              ;-------------------------
[       238]******        entry prePRINT 
[       239]              	;-------------------------
[       240]              	
[       241]     1        End ; operation prePRINT
[       243]              ;-------------------------
[       244]******        entry posPRINT 
[       245]              	;-------------------------
[       246]              	
[       247]     1        End ; operation posPRINT
[       249]              ;----------------------------
[       250]******        entry preRETRIEVE 
[       251]              	;----------------------------
[       252]              	
[       253]     1        End ; operation preRETRIEVE
[       255]              ;----------------------------
[       256]******        entry posRETRIEVE 
[       257]              	;----------------------------
[       258]              	
[       259]     1        End ; operation posRETRIEVE
[       261]              ;-------------------------
[       262]******        entry preSTORE 
[       263]              	;-------------------------
[       264]              	
[       265]     1        End ; operation preSTORE
[       267]              ;-------------------------
[       268]******        entry posSTORE 
[       269]              	;-------------------------
[       270]              	
[       271]     1        End ; operation posSTORE
[       273]              ;------------------------
[       274]******        entry preQUIT 
[       275]              	;------------------------
[       276]              	variables
[       277]              		string viParams, voParams
[       278]              	endvariables
[       280]              	;---Elia Proj. 102/434 29/10/08
[       281]              	;if ($inBloqExcluiItem$ = "T")
[       282]     1-1      	if ($inBloqExcluiItem$ = 1) | ($inBloqExcluiItem$ = 3)
[       283]              	;
[       284]     2-1      		viParams = ""
[       285]     3-1      		putitem/id viParams, "IN_USULOGADO", "T"
[       286]              		;putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO", $$gParamGlb)
[       287]     4-1      		putitem/id viParams, "DS_COMPONENTE", "TRAFM060EX"
[       288]     5-1      		activate "ADMFM020".exec(viParams, voParams, $xCdErro$, $xCtxerro$)
[       289]     6-2      		if ($procerror)  
[       290]     7-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")     
[       291]     8-2      			return (-1)
[       292]     9-2      		endif
[       293]    10-2      		if ($status < 0)
[       294]    11-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Função bloqueada!", "ADICIONAL=Parâmetro empresa->IN_BLOQ_EXCLUIR_ITEM")
[       295]    12-2      			return(-1)		
[       296]    13-2      		endif
[       297]    14-1      	else
[       298]    15-2      		if ($empty("TRA_TRANSACAO") = 0)
[       299]    16-2      			askmess "Deseja realmente sair?","Sair,Cancelar"
[       300]    17-3      			if ($status = 2) 
[       301]    18-3      				return (-1)
[       302]    19-3      			endif
[       303]    20-2      		endif
[       304]    21-1      	endif
[       305]              	
[       306]    22        	return(0)
[       307]    23        End ; operation preQUIT

Trigger <OPER> from Form: TRAFM080

[         1]              #include LIB_PADRAO:DEF_TEMPLATE
[I1:      1]              ;----------------------Tratamento de Erro---------------------
[I1:      2]              ; #include LIB_PADRAO:VLD_CONSTANTE
[I1:      3]               #include LIB_PADRAO:zSET_ERROPROC
[I2:      1]              ;----------------------------
[I2:      1]              #include LIB_PADRAO:DEF_TEMPLATE
[I1:      1]              ;----------------------Tratamento de Erro---------------------
[I1:      2]              ; #include LIB_PADRAO:VLD_CONSTANTE
[I1:      3]               #include LIB_PADRAO:zSET_ERROPROC
[I2:      1]              ;----------------------------
[I2:      2]******        partner operation SetErroProc
[I2:      3]              ;----------------------------
[I2:      4]              params
[I2:      5]                 string piCtxErro  : IN
[I2:      6]                 string pioCdErro  : INOUT
[I2:      7]                 string pioCtxErro : INOUT
[I2:      8]              endparams
[I2:      9]              variables
[I2:     10]                  string  vContext,vTopic,vOcc,vKey,vObject,vError,vStatus
[I2:     11]                  string  vErrorProc,vMnem,vComponent,vProcName,vTrigger,vLIne,vDescription,vAdditional
[I2:     12]                  string  vEntity,vMessage 
[I2:     13]                  string  vCtxErro,vField,vDsMensagem
[I2:     14]                  string  vDataErrorContext
[I2:     15]                  numeric vIdxMsg,vCdErro
[I2:     16]                  string  vMsgIgnorar
[I2:     17]              endvariables
[I2:     18]              ;Ignorar mensagens
[I2:     29]     1-1      if (piCtxErro != "")
[I2:     30]     2-2          if ($item("ERRO",piCtxErro) = "")
[I2:     31]     3-2              vCdErro = $item("ERROR",piCtxErro)
[I2:     32]     4-3              if (vCdErro = -35)
[I2:     33]     5-3                  vCdErro   = $item("ERRO",piCtxErro)
[I2:     34]     6-4      			if (vCdErro = "")
[I2:     35]     7-4      	            vCdErro   = $item("ERROR",piCtxErro)
[I2:     36]     8-4      			endif
[I2:     37]     9-3                  piCtxErro = $xctxerro$
[I2:     38]    10-3                  putitem/id piCtxErro,"ERROR",$xcderro$
[I2:     39]    11-3                  putitem/id piCtxErro,"CONTEXTO","PROC"
[I2:     40]    12-4      			if ($item("DESCRICAO",piCtxErro) = "")
[I2:     41]    13-4      	            putitem/id piCtxErro,"DESCRICAO","Erro na execução do comando"
[I2:     42]    14-4      			endif
[I2:     43]              ;            if (<TipoCmp> = "F")
[I2:     44]    15-3                      $instancehandle->SetErroApl(piCtxErro,pioCdErro,pioCtxErro)
[I2:     45]    16-3                      return (-1)
[I2:     46]              ;            endif
[I2:     47]    17-3              endif
[I2:     48]    18-3              if ($item("MENSAGEM",piCtxErro) = "")
[I2:     49]    19-3                  activate "INFSVCO001".PrcErroProc(vCdErro,vDsMensagem)
[I2:     50]    20-3              else
[I2:     51]    21-3                  vDsMensagem = $item("MENSAGEM",piCtxErro)
[I2:     52]    22-3              endif 
[I2:     54]    23-2              putitem/id vCtxErro, "ERRO"       ,$item("ERROR",piCtxErro)
[I2:     55]    24-2              putitem/id vCtxErro, "MENSAGEM"   ,vDsMensagem
[I2:     56]    25-2              putitem/id vCtxErro, "COMPONENTE" ,$item("COMPONENT",piCtxErro)
[I2:     57]    26-2              putitem/id vCtxErro, "NOMEPROC"   ,$item("PROCNAME",piCtxErro)
[I2:     58]    27-2              putitem/id vCtxErro, "ENTIDADE"   ,$entname
[I2:     59]    28-2              putitem/id vCtxErro, "CAMPO"      ,$fieldname       
[I2:     60]    29-2              putitem/id vCtxErro, "TRIGGER"    ,$item("TRIGGER",piCtxErro)
[I2:     61]    30-2              putitem/id vCtxErro, "LINHA"      ,$item("LINE",piCtxErro)
[I2:     62]    31-2              putitem/id vCtxErro, "DESCRICAO"  ,vDsMensagem
[I2:     63]    32-2              putitem/id vCtxErro, "CONTEXTO"   ,"PROC"
[I2:     64]    33-2              putitem/id vCtxErro, "ADICIONAL"  ,$item("ADDITIONAL",piCtxErro)
[I2:     65]    34-2              $instancehandle->ShowErro(vCdErro,vDsMensagem,vCtxErro)
[I2:     66]    35-2         else
[I2:     67]    36-2              vCdErro   = $item("ERRO",piCtxErro)
[I2:     68]    37-2              vCtxErro  = piCtxErro
[I2:     69]    38-3              if ("F" = "F")
[I2:     70]    39-3                  $instancehandle->ShowErro(vCdErro,vDsMensagem,vCtxErro)
[I2:     71]    40-3              endif 
[I2:     72]    41-2         endif 
[I2:     73]    42-1      endif
[I2:     74]    43        pioCdErro  = vCdErro
[I2:     75]    44        pioCtxErro = vCtxErro
[I2:     76]              ;return (vCdErro)
[I2:     77]    45        return (-1)
[I2:     78]    46        end ; SetErroProc
[I1:      4]              ; #include LIB_PADRAO:zSET_ERROVLDFLD
[I1:      5]              ; #include LIB_PADRAO:zSET_ERROVLDOCC
[I1:      6]               #include LIB_PADRAO:zSET_ERROAPL
[I2:      1]              ;--------------------------------
[I2:      2]******        partner operation GetLibDescrErro
[I2:      3]              ;--------------------------------
[I2:      4]              params
[I2:      5]                  string piCdErro   :IN
[I2:      6]                  string poDsErro   :OUT
[I2:      7]              endparams
[I2:      9]     1            poDsErro   = $text("VLDERR%%piCdErro") 
[I2:     10]     2-1          if (poDsErro[1,4] = 8006)
[I2:     11]     3-1              poDsErro = "" 
[I2:     12]     4-1          endif
[I2:     13]     5            return(0)
[I2:     14]     6        end ;GetLibDescrErro
[I2:     16]              ;------------------------------------------------
[I2:     17]******        partner operation SetErroApl
[I2:     18]              ;------------------------------------------------
[I2:     19]              params
[I2:     20]                 string piCtxErro  : IN
[I2:     21]                 string pioCdErro  : INOUT
[I2:     22]                 string pioCtxErro : INOUT
[I2:     23]              endparams
[I2:     24]              variables
[I2:     25]                  string vContext,vTopic,vOcc,vKey,vObject,vError,vStatus
[I2:     26]                  string vErrorProc,vMnem,vComponent,vProcName,vTrigger,vLIne,vDescription,vAdditional
[I2:     27]                  string vEntity,vMessage
[I2:     28]                  string vCdErro,vCtxErro,vId,vField,vIdxMsg,vMsgIgnorar
[I2:     29]                  string vDataErrorContext,vDetalhe,vConteudo
[I2:     30]              endvariables
[I2:     31]     1-1      if ($item("CONTEXTO",piCtxErro) = "")
[I2:     32]     2-1          getitem/id vId      , piCtxErro ,  "ID"           ;
[I2:     33]     3-1          getitem/id vError   , piCtxErro ,  "ERRO"         ;
[I2:     34]     4-1          getitem/id vMessage , piCtxErro ,  "MENSAGEM"     ;
[I2:     35]     5-1          getitem/id vDescription ,piCtxErro, "DESCRICAO"   ;
[I2:     37]     6-1          getitem/id vComponent   , piCtxErro , "COMPONENTE" ;COMPONENT
[I2:     38]     7-1          getitem/id vEntity      , piCtxErro , "ENTIDADE"   ;ENTIDADE
[I2:     39]     8-1          getitem/id vField       , piCtxErro , "CAMPO"      ;CAMPO
[I2:     40]     9-1          getitem/id vConteudo    , piCtxErro , "CONTEUDO"   ;CONTEUDO 
[I2:     41]    10-1          getitem/id vTrigger     , piCtxErro , "TRIGGER"    ;ENTIDADE
[I2:     42]    11-1          getitem/id vContext     , piCtxErro , "CONTEXTO"   ;CONTEXTO
[I2:     43]    12-1          getitem/id vAdditional  , piCtxErro , "ADICIONAL"  ;ADICIONAL
[I2:     44]    13-1          getitem/id vStatus      , piCtxErro , "STATUS"     ;STATUS
[I2:     46]    14-2      	if (vError = "")
[I2:     47]    15-2              vERROR = vID
[I2:     48]    16-2      	endif
[I2:     50]    17-2      	if (vID != "")
[I2:     51]    18-2              vDescription = $text("%%vId")
[I2:     52]    19-2      	endif
[I2:     54]              ;    if (vMessage = "") 
[I2:     55]              ;        vMessage = $text("%%vERROR")
[I2:     56]              ;    endif
[I2:     57]              ;    if (vDescription = "") 
[I2:     58]              ;        vDescription = vMessage
[I2:     59]              ;    endif
[I2:     70]    20-2          if (vContext = "VLDF") & (vConteudo = "")
[I2:     71]    21-2              vConteudo = @$fieldname
[I2:     72]    22-2          endif
[I2:     74]    23-2          if (vContext = "")
[I2:     75]    24-2              vContext = "APL"
[I2:     76]    25-2          endif
[I2:     77]    26-2          if (vError = "")
[I2:     78]    27-2              vError = -1
[I2:     79]    28-2          endif
[I2:     80]    29-2          if (vId != "" & vContext = "PROC")
[I2:     81]    30-2              $instancehandle->GetLibDescrErro(vId,vDescription)
[I2:     82]    31-2          elseif (vMessage = "") & (vDescription = "")
[I2:     83]    32-2              vId = 8006
[I2:     84]    33-2              $instancehandle->GetLibDescrErro(vId,vDescription)
[I2:     85]    34-2          endif
[I2:     86]                  ;if (vMessage = "") 
[I2:     87]                  ;    vMessage = vDescription
[I2:     88]                  ;endif
[I2:     89]    35-2          if (vComponent = "")
[I2:     90]    36-2              vComponent = $componentname
[I2:     91]    37-2          endif
[I2:     92]    38-2          if (vEntity = "")
[I2:     93]    39-2              vEntity = $entname
[I2:     94]    40-2          endif
[I2:     95]    41-2          if (vField = "")
[I2:     96]    42-2              vField = $fieldname
[I2:     97]    43-2          endif
[I2:     98]    44-2          if (vTrigger = "")
[I2:     99]    45-2              vTrigger = "OPER"  
[I2:    100]    46-2          endif
[I2:    102]    47-1          putitem/id vCtxErro , "ERRO"       ,vError       ;ERRO
[I2:    103]    48-1          putitem/id vCtxErro , "MENSAGEM"   ,vMessage     ;MENSAGEM
[I2:    104]    49-1          putitem/id vCtxErro , "COMPONENTE" ,vComponent   ;COMPONENT
[I2:    105]    50-1          putitem/id vCtxErro , "ENTIDADE"   ,vEntity      ;ENTIDADE
[I2:    106]    51-1          putitem/id vCtxErro , "CAMPO"      ,vField       ;CAMPO
[I2:    107]    52-1          putitem/id vCtxErro , "CONTEUDO"   ,vConteudo    ;CONTEUDO
[I2:    108]    53-1          putitem/id vCtxErro , "TRIGGER"    ,vTrigger     ;MENSAGEM
[I2:    109]    54-1          putitem/id vCtxErro , "DESCRICAO"  ,vDescription ;MENSAGEM
[I2:    110]    55-1          putitem/id vCtxErro , "ADICIONAL"  ,vAdditional  ;ADICIONAL
[I2:    111]    56-1          putitem/id vCtxErro , "CONTEXTO"   ,vContext     ;CONTEXTO
[I2:    112]    57-1          putitem/id vCtxErro , "STATUS"     ,vStatus      ;STATUS
[I2:    113]    58-1          putitem/id vCtxErro , "DETALHE"    ,vDetalhe     ;DETALHE
[I2:    114]    59-1          $instancehandle->ShowErro(vError,vDescription,vCtxErro)
[I2:    115]    60-1      else
[I2:    116]    61-1         vCtxErro = piCtxErro
[I2:    117]    62-1         getitem/id vError   , piCtxErro ,  "ERRO"
[I2:    118]    63-2         if (vError = "")
[I2:    119]    64-2      	   getitem/id vError   , piCtxErro ,  "ERROR"
[I2:    120]    65-2      	endif
[I2:    121]    66-1         getitem/id vMessage , piCtxErro ,  "DESCRICAO"
[I2:    122]    67-2         if ("F" = "F")
[I2:    123]    68-2             $instancehandle->ShowErro(vError,vMessage,vCtxErro)
[I2:    124]    69-2         endif
[I2:    125]    70-1      endif
[I2:    127]    71        pioCdErro  = vError
[I2:    128]    72        pioCtxErro = vCtxErro
[I2:    129]    73        return (vError)
[I2:    130]    74        End ; operation SetErroApl
[I1:      7]               #include LIB_PADRAO:zSET_HINT
[I2:      1]              ;----------------
[I2:      2]******        operation SetHint
[I2:      3]              ;----------------
[I2:      4]              params
[I2:      5]                  String pCtxHint :IN
[I2:      6]              endparams
[I2:      7]              variables
[I2:      8]                  string vMensagem,vId
[I2:      9]              endvariables
[I2:     10]     1        	getitem/id vId, pCtxHint,"ID"
[I2:     11]     2-1      	if (vId != "")
[I2:     12]     3-1      		vMensagem = $text("%%vId")
[I2:     13]     4-1      	else
[I2:     14]     5-1      		getitem/id vMensagem, pCtxHint, "MENSAGEM"
[I2:     15]     6-1      	endif
[I2:     16]     7-1          if ("F" = "F")
[I2:     17]              ;		message/hint "%%$componentname - %%vMensagem"
[I2:     18]     8-1      		$instancehandle->SetStatus(1,vId,"","")
[I2:     20]     9-1          elseif ("F" = "S")
[I2:     21]              ;        putmess "%%$componentname - %%vMensagem"
[I2:     22]    10-1      		$instancehandle->SetStatus(1,vId,"","")
[I2:     23]    11-1          endif
[I2:     24]    12            $instancehandle->ResetErro()
[I2:     25]    13        	return (0)
[I2:     50]    14        end ;SetHint
[I1:      8]               #include LIB_PADRAO:zSHOW_ERRO
[I2:      1]              ;22/07/04 	FSD	Desativado esta versão em para compatibilidade 
[I2:      2]              ;				com nova versao do tratamento de erro
[I2:      3]              ;
[I2:      4]              ;-------------------------
[I2:      5]              ;partner operation ShowErro 
[I2:      6]              ;-------------------------
[I2:      7]              ;	params
[I2:      8]              ;		string pCdErro  :INOUT
[I2:      9]              ;		string pDsErro  :INOUT
[I2:     10]              ;		string pCtxErro :INOUT
[I2:     11]              ;	endparams
[I2:     12]              ;	variables
[I2:     13]              ;		string vTpErro,vNmComponente,vDescricao
[I2:     14]              ;	endvariables
[I2:     15]              ;	vTpErro             = $item("CONTEXTO",pCtxErro)
[I2:     16]              ;	vNmComponente     = $item("COMPONENTE",pCtxErro)
[I2:     17]              ;	vDescricao         = $item("DESCRICAO",pCtxErro)
[I2:     18]              ;	;   #if <TipoCmp> = "F"
[I2:     19]              ;	if ($componenttype = "F")
[I2:     20]              ;		message/error "%%pCdErro - %%pDsErro"
[I2:     21]              ;		message/hint "Origem : %%vNmComponente Descrição:%%vDescricao"  
[I2:     22]              ;		putmess "%%vTpErro ERRO: %%pCtxErro" 
[I2:     23]              ;		pCdErro = ""
[I2:     24]              ;		pDsErro = ""
[I2:     25]              ;		pCtxErro = ""
[I2:     26]              ;	;   #elseif <TipoCmp> = "S"
[I2:     27]              ;	elseif($componenttype = "S")
[I2:     28]              ;		putmess "%%vTpErro ERRO: %%pCtxErro" 
[I2:     29]              ;	endif
[I2:     30]              ;return (pCdErro)
[I2:     31]              ;end ;ShowErro
[I2:     34]              ;-------------------------
[I2:     35]******        partner operation ShowErro 
[I2:     36]              ;-------------------------
[I2:     37]              	params
[I2:     38]              		string pCdErro  :INOUT
[I2:     39]              		string pDsErro  :INOUT
[I2:     40]              		string pCtxErro :INOUT
[I2:     41]              	endparams
[I2:     42]              	;FSD 17/07/04
[I2:     43]              	;Esta funçao foi reescrita para ficar no mesmo padrão de comportamento da ExibirMensagem.
[I2:     45]              	variables
[I2:     46]              		string vTpErro,vNmComponente,pId,pContexto
[I2:     47]                      string vDescricao,vTipo,vObjeto,vInfo,vDica,vLog,vAdicional,vDsTipo
[I2:     48]              	endvariables
[I2:     50]     1            pId 		= pCdErro
[I2:     51]     2            pContexto   = pCtxErro
[I2:     53]     3        	vTipo       = $item("TIPO"		,pContexto)
[I2:     54]     4        	vDescricao  = pDsErro	;item("DESCRICAO"	,pContexto)
[I2:     55]     5        	vInfo       = $item("INFO"		,pContexto)
[I2:     56]     6        	vDica       = $item("DICA"		,pContexto)
[I2:     57]     7        	vAdicional	= $item("ADICIONAL"	,pContexto)
[I2:     58]     8        	vLog		= $item("LOG"		,pContexto)
[I2:     59]     9        	vObjeto     = $item("OBJETO"		,vInfo)
[I2:     61]    10        	vTpErro       = $item("CONTEXTO",pCtxErro)
[I2:     62]    11        	vNmComponente = $item("COMPONENTE",pCtxErro)
[I2:     63]                  
[I2:     64]              	;	if ("F" = "F")
[I2:     65]              	;		message/error "%%pCdErro - %%pDsErro %%%(%%vDescricao%%%)"
[I2:     66]              	;		message/hint "Origem : %%vNmComponente Descrição:%%vDescricao"  
[I2:     67]              	;		putmess "%%vTpErro ERRO: %%pCtxErro" 
[I2:     68]              	;		pCdErro = ""
[I2:     69]              	;		pDsErro = ""
[I2:     70]              	;		pCtxErro = ""
[I2:     71]              	;	elseif("F" = "S")
[I2:     72]              	;		putmess "%%vTpErro ERRO: %%pCtxErro" 
[I2:     73]              	;	endif
[I2:     75]    12-1      if (vTipo = "")
[I2:     76]    13-1          vTipo = -1 
[I2:     77]    14-1      endif
[I2:     78]    15-1      if (vLog = "")
[I2:     79]    16-1          vLog = pCtxErro
[I2:     80]    17-1      endif
[I2:     81]    18-1      if (vTipo = 1)
[I2:     82]    19-1      	 vDsTipo = "DICA"
[I2:     84]    20-1         	     message/hint "%%pId - %%vDescricao %%vAdicional %%vDica" 
[I2:     86]    21-1         	 $status = 1
[I2:     87]    22-1      elseif (vTipo = 2)
[I2:     88]    23-1      	 vDsTipo = "AVISO"
[I2:     90]    24-1         	     message/warning "%%pId - %%vDescricao %%vAdicional"
[I2:     92]    25-1      	putmess "%%vDsTipo%%%-> %%pId"
[I2:     93]    26-1      	putmess "	DESCR	-> %%vDescricao"
[I2:     94]    27-1      	if (vAdicional != "")	putmess "	ADIC	-> %%vAdicional"
[I2:     95]    30-1      	if (vInfo != "")		putmess "	INFO	-> %%vInfo"
[I2:     96]    33-1      	if (vLog  != "") 		putmess "	LOG	-> %%vLog"
[I2:     97]    36-1      	putmess " "
[I2:     98]    37-1         	 $status = 2
[I2:     99]    38-1      elseif(vTipo = 3)
[I2:    100]    39-1      	 vDsTipo = "INFO"
[I2:    102]    40-1               message/info "%%pId - %%vDescricao %%vAdicional" 
[I2:    104]    41-1      	putmess "%%vDsTipo%%%-> %%pId"
[I2:    105]    42-1      	putmess "	DESCR	-> %%vDescricao"
[I2:    106]    43-1      	if (vAdicional != "")	putmess "	ADIC	-> %%vAdicional"
[I2:    107]    46-1      	if (vInfo != "")		putmess "	INFO	-> %%vInfo"
[I2:    108]    49-1      	if (vLog  != "") 		putmess "	LOG	-> %%vLog"
[I2:    109]    52-1      	putmess " "
[I2:    110]    53-1           $status = 3
[I2:    111]    54-1      elseif(vTipo = 4)
[I2:    112]    55-1      	putmess "%%vDsTipo%%%-> %%pId"
[I2:    113]    56-1      	putmess "	DESCR	-> %%vDescricao"
[I2:    114]    57-1      	if (vAdicional != "")	putmess "	ADIC	-> %%vAdicional"
[I2:    115]    60-1      	if (vInfo != "")		putmess "	INFO	-> %%vInfo"
[I2:    116]    63-1      	if (vLog  != "") 		putmess "	LOG	-> %%vLog"
[I2:    117]    66-1      	putmess " "
[I2:    118]    67-1          $status = 4
[I2:    119]    68-1      elseif (vTipo = -1)
[I2:    120]    69-1      	 vDsTipo = "ERRO"
[I2:    121]    70-2      	 if (pId = "-50") | (pId = "-58") | (pId = "-59")
[I2:    122]    71-2      	    vDescricao = "Componente em desenvolvimento!"
[I2:    123]    72-2      	 endif
[I2:    125]    73-1               message/error "%%pId - %%vDescricao %%vAdicional"
[I2:    127]    74-1      	putmess "%%vDsTipo%%%-> %%pId"
[I2:    128]    75-1      	putmess "	DESCR	-> %%vDescricao"
[I2:    129]    76-1      	if (vAdicional != "")	putmess "	ADIC	-> %%vAdicional"
[I2:    130]    79-1      	if (vInfo != "")		putmess "	INFO	-> %%vInfo"
[I2:    131]    82-1      	if (vLog  != "") 		putmess "	LOG	-> %%vLog"
[I2:    132]    85-1      	putmess " "
[I2:    133]    86-1          $status = -1
[I2:    134]    87-1      endif
[I2:    136]    88        	if (vDica != "")& (vTipo != 1) message/hint vDica
[I2:    139]    91        return (pCdErro)
[I2:    140]    92        end ;ShowErro
[I1:      9]               #include LIB_PADRAO:zRESET_ERRO
[I2:      1]              ;--------------------------
[I2:      2]******        partner operation ResetErro
[I2:      3]              ;--------------------------
[I2:      4]     1           $xCdErro$ = ""
[I2:      5]     2           $xCtxErro$ = ""
[I2:      6]     3        end ;ResetErro
[I1:     10]               #include LIB_PADRAO:DEF_STATUS
[I2:      1]              ;=======================================
[I2:      2]              ;Autor: FSD;
[I2:      3]              ;Nome : Rotina de tratamento de status
[I2:      4]              ;
[I2:      5]              ;Data : 13/11/2003
[I2:      6]              ;
[I2:      7]              ;Versão : 1.0
[I2:      8]              ;
[I2:      9]              ;Descrição : 
[I2:     10]              ;
[I2:     11]              ;Histórico Manutenção :
[I2:     12]              ;
[I2:     13]              ;Exemplo :
[I2:     15]              ;Data	Operador	Detalhes
[I2:     16]              ;----------------------------
[I2:     17]******        partner operation ReSetStatus
[I2:     18]              ;----------------------------
[I2:     19]     1        $XLCS$ = ""
[I2:     20]     2        $XCS$ = ""
[I2:     21]     3        end; ResetStatus
[I2:     22]              ;--------------------------
[I2:     23]******        partner operation SetStatus
[I2:     24]              ;--------------------------
[I2:     25]              params
[I2:     26]                 string pTipo 	:INOUT ;Tipo de status DICA,AVISO,INFO,ERRO
[I2:     27]                 string pId 		:INOUT ;Identificador do status
[I2:     28]                 string pContexto	:INOUT ;Contexto do status
[I2:     29]                 string pInfo		:INOUT ;Informação adicional
[I2:     30]              endparams
[I2:     31]              ;putitem pContexto,-1,pInfo
[I2:     32]     1        pContexto = "%%pContexto%%%·;%%pInfo"
[I2:     33]     2-1      if (pId = -35)
[I2:     34]     3-2          if ("F" = "S")
[I2:     35]     4-2      		pid       = $xcderro$
[I2:     36]     5-2      		pContexto = $xctxerro$
[I2:     37]     6-2          else
[I2:     38]     7-2             pid       = ""
[I2:     39]     8-2             pContexto = ""
[I2:     40]     9-2             return ($xcderro$)
[I2:     41]    10-2          endif
[I2:     42]    11-1      endif
[I2:     43]    12        activate "SISSVCO007".IgnorarStatus(pId)
[I2:     44]    13-1      if ($status = 0)
[I2:     45]    14-1          $instancehandle->DefinirContexto(pTipo,pid,pContexto)
[I2:     46]    15-2          if ($procerror)
[I2:     47]    16-2          elseif($status < 0)
[I2:     48]              		;Erro na rotina de tratamento de erro
[I2:     49]    17-2          elseif($status >= 0)
[I2:     50]    18-2      		activate "SISSVCO007".RedefinirContexto(pid,pContexto,$xcderro$,$xctxerro$)
[I2:     51]    19-3      		if ($procerror)
[I2:     52]    20-3      			putmess "%%$procerror - %%$procerrorcontext"
[I2:     53]    21-3      		else
[I2:     54]    22-3      	        $instancehandle->ExibirMensagem(pid,pContexto)
[I2:     55]    23-3      		endif
[I2:     56]    24-2          endif
[I2:     57]    25-1      endif
[I2:     58]    26        return ($status)
[I2:     59]    27        end ; SetStatus
[I2:     61]              ;--------------------------------
[I2:     62]******        partner operation DefinirContexto
[I2:     63]              ;--------------------------------
[I2:     64]              params
[I2:     65]              	string pTipo	:IN
[I2:     66]              	string pId 		:INOUT
[I2:     67]              	string pContexto:INOUT
[I2:     68]              endparams
[I2:     69]              variables
[I2:     70]                  string vGlobal
[I2:     71]                  string vSessao,vCategoria,vUsuario,vComponente
[I2:     72]                  string vTipo,vTipoComponente
[I2:     73]                  string vData,vHora
[I2:     74]                  string vCampo,vEntidade
[I2:     75]              endvariables
[I2:     76]              ;Definir identificador do status
[I2:     77]     1-1      if (pId = "")
[I2:     78]     2-1          pId = $item("ID",pContexto)
[I2:     79]     3-2      	if (pId = "")
[I2:     80]     4-2      		pId = 8006
[I2:     81]     5-2      	endif
[I2:     82]     6-1      endif
[I2:     83]              ;Definir global
[I2:     85]     7           vGlobal = $$GPARAMGLB
[I2:     89]              ;Definir categoria
[I2:     90]     8-1      if (pID < 0) 
[I2:     91]     9-1          vCategoria = "P"
[I2:     92]    10-1      elseif ($item("CONTEXT",pContexto) = "VALIDATION")
[I2:     93]    11-1          vCategoria = "V"
[I2:     94]    12-1      else
[I2:     95]    13-1          vCategoria = "S"
[I2:     96]    14-1      endif
[I2:     97]              ;Definir tipo
[I2:     98]    15-1      if (pTipo = "")    
[I2:     99]    16-1      	pTipo = $item("TIPO",pContexto)
[I2:    100]    17-1      endif
[I2:    101]    18        vTIPO		= pTipo
[I2:    102]              ;Definir Data
[I2:    103]    19        vDATA 		= $date
[I2:    104]              ;Definir Hora
[I2:    105]    20        vHORA 		= $clock
[I2:    106]              ;Definir Usuário
[I2:    107]    21        vUSUARIO 	= $item("ID_USR",vGLOBAL)
[I2:    108]              ;Definir Componente
[I2:    109]    22        vCOMPONENTE 	= $item("COMPONENTE",pContexto) 
[I2:    110]    23-1      if (vCOMPONENTE = "")
[I2:    111]    24-1         vCOMPONENTE 	= $componentname 
[I2:    112]    25-1      endif
[I2:    113]              ;Definir tipo Componente
[I2:    114]    26        vTIPOCOMPONENTE = $componenttype(vComponente) 		;(SVC,RPT,FRM)
[I2:    115]              ;Definir Campo
[I2:    116]    27        vCampo 		= $fieldname
[I2:    117]              ;Definir Entidade
[I2:    118]    28        vEntidade 	= $entname
[I2:    120]    29        putitem/id pContexto, "TIPO" 			,vTipo
[I2:    121]    30        putitem/id pContexto, "DATA"       		,vData
[I2:    122]    31        putitem/id pContexto, "HORA"       		,vHora
[I2:    123]    32        putitem/id pContexto, "USUARIO"    		,vUsuario
[I2:    124]    33        putitem/id pContexto, "CATEGORIA"  		,vCategoria
[I2:    125]    34        putitem/id pContexto, "COMPONENTE" 		,vComponente
[I2:    126]    35        putitem/id pContexto, "ENTIDADE"   		,vEntidade
[I2:    127]    36        putitem/id pContexto, "CAMPO"      		,vCampo
[I2:    128]    37        putitem/id pContexto, "TIPO_COMPONENTE"	,vTipoComponente
[I2:    129]    38        end ; DefinirContexto
[I2:    131]              ;-------------------------------
[I2:    132]******        partner operation ExibirMensagem
[I2:    133]              ;-------------------------------
[I2:    134]              params
[I2:    135]                 string pId 		:INOUT
[I2:    136]                 string pContexto	:INOUT
[I2:    137]              endparams
[I2:    138]              variables
[I2:    139]                 string vDescricao,vTipo,vObjeto,vInfo,vDica,vLog,vAdicional,vDsTipo
[I2:    140]              endvariables
[I2:    142]     1        vTipo       = $item("TIPO"		,pContexto)
[I2:    143]     2        vDescricao  = $item("DESCRICAO"	,pContexto)
[I2:    144]     3        vInfo       = $item("INFO"		,pContexto)
[I2:    145]     4        vDica       = $item("DICA"		,pContexto)
[I2:    146]     5        vAdicional	= $item("ADICIONAL"	,pContexto)
[I2:    147]     6        vLog		= $item("LOG"		,pContexto)
[I2:    148]     7        vObjeto     = $item("OBJETO"		,vInfo)
[I2:    150]     8-1      if (vTipo = 1)
[I2:    151]     9-1      	 vDsTipo = "DICA"
[I2:    153]    10-1               message/hint "%%pId - %%vDescricao %%vAdicional %%vDica" 
[I2:    155]    11-1           $status = 1
[I2:    156]    12-1      elseif (vTipo = 2)
[I2:    157]    13-1      	 vDsTipo = "AVISO"
[I2:    159]    14-1               message/warning "%%pId - %%vDescricao %%vAdicional"
[I2:    161]    15-1           $status = 2
[I2:    162]    16-1      elseif(vTipo = 3)
[I2:    163]    17-1      	 vDsTipo = "INFO"
[I2:    165]    18-1               message/info "%%pId - %%vDescricao %%vAdicional" 
[I2:    167]    19-1           $status = 3
[I2:    168]    20-1      elseif(vTipo = 4)
[I2:    169]    21-1      	 vDsTipo = "LOG"
[I2:    170]    22-1        	 putmess "%%vDsTipo%%%-> %%pId"
[I2:    171]    23-1      	 putmess "	DESCR	-> %%vDescricao"
[I2:    172]    24-1        	 if (vAdicional != "")	putmess "	ADIC	-> %%vAdicional"
[I2:    173]    27-1      	 if (vInfo != "")		putmess "	INFO	-> %%vInfo"
[I2:    174]    30-1      	 if (vLog  != "") 		putmess "	LOG	-> %%vLog"
[I2:    175]    33-1           $status = 4
[I2:    176]    34-1      elseif (vTipo = -1)
[I2:    177]    35-1      	 vDsTipo = "ERRO"
[I2:    179]    36-1               message/error "%%pId - %%vDescricao %%vAdicional"
[I2:    181]    37-1      	putmess "%%vDsTipo%%%-> %%pId"
[I2:    182]    38-1      	putmess "	DESCR	-> %%vDescricao"
[I2:    183]    39-1      	if (vAdicional != "")	putmess "	ADIC	-> %%vAdicional"
[I2:    184]    42-1      	if (vInfo != "")		putmess "	INFO	-> %%vInfo"
[I2:    185]    45-1      	if (vLog  != "") 		putmess "	LOG	-> %%vLog"
[I2:    186]    48-1      	putmess " "
[I2:    187]    49-1          $status = -1
[I2:    188]    50-1      endif
[I2:    190]    51        	if (vDica != "")& (vTipo != 1) message/hint vDica
[I2:    192]    54        $xcderro$ 	= pID
[I2:    193]    55        $xctxerro$ 	= pContexto
[I2:    194]    56        return ($status)
[I2:    195]    57        end ;ExibirMensagem
[I1:     11]               #include LIB_PADRAO:DEF_DISPLAY
[I2:      1]              ;---------------------------
[I2:      2]******        partner operation setDisplay
[I2:      3]              ;---------------------------
[I2:      4]              	params
[I2:      5]              		string piDsMensagem : IN
[I2:      6]              		string piParams : IN
[I2:      7]              		string poParams : OUT
[I2:      8]              	endparams
[I2:     10]     1-1      	if ($item("HR_ULTIMOHINT", $xlpg$) = "")
[I2:     11]     2-1      		putitem/id $xlpg$, "HR_ULTIMOHINT", $clock
[I2:     12]     3-1      	endif
[I2:     13]     4        	putitem/id $xlpg$, "HR_ATUAL", $clock
[I2:     14]     5-1      	if ($clock($item("HR_ATUAL", $xlpg$)) >= $clock($item("HR_ULTIMOHINT", $xlpg$)) + $clock($item("NR_SEGUNDO_DISPLAY", $$gParamGlb)))
[I2:     15]     6-1      		message/hint piDsMensagem
[I2:     16]     7-1      		putitem/id $xlpg$, "HR_ULTIMOHINT", $clock
[I2:     17]     8-1      	endif
[I2:     19]     9        	return(0)
[I2:     20]    10        end
[I1:     12]              ;----------------------Componente-----------------------------
[I1:     13]               #include LIB_PADRAO:CMP_SAIR
[I2:      1]              ;---------------------
[I2:      2]******        partner Operation Sair
[I2:      3]              ;---------------------
[I2:      4]     1-1      if ($formmod & $editmode = 0)
[I2:      5]     2-1      	askmess "Existem manutenções pendentes. Deseja sair e perder as alterações?","Sair,Cancelar" 
[I2:      6]     3-2      	if ($status = 1)
[I2:      7]     4-2      		rollback
[I2:      8]     5-2      		commit
[I2:      9]     6-2      		exit(-1)
[I2:     10]     7-2      	else
[I2:     11]     8-2      		return (-1) 
[I2:     12]     9-2      	endif
[I2:     13]    10-1      else
[I2:     14]    11-1      	rollback
[I2:     15]    12-1      	commit
[I2:     16]    13-1      	exit(-1)
[I2:     17]    14-1      endif
[I2:     18]    15        return ($status)
[I2:     19]    16        end ;Sair
[I1:     14]               #include LIB_PADRAO:CMP_SALVAR
[I2:      1]              ;-------------------------
[I2:      2]******        partner Operation Salvar
[I2:      3]              ;-------------------------
[I2:      4]     1-1      if ($editmode = 0)
[I2:      5]     2-1         	store
[I2:      6]     3-2      	if ($status < 0)
[I2:      7]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[I2:      8]     5-2      		rollback 
[I2:      9]     6-2      		return (-1)
[I2:     10]     7-2      	else
[I2:     11]     8-3      		if ($status = 1)
[I2:     12]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[I2:     13]    10-3      		else
[I2:     14]    11-3      			$instancehandle->PrcCommit("")
[I2:     15]    12-3      		endif
[I2:     16]    13-2      	endif
[I2:     17]    14-1      else
[I2:     18]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[I2:     19]    16-1      endif
[I2:     20]    17        return ($status)
[I2:     21]    18        end ; Salvar
[I1:     15]               #include LIB_PADRAO:CMP_CONSULTAR
[I2:      1]              ;--------------------------
[I2:      2]******        partner Operation Consultar
[I2:      3]              ;--------------------------
[I2:      4]     1-1      if ($formmod) & ($dbocc($entname))
[I2:      5]     2-1      	askmess "Existem manutenções pendentes.Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[I2:      6]     3-2      	if ($status = 1)
[I2:      7]     4-2      		retrieve
[I2:      8]     5-3      		if ($procerror)
[I2:      9]     6-4      			if ($procerror = -2)
[I2:     10]     7-4      				$instancehandle->SetStatus(1,"APL0008","","")
[I2:     11]     8-4      			else
[I2:     12]     9-4      				$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I2:     13]    10-4      			endif
[I2:     14]    11-3      		else
[I2:     15]    12-3      			$instancehandle->SetStatus(1,"APL0001","","")
[I2:     16]    13-3      		endif
[I2:     17]    14-2      	else
[I2:     18]    15-2      		return (-1) 
[I2:     19]    16-2      	endif
[I2:     20]    17-1      else
[I2:     21]    18-1      	retrieve
[I2:     22]    19-2      	if ($procerror)
[I2:     23]    20-3      			if ($procerror = -2)
[I2:     24]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[I2:     25]    22-3      			else
[I2:     26]    23-3      				$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I2:     27]    24-3      			endif
[I2:     28]    25-2      		else
[I2:     29]    26-2      			$instancehandle->SetStatus(1,"APL0001","","")
[I2:     30]    27-2      		endif
[I2:     31]    28-1      	endif
[I2:     32]    29        	reset $formmod
[I2:     33]    30        	return ($status)
[I2:     34]    31        end ;Consultar
[I1:     16]               #include LIB_PADRAO:CMP_LIMPAR
[I2:      1]              ;-----------------------
[I2:      2]******        partner Operation Limpar
[I2:      3]              ;-----------------------
[I2:      4]     1        clear
[I2:      5]     2-1      if ($status >= 0)
[I2:      6]     3-1      	$instancehandle->SetStatus(1,"APL0006","","")
[I2:      7]     4-1      	rollback
[I2:      8]     5-1      endif
[I2:      9]     6        end ;Limpar
[I1:     17]               #include LIB_PADRAO:CMP_EXCLUIR
[I2:      1]              ;-------------------------
[I2:      2]******        partner operation Excluir
[I2:      3]              ;-------------------------
[I2:      4]     1        erase
[I2:      5]     2-1      if ($status < 0)
[I2:      6]     3-1      	$instancehandle->SetStatus(-1,1763,"","")
[I2:      7]     4-1      	rollback
[I2:      8]     5-1      	return(-1)
[I2:      9]     6-1      else
[I2:     10]     7-2      	if ($status = 1)
[I2:     11]     8-2      		$instancehandle->SetStatus(-1,1634,"","")
[I2:     12]     9-2      	else
[I2:     13]    10-2      		$instancehandle->SetStatus(-1,1806,"","")
[I2:     14]    11-2      		$instancehandle->PrcCommit()
[I2:     15]    12-2      	endif
[I2:     16]    13-1      endif
[I2:     17]    14        return ($status)
[I2:     18]    15        end ;Excluir
[I1:     18]               #include LIB_PADRAO:PRC_COMMIT
[I2:      1]              ;--------------------------
[I2:      2]******        partner operation PrcCommit
[I2:      3]              ;--------------------------
[I2:      4]              params
[I2:      5]                 string piPATH :IN
[I2:      6]              endparams
[I2:     11]     1        	commit
[I2:     12]     2-1      	if ($status < 0)
[I2:     13]     3-1      		rollback
[I2:     14]     4-1      		return (-1) 
[I2:     15]     5-1      	else
[I2:     16]     6-1      		$instancehandle->SetStatus(1,"APL0002","","")
[I2:     17]     7-1      		return (0)
[I2:     18]     8-1      	endif
[I2:     20]     9        end; PrcCommit
[I1:     19]               #include LIB_PADRAO:PRC_CHAVE
[I2:      1]              ;-------------------------
[I2:      2]******        partner operation GetChave 
[I2:      3]              ;-------------------------
[I2:      4]              params
[I2:      5]                 string piNmEntidade: IN
[I2:      6]                 string poChave :OUT 
[I2:      7]              endparams
[I2:      9]              variables
[I2:     10]              string  vNmCampo,vKeyFields
[I2:     11]              numeric vIdx
[I2:     12]              endvariables
[I2:     14]     1        vKeyFields = $keyfields(piNmEntidade,1)
[I2:     15]     2        vIdx = 1
[I2:     16]     3-1      repeat
[I2:     17]     4-1        getitem vNmCampo,vKeyfields,vIdx
[I2:     18]     5-2        if (vNmCampo != "")
[I2:     19]     6-3            if (@vNmCampo != "")
[I2:     20]     7-3                putitem/id poChave,vNmCampo,@vNmCampo
[I2:     21]     8-3            endif
[I2:     22]     9-2        endif
[I2:     23]    10-1        vIdx = vIdx + 1
[I2:     24]    11-1      until (vNmCampo = "")
[I2:     25]    12        End ; operation GetChave
[I2:     27]              ;-------------------------
[I2:     28]******        partner Operation SetChave 
[I2:     29]              ;-------------------------
[I2:     30]              params
[I2:     31]                 string piNmEntidade :IN
[I2:     32]                 string piChave :IN
[I2:     33]              endparams
[I2:     34]              variables
[I2:     35]              string  vNmCampo,vNmCampoChave,vKeyFields
[I2:     36]              numeric vIdx
[I2:     37]              endvariables
[I2:     38]     1-1      if (piChave != "")
[I2:     39]     2-1          vKeyFields = $keyfields(piNmEntidade,1)
[I2:     40]     3-1          vIdx = 1
[I2:     41]     4-2          repeat
[I2:     42]     5-2             getitem vNMCampo,vKeyfields,vIdx
[I2:     43]     6-3             if (vNmCampo != "")
[I2:     44]     7-3                 vNmcampoChave = "%%vNmCampo%%%.%%piNmEntidade" 
[I2:     45]     8-3                 @vNmCampoChave/init = $item(vNmCampo,piChave)
[I2:     46]     9-3             endif
[I2:     47]    10-2             vIdx = vIdx + 1
[I2:     48]    11-2          until (vNmCampo = "")
[I2:     49]    12-1      endif
[I2:     50]    13        End ; Operation SetChave
[I1:     20]               #include LIB_PADRAO:SET_FIELDPROP
[I2:      1]******        partner operation SetFieldProp
[I2:      2]              params
[I2:      3]                 string pNmEntidade  :IN
[I2:      4]                 string pListaCampos :IN
[I2:      5]                 string pPropriedades :IN
[I2:      6]              endparams
[I2:      7]              variables
[I2:      8]                 string vNmCampo,vNmEntidade,vIdx
[I2:      9]              endvariables
[I2:     10]     1        vIdx = 1
[I2:     11]     2-1      repeat
[I2:     12]     3-1      getitem vNmCampo,pListaCampos,vIdx
[I2:     13]     4-2      if (vNmCampo != "")
[I2:     14]     5-2          vNmCampo = "%%vNmCampo%%%.%%pNmEntidade"
[I2:     15]     6-2          fieldsyntax vNmCampo, pPropriedades
[I2:     16]     7-2      endif
[I2:     17]     8-1      vIdx = vIdx + 1
[I2:     18]     9-1      until (vNmCampo = "")
[I2:     19]    10        end
[I1:     21]               #include LIB_PADRAO:CMP_NIVEL
[I2:      1]              ;------------------------------
[I2:      2]******        partner operation VerificaNivel
[I2:      3]              ;------------------------------
[I2:      4]     1           activate "LOGSVCO003".GetNivelComponente($$gCdUsuario,$$gCdEmpresa,$componentName,$xCdNivel$,$xCdErro$,$xCtxErro$)
[I2:      5]     2-1         if ($procerror)
[I2:      6]     3-1            $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=LOGSVCO003.GETNIVELCOMPONENTE")
[I2:      7]     4-1         elseif ($xCdNivel$ = 0)
[I2:      8]     5-1            $instancehandle->SetStatus(-1,"APL0009","","ADICIONAL=%%$formtitle")
[I2:      9]     6-1            exit(-1)
[I2:     10]     7-1         endif 
[I2:     11]     8        End; VerificaNivel
[I1:     22]               #include LIB_PADRAO:PRC_AJUDA
[I2:      1]              ;----------------------
[I2:      2]******        public operation calendario
[I2:      3]              ;--------------------------
[I2:      4]              	variables
[I2:      5]              		string viParams, voParams, vNvInstancia, vNrSequencia
[I2:      6]              	endvariables
[I2:      8]     1        	vNrSequencia = $datim
[I2:      9]     2        	vNvInstancia  = "GERFM040R%%vNrSequencia"
[I2:     10]     3        	newinstance "GERFM040", "%%vNvInstancia","TRANSACTION=TRUE"
[I2:     11]     4        	activate "%%vNvInstancia".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[I2:     12]     5-1      	if ($procerror)
[I2:     13]     6-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=ADMFL021.EXEC")
[I2:     14]     7-1      		return (-1)
[I2:     15]     8-1      	endif
[I2:     17]              ;;	viParams = ""
[I2:     18]              ;	activate "GERFM040".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[I2:     19]              ;	if ($procerror)       
[I2:     20]              ;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[I2:     21]              ;	endif    
[I2:     23]     9        	return(0)
[I2:     24]    10        end
[I1:     24]               #include LIB_PADRAO:PRC_AJUDA
[I2:      1]              ;----------------------
[I2:      2]******        public operation Ajuda
[I2:      3]              ;----------------------
[I2:      4]              ;	Operation para acionar Ajuda do Componente
[I2:      5]              ;	Evjunior 10/08/07
[I2:      6]              ;----------------------------------------------
[I2:      7]              	variables
[I2:      8]              		string viParams,voParams,vDsTeclado
[I2:      9]              	endvariables
[I2:     11]     1        	vDsTeclado = $keyboard
[I2:     12]     2        	$keyboard = "KB_GLOBAL"
[I2:     13]     3        	viParams = ""
[I2:     14]     4        	putitem/id viParams,"CD_COMPONENTE",$componentname
[I2:     15]     5        	putitem/id viParams,"CD_USUARIO",$$gCdUsuario
[I2:     16]     6        	newinstance "HLPFM002","HLPFM002","TRANSACTION=TRUE";,MODALITY=MODAL"
[I2:     17]     7        	activate "HLPFM002".exec(viParams,voParams,$xCdErro$,$xCtxErro$)
[I2:     18]     8-1      	if ($procerror)
[I2:     19]     9-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,$xcs$,$xlcs$)
[I2:     20]    10-1      	endif
[I2:     21]    11        	deleteinstance "HLPFM002"
[I2:     22]    12        	$keyboard = vDsTeclado
[I2:     24]    13        	return (0)
[I2:     25]    14        end; Ajuda
[I1:     25]              ;----------------------Entidade-------------------------------
[I1:     26]               #include LIB_PADRAO:ENT_LMK
[I2:      1]              ;---------------------
[I2:      2]******        partner operation LMK
[I2:      3]              ;---------------------
[I2:      4]     1          retrieve/o
[I2:      5]     2-1        if ($status < 0)
[I2:      6]                  ; multiple hits: in foreign entity
[I2:      7]     3-1          if ($status = -15) message $text(2202)
[I2:      8]                  ; multiple hits: not in foreign entity
[I2:      9]     6-1          if ($status = -14) message $text(2205)
[I2:     10]                  ; occurrence currently locked
[I2:     11]     9-1          if ($status = -11) message $text(2009)
[I2:     12]                  ;message $text(2006) ; duplicate key
[I2:     13]    12-2          if ($status = -7) 
[I2:     14]    13-2              retrieve/x 
[I2:     15]    14-2              return (0)
[I2:     16]    15-2          endif
[I2:     17]                  ; cannot open table or file
[I2:     18]    16-1          if ($status = -4)  message $text(2003) 
[I2:     19]                  ; exceptional I/O error
[I2:     20]    19-1          if ($status = -3)  message $text(2002) 
[I2:     21]                  ; key not found:in foreign entity
[I2:     22]    22-1          if ($status = -2)  message $text(2200) 
[I2:     23]    25-1        else
[I2:     24]                  ; key not found: foreign entity w/WRITE UP
[I2:     25]    26-1          if ($status = 1)   message $text(2201) 
[I2:     26]                  ; one occurrence found in foreign entity
[I2:     27]    29-2          if ($status = 2)
[I2:     28]    30-2            retrieve/e
[I2:     29]                    ; I/O error detected
[I2:     30]    31-3            if ($status < 0)
[I2:     31]    32-4                if ($status = -2)
[I2:     32]    33-4                    message/error "Registro não disponível para uso. %%$entname" 
[I2:     33]    34-4                else
[I2:     34]    35-4                    message $text(2002) 
[I2:     35]    36-4                endif
[I2:     36]    37-3            endif 
[I2:     37]    38-2          endif
[I2:     38]                  ; occurrence un-removed
[I2:     39]    39-1          if ($status = 3)   message $text(2203) 
[I2:     40]                  ; key found: occurrence repositioned
[I2:     41]    42-1          if ($status = 4)   message $text(2204) 
[I2:     42]    45-1        endif
[I2:     43]    46          return ($status)
[I2:     44]    47        end ;LMK                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                                                                                                                                                  
[I2:     44]                                                                                                                                      
[I1:     27]               #include LIB_PADRAO:ENT_VLDK
[I2:      1]              ;---------------------
[I2:      2]******        partner operation VLDK
[I2:      3]              ;---------------------
[I2:      4]     1        findkey $entname, $curkey
[I2:      6]     2-1      selectcase $status
[I2:      7]     3-1        case 0             ; key not found
[I2:      8]     4-2          if ($foreign)    ; non existing key in up entity
[I2:      9]     5-2      		$instancehandle->SetStatus(-1,"0147","","")
[I2:     10]     6-2      		return (-1)
[I2:     11]     7-2          endif
[I2:     13]     8-1        case 1             ; key found in Component
[I2:     14]     9-2          if (!$foreign)   ; duplicate key in down entity
[I2:     15]    10-2            return (0) 
[I2:     16]    11-2          endif
[I2:     18]    12-1        case 2             ; key found in DBMS
[I2:     19]    13-2          if (!$foreign)   ; duplicate key in down entity
[I2:     20]    14-2            return (0) 
[I2:     21]    15-2          endif
[I2:     22]    16-1      endselectcase
[I2:     24]    17        return (0)
[I2:     25]    18        end
[I1:     28]               #include LIB_PADRAO:ENT_REMOCC
[I2:      1]              ;-------------------------
[I2:      2]******        partner operation Remover
[I2:      3]              ;-------------------------
[I2:      4]     1-1         if ($dbocc($entname))
[I2:      5]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[I2:      6]     3-2              if ($status = 1) 
[I2:      7]     4-2                  remocc $entname
[I2:      8]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[I2:      9]     6-2              else
[I2:     10]     7-2                  return (-1)
[I2:     11]     8-2              endif
[I2:     12]     9-1         else
[I2:     13]    10-1              remocc $entname
[I2:     14]    11-1         endif 
[I2:     15]    12           return ($status)
[I2:     16]    13        end
[I1:     29]               #include LIB_PADRAO:ENT_ADDOCC
[I2:      1]              ;-------------------------
[I2:      2]******        partner operation Adicionar
[I2:      3]              ;-------------------------
[I2:      4]     1          creocc $entname,-1
[I2:      5]     2        end
[         2]              #include LIB_PADRAO:ENT_VLDK_01
[I1:      1]              ;------------------------
[I1:      2]******        partner operation VLDK_01
[I1:      3]              ;------------------------
[I1:      4]     1        findkey $entname, $curkey
[I1:      6]     2-1      selectcase $status
[I1:      7]     3-1        case 0             ; key not found
[I1:      8]     4-1      		$instancehandle->SetStatus(-1,"0147","","")
[I1:      9]     5-1            return (-1)    ; only if Write Up trigger not filled
[I1:     10]     6-1        case 1             ; key found in Component
[I1:     11]     7-2          if (!$foreign)   ; duplicate key in down entity
[I1:     12]     8-2            return (0) 
[I1:     13]     9-2          endif
[I1:     14]    10-1        case 2             ; key found in DBMS
[I1:     15]    11-2          if (!$foreign)   ; duplicate key in down entity
[I1:     16]    12-2            return (0) 
[I1:     17]    13-2          endif
[I1:     18]    14-1      endselectcase
[I1:     20]    15        return (0)
[I1:     21]              ;=========================================================================
[I1:     22]              ;Autor: FSD
[I1:     23]              ;
[I1:     24]              ;Nome : VLDK_01
[I1:     25]              ;
[I1:     26]              ;Data : 05/07/2002
[I1:     27]              ;
[I1:     28]              ;Versão : V
[I1:     29]              ;
[I1:     30]              ;Descrição : Validação da chave primária/Candidata.
[I1:     31]              ;	Deve ser chamada somente na trigger de VALIDATE KEY.
[I1:     32]              ;	Deve ser utilizada quando a chave primária é gerada automaticamente, 	
[I1:     33]              ;	,por isso não permite a digitação de uma CHAVE que não existe no banco.
[I1:     34]              ;	O funcionamento padrão, sempre que uma chave é informada, e não existe no banco, 
[I1:     35]              ;	ela será incluida como uma nova ocorrencia no banco.
[I1:     36]              ;	sendo gravado no banco com a chave informada.
[I1:     37]              ;Parametros Entrada : N/C
[I1:     38]              ;
[I1:     39]              ;Parametros Saída : N/C
[I1:     40]              ;
[I1:     41]              ;Histórico Manutenção :
[I1:     42]              ;
[I1:     43]              ;Exemplo : $instancehandle->VLDK_01	
[I1:     44]              ;Data	Operador	Detalhes
[I1:     45]              ;
[I1:     46]    16        end
[         3]              ;---------------------
[         4]******        partner operation INIT  
[         5]              ;---------------------
[         6]     1        	putitem/id $$gParamglb,"DS_TECLADO","KB_PDV"
[         7]     2        	$keyboard = "KB_PDV"    
[         8]     3        	$formtitle = "%%$componentname - Lançamento de Transação Resumido"
[        10]              	;Retire o comentário das linhas abaixo para carregar os parâmetros locais
[        11]              	;Parametros gerais
[        12]     4        	$xlpl$ = ""
[        13]     5        	putitem $xlpl$, -1, "CONDPGTO_PDV"
[        14]     6        	putitem $xlpl$, -1, "CLIENTE_PDV"
[        15]     7        	putitem $xlpl$, -1, "VENDEDOR_PDV"
[        16]     8        	activate "ADMSVCO001".GetLstParametro($xlpl$, $xlpl$, $xcderro$, $xctxerro$)
[        17]     9-1      	if ($procerror)
[        18]    10-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        19]    11-1      	elseif ($xcdErro$)
[        20]    12-1      		$instancehandle->SetErroApl($xCtxErro$, $xCdErro$, $xCtxErro$)
[        21]    13-1      	endif
[        23]    14        	$cdCondPgto$ = $item("CONDPGTO_PDV", $xlpl$)
[        24]    15        	$cdCliente$ = $item("CLIENTE_PDV", $xlpl$)
[        25]    16        	$cdVendedor$ = $item("VENDEDOR_PDV", $xlpl$)
[        27]              	;Parametros por empresa
[        28]    17        	$xlplemp$ = ""
[        29]    18        	putitem $xlplemp$, -1, "CD_OPER_ECF"
[        30]    19        	putitem $xlplemp$, -1, "CD_OPER_VALETROCA"
[        31]    20        	putitem $xlplemp$, -1, "CD_OPER_TROCA"
[        32]    21        	putitem $xlplemp$, -1, "IN_DADOS_ADIC_TRA_AUTO"
[        33]    22        	putitem $xlplemp$, -1, "TP_IMPRESSAO_TRA_VD"
[        34]    23        	putitem $xlplemp$, -1, "TP_IMPRESSAO_NF_VD"
[        35]    24        	putitem $xlplemp$, -1, "TP_AGRUPAMENTO_ITEM_VD"
[        36]    25        	putitem $xlplemp$, -1, "IN_CONFERENTE"
[        37]    26        	putitem $xlplemp$, -1, "IN_PDV_OTIMIZADO"
[        38]    27        	putitem $xlplemp$, -1, "IN_BLOQ_QTD"
[        39]    28        	putitem $xlplemp$, -1, "LIMITE_CREDITO"
[        40]    29        	putitem $xlplemp$, -1, "IN_BLOQ_EXCLUIR_ITEM"
[        41]    30        	putitem $xlplemp$, -1, "TP_VALIDACAO_SALDO_PED"	
[        42]    31        	putitem $xlplemp$, -1, "TP_CONSULTA_PRD_PDV"	;MTF(13/11/2006) - Projeto 041, tarefa 106.	
[        43]    32        	putitem $xlplemp$, -1, "IN_MANTEM_VEND_VALETROCA" ;RAH - 24/11/2006 (Prj041/Trf112) - nao alterar vendedor no vale troca
[        44]    33        	putitem $xlplemp$, -1, "TP_SIMULADOR_FAT"
[        45]    34        	putitem $xlplemp$, -1, "IN_SIMULADOR_FAT_PRODUTO" ;Fiuza prj 41 tar 98 25/01/07 - bloquear desconto para item em promoção	
[        46]    35        	putitem $xlplemp$, -1, "IN_BLOQ_DESC_ITEM_PROM"
[        47]    36        	putitem $xlplemp$, -1, "IN_IMAGEM_PDV" ;Fiuza prj 102 tar 58 19/06/07 - validar clientes em atraso	
[        48]    37        	putitem $xlplemp$, -1, "NR_DIA_ATRASO_BLOQ_FAT"
[        49]    38        	putitem $xlplemp$, -1, "IN_HOMOLOGACAO_AM" ;---Elia Proj. 115/4 11/10/07
[        50]    39        	putitem $xlplemp$, -1, "TP_LIBERACAO_TRA_VD"
[        51]    40        	putitem $xlplemp$, -1, "QT_PECAS_DESCONTO_VL_MIN" ;---Elia Proj. 102/324 30/05/08
[        52]    41        	putitem $xlplemp$, -1, "IN_VALIDA_PRD_VALETROCA" ;---Elia Proj. 102/337 27/06/08
[        53]    42        	putitem $xlplemp$, -1, "IN_UTILIZA_CTC" ;---Elia Proj. 133/007 15/08/08
[        54]    43        	putitem $xlplemp$, -1, "TP_AVISA_ANIVERSARIO"
[        55]    44        	putitem $xlplemp$, -1, "IN_LIMITE_CREDITO_ITEM_VD"
[        56]    45        	putitem $xlplemp$, -1, "TP_LIMITE_DESCONTO" ;<ANO Pjt102 Trf784 - 21/01/2010>
[        57]    46        	putitem $xlplemp$, -1, "CD_OPER_TROCA_VALOR_VD"
[        58]    47        	putitem $xlplemp$, -1, "VL_TROCA_TPVALOR_VD"
[        59]    48        	putitem $xlplemp$, -1, "TP_VALIDACAO_CONF_TRA"
[        60]    49        	putitem $xlplemp$, -1, "TP_VALIDA_VENEDOR_VD"
[        61]    50        	putitem $xlplemp$, -1, "TP_VARIACAO_DESCONTO_VD"
[        62]    51        	putitem $xlplemp$, -1, "TP_BONUS_DESCONTO"
[        63]    52        	putitem $xlplemp$, -1, "IN_LIMITE_FAMILIAR_VD"
[        64]    53        	putitem $xlplemp$, -1, "NR_DIAS_CARENCIA_ATRASO" ; DIONE |156/0380| 30/07/2010
[        65]    54        	putitem $xlplemp$, -1, "IN_SIMULADOR_COND_PGTO"  ;>-- MAC - PRJ 156/383 - 12/08/2010 ---
[        66]    55        	putitem $xlplemp$, -1, "TP_COEFICIENTE_PRD_VD" ;>-- MAC - PRJ 102/926 - 25/08/2010	
[        67]    56        	putitem $xlplemp$, -1, "CD_MOD_RICHTEXT_VD" ;>-- MAC - PRJ 102/926 - 25/08/2010
[        68]    57        	putitem $xlplemp$, -1, "TP_IMP_RICHTEXT_VD" ;>-- MAC - PRJ 102/926 - 25/08/2010
[        69]    58        	putitem $xlplemp$, -1, "TP_BUSCA_VL_VALETROCA" ;>-- MAC - PRJ 156/395 - 16/09/2010 ---
[        70]    59        	putitem $xlplemp$, -1, "IN_RESIMULACAO_FAT" ;Hugo em 30/12/2010 Tarefa 156-494
[        71]    60        	putitem $xlplemp$, -1, "IN_MOSTRA_TROCO_RECEB" ;Hugo em 28/12/2010 Tarefa 180-32
[        72]    61        	putitem $xlplemp$, -1, "TP_UTILIZA_ETIQ_RFID_PDV" ;-=CANONICO=- (10/06/2011) PRJ 156 TAR 570
[        73]    62        	putitem $xlplemp$, -1, "TEF_TIPO"
[        74]    63        	putitem $xlplemp$, -1, "TP_CONSULTA_SALDO_CREDEV" ;-=CANONICO=- (10/08/2011) TAR 111 PRJ 182
[        75]    64        	putitem $xlplemp$, -1, "CD_MOD_IMP_RECEBTRA" ;-=CANONICO=- (11/08/2011) TAR 125 PRJ 186
[        76]    65        	putitem $xlplemp$, -1, "TP_CANCELA_TRA_ANDAMENTO" ;* Claudemir - Prj/Tarefa: 191/2 07/010/2011
[        77]    66        	putitem $xlplemp$, -1, "TP_UTILIZA_BOLETA" ;-- ALX - 191/11 - 11/11/2011 --;
[        78]    67        	putitem $xlplemp$, -1, "TP_IMPRESSAO_TEF_PAYGO" ;-=CANONICO=- 30/11/2010 TAR 982 PRJ 102 - Parametro de leitura do arquivo intpos
[        79]    68        	putitem $xlplemp$, -1, "TP_CONFIRMACAO_TEF_PEN"    ;-=CANONICO=- (07/12/2011) PRJ 156 TAR 694
[        80]    69        	activate "ADMSVCO001".GetParamEmpresa($item("CD_EMPRESA", $$gParamGlb), $xlplemp$, $xlplemp$, $xcderro$, $xctxerro$)
[        81]    70-1      	if ($procerror)
[        82]    71-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        83]    72-1      	elseif ($xcdErro$)
[        84]    73-1      		$instancehandle->SetErroApl($xCtxErro$, $xCdErro$, $xCtxErro$)
[        85]    74-1      	endif
[        86]              	
[        87]    75        	$cdOperacaoVenda$				= $item("CD_OPER_ECF", $xlplemp$)
[        88]    76        	$cdOperacaoValeTroca$		= $item("CD_OPER_VALETROCA", $xlplemp$)
[        89]    77        	$cdOperacaoTroca$				= $item("CD_OPER_TROCA", $xlplemp$)
[        90]    78        	$limiteCredito$				= $item("LIMITE_CREDITO" , $xlplemp$)
[        91]    79        	$inDadosAdicionaisAuto$	= $item("IN_DADOS_ADIC_TRA_AUTO", $xlplemp$)
[        92]    80        	$tpImpressaoTraVenda$		= $item("TP_IMPRESSAO_TRA_VD", $xlplemp$)
[        93]    81        	$tpImpressaoNFVenda$		= $item("TP_IMPRESSAO_NF_VD", $xlplemp$)
[        94]    82        	$tpAgrupamento$				= $item("TP_AGRUPAMENTO_ITEM_VD", $xlplemp$)
[        95]    83        	$inConferente$					= $item("IN_CONFERENTE", $xlplemp$)
[        96]    84        	$inBloqQtde$					= $item("IN_BLOQ_QTD",$xlplemp$)
[        97]    85        	$inBloqExcluiItem$			= $item("IN_BLOQ_EXCLUIR_ITEM",$xlplemp$)
[        98]    86        	$tpValidacaoSaldoPed$		= $item("TP_VALIDACAO_SALDO_PED", $xlplemp$)
[        99]    87        	$tpConsultaPrdPdv$			= $item("TP_CONSULTA_PRD_PDV", $xlplemp$);
[       100]    88        	$InMantVendValeTroca$		= $item("IN_MANTEM_VEND_VALETROCA", $xlplemp$) ;RAH - 24/11/2006 (Prj041/Trf112) - nao alterar vendedor no vale troca
[       101]    89        	$tpSimuladorFat$				= $item("TP_SIMULADOR_FAT", $xlplemp$)
[       102]    90        	$inSimuladorProduto$		= $item("IN_SIMULADOR_FAT_PRODUTO", $xlplemp$)	
[       103]    91        	$InBloqDesItemProm$			= $item("IN_BLOQ_DESC_ITEM_PROM", $xlplemp$) ;Fiuza prj 41 tar 98 25/01/07 - bloquear desconto para item em promoção
[       104]    92        	$inImagem$						= $item("IN_IMAGEM_PDV", $xlplemp$)	
[       105]    93        	$nrDiaVencto$					= $item("NR_DIA_ATRASO_BLOQ_FAT" , $xlplemp$) ;Fiuza prj 102 tar 58 19/06/07 - validar clientes em atraso
[       106]    94        	$InHomologacaoAm$				= $item("IN_HOMOLOGACAO_AM", $xlplemp$);---Elia Proj. 115/4 11/10/07
[       107]    95        	$tpLiberacaoTraVd$			= $item("TP_LIBERACAO_TRA_VD", $xlplemp$)
[       108]    96        	$inValidaPrdValeTroca$ 	= $item("IN_VALIDA_PRD_VALETROCA", $xlplemp$);---Elia Proj. 102/337 27/06/08
[       109]    97        	$qtPecasDescontoVlMin$		= $item("QT_PECAS_DESCONTO_VL_MIN", $xlplemp$);---Elia Proj. 102/324 30/05/08
[       110]    98-1      	if($qtPecasDescontoVlMin$ = 1)
[       111]    99-1      		message/info "Valor do parâmetro empresa QT_PECAS_DESCONTO_VL_MIN deve ser maior que 1!"
[       112]   100-1      		exit(0)
[       113]   101-1      	endif
[       114]   102        	$inUtilizaCTC$					= $item("IN_UTILIZA_CTC", $xlplemp$);---Elia Proj. 133/007 15/08/08
[       115]   103        	$tpLimiteDesconto$			= $item("TP_LIMITE_DESCONTO", $xlplemp$) ;<ANO Pjt102 Trf784 - 21/01/2010>
[       116]   104        	$nrDiasCarenciaAtraso$		= $item("NR_DIAS_CARENCIA_ATRASO", $xlplemp$) ; DIONE |156/0380| 30/07/2010
[       117]   105        	$inSimuladorCondPgto$  	= $item("IN_SIMULADOR_COND_PGTO", $xlplemp$) ;>-- MAC - PRJ 156/383 - 12/08/2010 ---
[       118]   106        	$tpCoeficientePrdVd$		= $item("TP_COEFICIENTE_PRD_VD", $xlplemp$) ;>-- MAC - PRJ 102/926 - 25/08/2010	
[       119]   107        	$cdModRichTextVD$				= $item("CD_MOD_RICHTEXT_VD", $xlplemp$) ;>-- MAC - PRJ 102/926 - 25/08/2010
[       120]   108        	$tpImpRichTextVD$				= $item("TP_IMP_RICHTEXT_VD", $xlplemp$) ;>-- MAC - PRJ 102/926 - 25/08/2010
[       121]   109        	$tpBuscaVlValeTroca$		= $item("TP_BUSCA_VL_VALETROCA", $xlplemp$) ;>-- MAC - PRJ 156/395 - 16/09/2010 ---
[       122]   110        	$tpUtilizaEtiqRfidPdv$ 	= $item("TP_UTILIZA_ETIQ_RFID_PDV", $xlplemp$) ;-=CANONICO=- (10/06/2011) PRJ 156 TAR 570
[       123]   111        	$tpTEF$							= $item("TEF_TIPO", $xlplemp$)
[       124]   112        	$tpConsultaSaldoCredev$	= $item("TP_CONSULTA_SALDO_CREDEV",$xlplemp$) ;-=CANONICO=- (10/08/2011) TAR 111 PRJ 182
[       125]   113        	$cdModImpRecebTra$			= $item("CD_MOD_IMP_RECEBTRA", $xlplemp$) ;-=CANONICO=- (11/08/2011) TAR 125 PRJ 186
[       126]   114        	$tpCancelaTraAndamento$	= $item("TP_CANCELA_TRA_ANDAMENTO", $xlplemp$)  ;* Claudemir - Prj/Tarefa: 191/2 07/010/2011
[       127]   115        	$tpUtilizaBoleta$         = $item("TP_UTILIZA_BOLETA", $xlplemp$) ;-- ALX - 191/11 - 11/11/2011 --;
[       128]   116        	$tpImpTefPAYGO$           = $item("TP_IMPRESSAO_TEF_PAYGO", $xlplemp$);-=CANONICO=- 30/11/2010 TAR 982 PRJ 102 - Parametro de leitura do arquivo intpos	
[       129]   117        	$tpConfirmacaoTefPen$      = $item("TP_CONFIRMACAO_TEF_PEN"   , $xlplemp$) ;-=CANONICO=- (07/12/2011) PRJ 156 TAR 694
[       131]   118        	return(0)
[       132]   119        End ; operation INIT
[       134]              ;------------------------
[       135]******        partner operation CLEANUP 
[       136]              	;------------------------
[       137]     1        	putitem/id $$gParamglb,"DS_TECLADO",""
[       138]     2        	$keyboard = "KB_GLOBAL"
[       139]     3        	return(0)
[       140]     4        End ; operation CLEANUP
[       142]              ;----------------------
[       143]******        partner operation BT_02
[       144]              	;----------------------
[       145]              	variables
[       146]              		string viParams, voParams
[       147]              	endvariables
[       149]              	;---Elia Proj. 102/434 29/10/08
[       150]              	;if ($inBloqExcluiItem$ = "T")
[       151]     1-1      	if ($inBloqExcluiItem$ = 1) | ($inBloqExcluiItem$ = 2) | ($inBloqExcluiItem$ = 3); 1 - Sim - Nao permiti sair do componente / 2 - Sim - Permiti sai do componente
[       152]              	;
[       153]     2-1      		viParams = ""
[       154]     3-1      		putitem/id viParams, "IN_USULOGADO", "T"
[       155]              		;putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO", $$gParamGlb)
[       156]     4-1      		putitem/id viParams, "DS_COMPONENTE", "TRAFM060EX"
[       157]     5-1      		activate "ADMFM020".exec(viParams, voParams, $xCdErro$, $xCtxerro$)
[       158]     6-2      		if ($procerror)  
[       159]     7-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")     
[       160]     8-2      			return (-1)
[       161]     9-2      		endif
[       162]    10-2      		if ($status < 0)
[       163]    11-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Função bloqueada!", "ADICIONAL=Parâmetro empresa->IN_BLOQ_EXCLUIR_ITEM")
[       164]    12-2      			return(-1)		
[       165]    13-2      		endif
[       166]    14-1      	endif
[       168]    15        	macro "^CLEAR"
[       170]    16        	$prompt = CD_AUXILIAR.PES_VENDEDOR	
[       171]              	
[       172]    17        	return(0)
[       173]    18        end
[       175]              ;----------------------
[       176]******        partner operation BT_03
[       177]              	;----------------------
[       178]              	variables
[       179]              		string viParams, voParams
[       180]              	endvariables
[       182]              	;Fiuza - projeto 41 tarefa 146 - bloquear entrada por qtd usando restrição quando
[       183]              	;o parametro IN_BLOQ_QTD estiver setado como "1"
[       184]     1-1      	if ($inBloqQtde$ = "T")
[       185]     2-1      		viParams = ""
[       186]     3-1      		putitem/id viParams, "CD_COMPONENTE"  , $componentname
[       187]     4-1      		putitem/id viParams, "DS_CAMPO"       , "IN_LANCAR_QTDE"                   
[       188]     5-1      		putitem/id viParams, "CD_EMPRESA"     , $item("CD_EMPRESA" ,$$gParamGlb)
[       189]     6-1      		putitem/id viParams, "CD_USUARIO"     , $item("CD_USUARIO" ,$$gParamGlb)
[       190]     7-1      		putitem/id viParams, "VL_VALOR"       , ""    
[       191]     8-1      		activate "ADMSVCO009".VerificaRestricao(viParams, voParams, $xCdErro$, $xCtxerro$)
[       192]     9-2      		if ($procerror)       
[       193]    10-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       194]    11-2      			return(-1)
[       195]    12-2      		elseif ($status < 0)
[       196]    13-2      			$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Usuário com restrição para executar processo.%%^Restrição - IN_LANCAR_QTDE", "")
[       197]    14-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Função bloqueada!", "ADICIONAL=Parâmetro empresa->IN_BLOQ_QTD")
[       198]    15-2      			return(-1)
[       199]    16-2      		endif	
[       200]    17-1      	endif
[       202]    18-1      	if (TP_INCLUSAO.TRA_TRANSACAO = "QUANTIDADE")
[       203]    19-1      		TP_INCLUSAO.TRA_TRANSACAO = "CODIGO"
[       204]    20-1      		BT_F3.SIS_BOTOES = "F3 Entrada por quantidade"
[       205]    21-1      	else
[       206]    22-1      		TP_INCLUSAO.TRA_TRANSACAO = "QUANTIDADE"
[       207]    23-1      		BT_F3.SIS_BOTOES = "F3 Entrada por código"
[       208]    24-1      	endif
[       209]              		
[       210]    25        	$instancehandle->posicionaCursor()
[       211]    26-1      	if ($procerror)
[       212]    27-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       213]    28-1      	endif    
[       215]    29        	return(0)
[       216]    30        end
[       218]              ;----------------------
[       219]******        partner operation BT_04
[       220]              ;----------------------	
[       221]              	variables
[       222]              		string viParams, voParams
[       223]              		numeric vNrTransacao, vCdPessoa
[       224]              		date vDtTransacao
[       225]              	endvariables
[       227]     1-1      	if (!$dbocc("TRA_TRANSACAO"))
[       228]     2-1      		$instancehandle->validaVendedor()
[       229]     3-2      		if ($procerror)
[       230]     4-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       231]     5-2      		endif
[       232]     6-2      		if ($status < 0)
[       233]     7-2      			return(-1)
[       234]     8-2      		endif
[       235]     9-1      	endif
[       237]    10        	viParams = ""
[       238]    11        	putlistitems/occ viParams, "TRA_TRANSACAO"
[       239]    12        	activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       240]    13-1      	if ($procerror)       
[       241]    14-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       242]    15-1      		return(-1)
[       243]    16-1      	elseif ($status < 0)
[       244]    17-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       245]    18-1      		return(-1)
[       246]    19-1      	endif
[       248]    20        	commit
[       249]    21-1      	if ($status < 0)
[       250]    22-1      		rollback
[       251]    23-1      		return (-1) 
[       252]    24-1      	else
[       253]    25-1      		$instancehandle->SetHint("ID=APLINFO002")
[       254]    26-1      	endif
[       256]    27-1      	if (NR_TRANSACAO.TRA_TRANSACAO = 0)
[       257]    28-1      		vNrTransacao = $item("NR_TRANSACAO", voParams)
[       258]    29-1      		NR_TRANSACAO.TRA_TRANSACAO/init = vNrTransacao
[       259]              		;* Claudemir - Prj/Tarefa: 102/943 - 20/09/2010
[       260]              		; O usuário conseguia gravar data retroativa ao teclar F4,
[       261]              		; foi alterado o TRASVCO004 para gravar a data do sistema quando a transação ainda não estiver gravada no banco,
[       262]              		; portanto sempre que a transação for vazia, irá recarregar a data da transação que veio do TRASVCO004
[       263]    30-1      		vDtTransacao = $item("DT_TRANSACAO", voParams)
[       264]    31-1      		DT_TRANSACAO.TRA_TRANSACAO/init = vDtTransacao ;*
[       265]    32-1      	endif
[       267]    33        	viParams = ""
[       268]    34        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       269]    35        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       270]    36        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       271]    37        	putitem/id viParams, "NR_CARTAO", $nrCartao$
[       272]    38        	$keyboard = "KB_GLOBAL"
[       273]    39        	activate "TRAFM081".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[       274]    40        	$keyboard = "KB_PDV"
[       275]    41-1      	if ($procerror)       
[       276]    42-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       277]    43-1      		return(-1)
[       278]    44-1      	endif
[       280]    45        	$nrCartao$ = $item("NR_CARTAO", voParams) ;---Elia Proj. 102/492 13/04/09
[       281]              	
[       282]    46        	commit
[       283]    47-1      	if ($status < 0)
[       284]    48-1      		rollback
[       285]    49-1      		return (-1) 
[       286]    50-1      	else
[       287]    51-1      		$instancehandle->SetHint("ID=APLINFO002")
[       288]    52-1      	endif
[       290]    53-1      	if ($inconferente$ = 1 & $item("CD_CONFERENTE", voParams) != "") ;recarrega o codigo e nome do conferente, caso mude o conferente nos dados adicionais
[       291]    54-1      		$dsConferente$ = $item("DS_CONFERENTE", voParams)
[       292]    55-1      		putitem/id $$gParamGlb, "CD_USUCONF", $item("CD_CONFERENTE", voParams)
[       293]    56-1      	else
[       294]    57-1      		clear/e "ADM_USUARIO"
[       295]    58-1      		CD_USUARIO.ADM_USUARIO/init = $item("CD_USUARIO", $$gParamGlb)
[       296]    59-1      		retrieve/e "ADM_USUARIO"
[       297]              		;$dsConferente$ = NM_LOGIN.ADM_USUARIO
[       298]    60-2      		if($status >= 0)
[       299]              			;--->MNT - Prj 094/1320 - 18/03/2010
[       300]    61-3      			if (CD_USUARIO.ADM_USUARIO > 0)
[       301]    62-3      				viParams = ""
[       302]    63-3      				voParams = ""
[       303]    64-3      				putitem/id viParams, "CD_USUARIO", CD_USUARIO.ADM_USUARIO
[       304]    65-3      				activate "ADMSVCO027".validaUsuarioEspecial($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)	
[       305]    66-4      				if ($procerror)
[       306]    67-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       307]    68-4      					return(-1)
[       308]    69-4      				elseif ($status < 0)
[       309]    70-4      					$instancehandle->SetStatus("",$xCdErro$, $xCtxErro$, "")
[       310]    71-4      					return(-1)
[       311]    72-4      				endif
[       313]    73-4      				if(voParams != "")
[       314]    74-4      					$dsConferente$ = $item("NM_LOGIN", voParams)
[       315]    75-4      				endif
[       316]    76-3      			else
[       317]    77-3      				$dsConferente$ = ""
[       318]    78-3      			endif
[       319]              			;<---
[       320]    79-2      		endif
[       321]    80-1      	endif
[       323]    81        	$instancehandle->recarregaTransacao()
[       324]    82-1      	if ($procerror)
[       325]    83-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       326]    84-1      	endif
[       328]    85        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[       329]              	
[       330]    86        	return(0)
[       331]    87        end
[       333]              ;----------------------
[       334]******        partner operation BT_05
[       335]              ;----------------------
[       336]              	variables
[       337]              		string viParams, voParams, vDsRegTroca, vDsSerie
[       338]              		numeric vNrTransacao
[       339]              		numeric vVlTotalDesc, vPrTotalDesc, vVlTotalLiquido, vVlCalc
[       340]              		numeric vVlBrutoTransacao, vVlLiquidoTransacao
[       341]              		date vDtSistema
[       342]              	endvariables	
[       344]              	;Fiuza - projeto 41 tarefa 146 - bloquear entrada por qtd usando restrição quando
[       345]              	;o parametro IN_BLOQ_QTD estiver setado como "1"
[       346]     1-1      	if (TP_INCLUSAO.TRA_TRANSACAO = "QUANTIDADE")
[       347]     2-2      		if ($inBloqQtde$ = "T")
[       348]     3-2      			viParams = ""
[       349]     4-2      			putitem/id viParams, "CD_COMPONENTE"  , $componentname
[       350]     5-2      			putitem/id viParams, "DS_CAMPO"       , "IN_LANCAR_QTDE"                   
[       351]     6-2      			putitem/id viParams, "CD_EMPRESA"     , $item("CD_EMPRESA" ,$$gParamGlb)
[       352]     7-2      			putitem/id viParams, "CD_USUARIO"     , $item("CD_USUARIO" ,$$gParamGlb)
[       353]     8-2      			putitem/id viParams, "VL_VALOR"       , ""    
[       354]     9-2      			activate "ADMSVCO009".VerificaRestricao(viParams, voParams, $xCdErro$, $xCtxerro$)
[       355]    10-3      			if ($procerror)       
[       356]    11-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       357]    12-3      				return(-1)
[       358]    13-3      			elseif ($status < 0)
[       359]    14-3      				$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Usuário com restrição para executar processo.%%^Restrição - IN_LANCAR_QTDE", "")
[       360]    15-3      				$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Função bloqueada!", "ADICIONAL=Parâmetro empresa->IN_BLOQ_QTD")
[       361]    16-3      				return(-1)
[       362]    17-3      			endif	
[       363]    18-2      		endif
[       364]    19-1      	endif	
[       365]              	
[       366]    20        	vDtSistema = $item("DT_SISTEMA", $$gParamGlb)
[       368]    21-1      	if (TP_FOCO.TRA_TRANSACAO = "C") | (TP_FOCO.TRA_TRANSACAO = "I")
[       369]              		;---Elia Proj. 102/353 01/08/08
[       370]    22-2      		if (!$dbocc("TRA_TRANSACAO")) & (DT_TRANSACAO.TRA_TRANSACAO != vDtSistema)
[       371]    23-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Data da transação diferente da data do sistema!", "")
[       372]    24-2      			$prompt = DT_TRANSACAO.TRA_TRANSACAO
[       373]    25-2      			return(-1)
[       374]    26-2      		endif
[       375]              		;
[       377]    27-1      		viParams = ""
[       378]    28-1      		putlistitems/occ viParams, "TRA_TRANSACAO"
[       379]    29-2      		if ($nrDiaVencto$ > 0)
[       380]    30-2      			putitem/id viParams, "IN_VALIDA_CLIENTE_ATRASO", "T"
[       381]    31-2      		endif
[       382]    32-1      		activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       383]    33-2      		if ($procerror)       
[       384]    34-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       385]    35-2      			return(-1)
[       386]    36-2      		elseif ($status < 0)
[       387]    37-3      			if ($status = -2)
[       388]    38-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       389]    39-3      				askmess "Cliente %%CD_PESSOA.TRA_TRANSACAO esta com faturas em atraso! Deseja continuar?","Sim,Não"
[       390]    40-4      				if ($status = 1)
[       391]    41-4      					viParams = ""
[       392]    42-4      					putlistitems/occ viParams, "TRA_TRANSACAO"
[       393]    43-4      					putitem/id viParams, "IN_VALIDA_CLIENTE_ATRASO", "F"
[       394]    44-4      					activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       395]    45-5      					if ($procerror)       
[       396]    46-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       397]    47-5      						return(-1)	
[       398]    48-5      					elseif ($status < 0)
[       399]    49-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       400]    50-5      						return(-1)
[       401]    51-5      					endif	
[       402]    52-4      				else
[       403]    53-4      					return(-1)
[       404]    54-4      				endif		
[       405]    55-3      			else
[       406]    56-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       407]    57-3      				return(-1)
[       408]    58-3      			endif
[       409]    59-2      		endif
[       410]              		
[       411]    60-1      		commit
[       412]    61-2      		if ($status < 0)
[       413]    62-2      			rollback
[       414]    63-2      			return (-1) 
[       415]    64-2      		else
[       416]    65-2      			$instancehandle->SetHint("ID=APLINFO002")
[       417]    66-2      		endif
[       418]              	
[       419]    67-2      		if (NR_TRANSACAO.TRA_TRANSACAO = 0)
[       420]    68-2      			vNrTransacao = $item("NR_TRANSACAO", voParams)
[       421]    69-2      			NR_TRANSACAO.TRA_TRANSACAO/init = vNrTransacao
[       422]    70-2      		endif
[       424]    71-2      		if (TP_FOCO.TRA_TRANSACAO = "C") & ($inDadosAdicionaisAuto$ = "T")
[       425]    72-2      			$instancehandle->BT_04()
[       426]    73-3      			if ($procerror)
[       427]    74-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       428]    75-3      			endif  
[       429]    76-2      		endif
[       430]              		
[       431]    77-1      		TP_FOCO.TRA_TRANSACAO/init = "B"    
[       432]    78-1      		BT_F5.SIS_BOTOES/init = "F5 Navegar item"
[       433]    79-1      	elseif (TP_FOCO.TRA_TRANSACAO = "B")
[       434]    80-1      		TP_FOCO.TRA_TRANSACAO/init = "I"
[       435]    81-1      		BT_F5.SIS_BOTOES/init = "F5 Lançar item"
[       436]    82-1      	endif
[       438]    83        	$instancehandle->recarregaTransacao()
[       439]    84-1      	if ($procerror)
[       440]    85-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       441]    86-1      	endif
[       443]    87        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[       445]              	;* Claudemir - Prj/Tarefa: 102/751 - 04/12/2009 
[       446]              	;  Se for ECF não concomitante e o número de série não estiver carregado na global,
[       447]              	;  leio o número de série da ECF e carrego na global
[       448]              ;	if (TP_DOCTO.GER_OPERACAO = 2) & ($item("CD_SERIEECF",$$gParamGlb) = "")
[       449]              ;		viParams = ""
[       450]              ;		putitem/id viParams, "NM_FUNCAO", 4
[       451]              ;		activate "ECFSVCO001".leInformacaoImpressora(viParams,voParams,$xcderro$,$xctxerro$)
[       452]              ;		if ($procerror)       
[       453]              ;			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       454]              ;			return(-1)	
[       455]              ;		elseif ($status < 0)
[       456]              ;			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       457]              ;			return(-1)
[       458]              ;		endif	
[       459]              ;		vDsSerie = $item("NR_SERIE", voParams)
[       460]              ;		putitem/id $$gParamGlb, "CD_SERIEECF", vDsSerie
[       461]              ;	endif ;*
[       462]              ;comentei pois existem micros que nao possuem ECF - MODA
[       463]    88        	return(0)
[       464]    89        end
[       466]              ;----------------------
[       467]******        partner operation BT_06
[       468]              ;----------------------
[       469]              	variables
[       470]              		string viParams, voParams
[       471]              		numeric vVlTotalDesc, vPrTotalDesc, vVlTotalLiquido, vVlCalc
[       472]              		numeric vVlDesconto, vVlResto,  vVlMaior, vNrOcc, vCdUsuario       
[       473]              		numeric vVlBrutoTransacao, vVlLiquidoTransacao
[       474]              	endvariables
[       476]              	;---Elia Proj. 102/314 02/06/08
[       477]              	;if ($tpSimuladorFat$ > 0)
[       478]              	;	$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto item o parâmetro por empresa TP_SIMULADOR_FAT está configurado!", "")
[       479]              	;	return(-1)
[       480]              	;endif
[       481]              	;
[       482]              	
[       483]     1-1      	if (VL_TOTALDESCCAB.TRA_TRANSITEM != 0)
[       484]     2-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto item após já ter sido aplicado desconto total!", "")
[       485]     3-1      		return(-1)
[       486]     4-1      	endif
[       487]              	
[       488]              	;Fiuza prj 41 tar 98 25/01/07 - bloquear desconto para item em promoção
[       489]     5-1      	if (($InBloqDesItemProm$ = "T") & (CD_PROMOCAO.TRA_TRANSITEM > 0))
[       490]     6-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto para item em promoção! IN_BLOQ_DESC_ITEM_PROM", "")
[       491]     7-1      		return(-1)
[       492]     8-1      	endif
[       494]     9        	$cdUsuarioDesc$ = ""
[       495]    10        	vCdUsuario = $item("CD_USUARIO", $$gParamGlb)
[       498]              	;>-- MAC - PRJ 102 TAR 789 - 03/02/2010 ----------------------;
[       499]              	; Sempre ao chamar o componente TRAFM062 passar os valores    ;
[       500]              	; da transacao e comentar a leitura da tabela TRA_LIMDESCONTO ;
[       501]              	;-------------------------------------------------------------;
[       502]              	;<ANO Pjt102 Trf784 - 21/01/2010>	
[       503]              	;if($tpLimiteDesconto$ = 1)
[       504]    11        	putitem/id viParams, "CD_EMPTRA"   , CD_EMPRESA.TRA_TRANSACAO
[       505]    12        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       506]    13        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       507]              	;</ANO Pjt102 Trf784 - 21/01/2010>
[       508]              	;else
[       509]              	;	viParams = ""
[       510]              	;	clear/e "TRA_LIMDESCONTO"
[       511]              	;	CD_OPERACAO.TRA_LIMDESCONTO/init = CD_OPERACAO.TRA_TRANSACAO
[       512]              	;	CD_USUARIO.TRA_LIMDESCONTO/init = $item("CD_USUARIO", $$gParamGlb)
[       513]              	;	retrieve/e "TRA_LIMDESCONTO"
[       514]              	;	if ($status >= 0)
[       515]              	;		putitem/id viParams, "PR_DESCMAXIMO", PR_DESCMAX.TRA_LIMDESCONTO
[       516]              	;	else	
[       517]              	;		clear/e "TRA_LIMDESCONTO"
[       518]              	;		putitem/id viParams, "PR_DESCMAXIMO", 0
[       519]              	;	endif
[       520]              	;endif
[       521]              	;-------------------------------------------------------------<
[       522]    14        	putitem/id viParams, "VL_TOTALBRUTO", VL_TOTALBRUTO.TRA_TRANSITEM
[       523]    15        	putitem/id viParams, "VL_BASEDESC", VL_TOTALBRUTO.TRA_TRANSITEM
[       524]    16        	putitem/id viParams, "VL_DESCONTO", VL_TOTALDESC.TRA_TRANSITEM
[       525]    17        	putitem/id viParams, "IN_ARREDONDAPRECO", "F"
[       526]    18        	putitem/id viParams, "IN_ALTERAVLLIQUIDO", "T"
[       527]    19        	putitem/id viParams, "CD_OPERACAO", CD_OPERACAO.TRA_TRANSACAO
[       528]    20        	putitem/id viParams, "CD_PESSOA", CD_PESSOA.TRA_TRANSACAO
[       529]    21        	$keyboard = "KB_GLOBAL"
[       530]    22        	activate "TRAFM062".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[       531]    23        	$keyboard = "KB_PDV"
[       532]    24-1      	if ($procerror)       
[       533]    25-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       534]    26-1      		return(-1)
[       535]    27-1      	endif  
[       537]    28-1      	if ($status < 0)
[       538]    29-1      		return(-1) 
[       539]    30-1      	endif
[       541]    31        	vVlTotalDesc = $item("VL_TOTALDESC", voParams)
[       542]    32        	vPrTotalDesc = $item("PR_TOTALDESC", voParams)
[       543]    33        	vVlTotalLiquido = $item("VL_TOTALLIQUIDO", voParams)
[       545]              	;* Claudemir - Prj/Tarefa: 191/1 - 30/09/2011
[       546]              	; se o desconto retornado for o mesmo que ja esta gravado no item, não faz nada
[       547]    34-1      	if (VL_TOTALDESC.TRA_TRANSITEM = vVlTotalDesc)
[       548]    35-1      		return(0)
[       549]    36-1      	endif ;*
[       551]              	;* Claudemir - Prj/Tarefa: 191/1 - 30/09/2011
[       552]    37-1      	if (TP_DOCTO.GER_OPERACAO = 3)
[       553]    38-2      		if (VL_TOTALDESC.TRA_TRANSITEM > 0)
[       554]    39-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é permitido alterar desconto para ECF concomitante!", "")
[       555]    40-2      			return(-1)			
[       556]    41-2      		endif
[       557]    42-1      	endif ;*
[       559]    43        	VL_TOTALDESC.TRA_TRANSITEM = vVlTotalDesc
[       560]    44        	VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)	
[       561]    45        	vVlCalc = VL_TOTALDESC.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       562]    46        	VL_UNITDESC.TRA_TRANSITEM = vVLCalc[round, 6]
[       563]    47        	vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       564]    48        	VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[       566]    49        	viParams = ""
[       567]    50        	putlistitems/occ viParams, "TRA_TRANSITEM"
[       568]    51        	activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       569]    52-1      	if ($procerror)       
[       570]    53-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       571]    54-1      		return(-1)
[       572]    55-1      	elseif ($status < 0)
[       573]    56-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       574]    57-1      		return(-1)
[       575]    58-1      	endif
[       577]              	;Mendes - PRJ=156/TAR=682 - 23/11/2011
[       578]    59-1      	if ($item("DS_MENSAGEM", voParams) != "")
[       579]    60-1      		message/info "%%$item("DS_MENSAGEM", voParams)"
[       580]    61-1      	endif
[       581]              	;;;   
[       583]    62-1      	if (TP_DOCTO.GER_OPERACAO = 3)
[       584]    63-2      		if ($InCupomAberto$ = "S")
[       585]              			;* Claudemir - Prj/Tarefa: 191/1 - 28/09/2011
[       586]              			;if (VL_UNITDESC.TRA_TRANSITEM > 0)
[       587]    64-3      			if (VL_TOTALDESC.TRA_TRANSITEM > 0) ;*
[       588]              				;* Claudemir - Prj/Tarefa: 191/1 - 28/09/2011
[       589]    65-3      				putitem/id viParams,"NR_ITEM", NR_ITEM.TRA_TRANSITEM	
[       590]              				;putitem/id viParams,"VL_DESCONTO", VL_UNITDESC.TRA_TRANSITEM
[       591]    66-3      				putitem/id viParams,"VL_DESCONTO", VL_TOTALDESC.TRA_TRANSITEM
[       592]    67-3      				putitem/id viParams,"DS_ACRESDESC", "D" ;*
[       593]    68-3      				activate "ECFSVCO001".acrescimoDescontoItem(viParams, voParams, $xcderro$, $xctxerro$)
[       594]    69-4      				if ($procerror)       
[       595]    70-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       596]    71-4      					rollback
[       597]    72-4      					return(-1)
[       598]    73-4      				elseif ($status = -10)
[       599]    74-4      					viParams = ""
[       600]    75-4      					voParams = ""
[       601]    76-4      					putitem/id viParams,"TITULO", "Erro de comunicação com a ECF"
[       602]    77-4      					putitem/id viParams,"MENSAGEM", $item("DESCRICAO",$xctxerro$)
[       603]    78-4      					activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[       604]    79-5      					if ($procerror)       
[       605]    80-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       606]    81-5      						rollback
[       607]    82-5      						return(-1)
[       608]    83-5      					endif
[       609]    84-4      					return(-1)
[       610]    85-4      				elseif ($status < 0)
[       611]    86-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       612]    87-4      					rollback
[       613]    88-4      					return(-1)
[       614]    89-4      				endif
[       615]    90-3      			endif	
[       616]    91-2      		endif
[       617]    92-1      	endif
[       619]    93        	commit
[       620]    94-1      	if ($status < 0)
[       621]    95-1      		rollback
[       622]    96-1      		return (-1) 
[       623]    97-1      	else
[       624]    98-1      		$instancehandle->SetHint("ID=APLINFO002")
[       625]    99-1      	endif	
[       627]   100        	$instancehandle->recarregaTransacao()
[       628]   101-1      	if ($procerror)
[       629]   102-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       630]   103-1      	endif    
[       631]              	
[       632]   104        	$prompt = TP_TRANSACAO.TRA_TRANSACAO	
[       634]   105        	return(0)
[       635]   106        end
[       637]              ;----------------------
[       638]******        partner operation BT_07
[       639]              ;----------------------	
[       641]              	variables
[       642]              		string viParams, voParams, vDsRegTroca, vDsLstTransacao, vDsRegistro, vDsLinha
[       643]              		numeric vNrTransacao, vCdUsuario, vPrDescMaximo 
[       644]              		numeric vVlDesconto, vVlTotalDesc, vPrTotalDesc, vVlResto, vVlCalc, vVlMaior, vNrOcc        
[       645]              		numeric vVlBrutoTransacao, vVlLiquidoTransacao, vVlLiquido, vCdUsuAntLib
[       646]              	endvariables
[       648]     1-1      	if ($inSimuladorProduto$ = "T")
[       649]     2-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto total o parâmetro por empresa IN_SIMULADOR_FAT_PRODUTO está configurado!", "")
[       650]     3-1      		return(-1)
[       651]     4-1      	endif
[       653]     5-1      	if ($inSimuladorCondPgto$ = "T")
[       654]     6-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto total o parâmetro por empresa IN_SIMULADOR_COND_PGTO está configurado!", "")
[       655]     7-1      		return(-1)
[       656]     8-1      	endif
[       657]              	
[       658]     9-1      	if ($tpSimuladorFat$ > 0)
[       659]    10-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto total o parâmetro por empresa TP_SIMULADOR_FAT está configurado!", "")
[       660]    11-1      		return(-1)
[       661]    12-1      	endif
[       662]              	
[       663]    13        	$cdUsuarioDesc$ = ""
[       664]    14        	vCdUsuario = $item("CD_USUARIO", $$gParamGlb)
[       666]    15        	vVlLiquido = 0
[       667]    16        	vVlDesconto = 0
[       668]    17-1      	if ($empty("TRA_TRANSITEM") = 0)
[       669]    18-1      		setocc "TRA_TRANSITEM", 1
[       670]    19-2      		while ($status >= 0)
[       671]              			;Fiuza prj 41 tar 98 25/01/07 - bloquear desconto para item em promoção
[       672]    20-3      			if (($InBloqDesItemProm$ = "T") & (CD_PROMOCAO.TRA_TRANSITEM > 0))
[       673]    21-3      			else
[       674]    22-3      				vVlLiquido = vVlLiquido +  VL_TOTALLIQUIDO.TRA_TRANSITEM
[       675]    23-3      				vVlDesconto = vVlDesconto + VL_TOTALDESCCAB.TRA_TRANSITEM
[       676]    24-3      			endif
[       677]    25-2      			setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[       678]    26-2      		endwhile
[       679]    27-1      	endif
[       681]              	;>-- MAC - PRJ 102 TAR 789 - 03/02/2010 ----------------------;
[       682]              	; Sempre ao chamar o componente TRAFM062 passar os valores    ;
[       683]              	; da transacao e comentar a leitura da tabela TRA_LIMDESCONTO ;
[       684]              	;-------------------------------------------------------------;
[       685]              	;<ANO Pjt102 Trf784 - 21/01/2010>	
[       686]              	;if($tpLimiteDesconto$ = 1)
[       687]    28        	viParams = ""
[       688]    29        	putitem/id viParams, "CD_EMPTRA"   , CD_EMPRESA.TRA_TRANSACAO
[       689]    30        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       690]    31        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       691]              	;</ANO Pjt102 Trf784 - 21/01/2010>
[       692]              	;else
[       693]              	;	viParams = ""
[       694]              	;	clear/e "TRA_LIMDESCONTO"
[       695]              	;	CD_OPERACAO.TRA_LIMDESCONTO/init = CD_OPERACAO.TRA_TRANSACAO
[       696]              	;	CD_USUARIO.TRA_LIMDESCONTO/init = $item("CD_USUARIO", $$gParamGlb)
[       697]              	;	retrieve/e "TRA_LIMDESCONTO"
[       698]              	;	if ($status >= 0)
[       699]              	;		putitem/id viParams, "PR_DESCMAXIMO", PR_DESCMAX.TRA_LIMDESCONTO
[       700]              	;	else	
[       701]              	;		clear/e "TRA_LIMDESCONTO"
[       702]              	;		putitem/id viParams, "PR_DESCMAXIMO", 0
[       703]              	;	endif
[       704]              	;endif
[       705]              	;-------------------------------------------------------------<
[       706]    32        	putitem/id viParams, "VL_TOTALBRUTO", VL_TRANSACAO.TRA_TRANSACAO
[       707]              	;vVlCalc = VL_TRANSACAO.TRA_TRANSACAO + vVlDesconto
[       708]    33        	vVlCalc = vVlLiquido + vVlDesconto
[       709]    34        	putitem/id viParams, "VL_BASEDESC", vVlCalc
[       710]    35        	putitem/id viParams, "VL_DESCONTO", vVlDesconto
[       711]    36        	putitem/id viParams, "IN_ARREDONDA_PRECO", "F"
[       712]    37        	putitem/id viParams, "CD_OPERACAO", CD_OPERACAO.TRA_TRANSACAO
[       713]    38        	putitem/id viParams, "CD_PESSOA", CD_PESSOA.TRA_TRANSACAO
[       714]    39        	activate "TRAFM062".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[       715]    40-1      	if ($procerror)       
[       716]    41-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       717]    42-1      		return(-1)
[       718]    43-1      	endif  
[       719]              	
[       720]    44-1      	if ($status < 0)
[       721]    45-1      		return(-1) 
[       722]    46-1      	endif
[       724]    47        	vVlTotalDesc = $item("VL_TOTALDESC", voParams)
[       725]    48        	vPrTotalDesc = $item("PR_TOTALDESC", voParams)
[       726]    49        	$cdUsuarioDesc$ = $item("CD_USUARIODESC", voParams)
[       727]    50        	vPrDescMaximo = $item("PR_DESCMAXIMO", voParams) ;thamati 12/05/2010 [Proj. 0156 - Tar. 0305]	
[       729]    51-1      	if ($cdUsuarioDesc$ > 0) & ($cdUsuarioDesc$ != vCdUsuario)
[       730]    52-1      		clear/e "TRA_LIMDESCONTO"
[       731]    53-1      		CD_OPERACAO.TRA_LIMDESCONTO/init = CD_OPERACAO.TRA_TRANSACAO
[       732]    54-1      		CD_USUARIO.TRA_LIMDESCONTO/init = $cdUsuarioDesc$
[       733]    55-1      		retrieve/e "TRA_LIMDESCONTO"
[       734]    56-2      		if ($status < 0)
[       735]    57-2      			clear/e "TRA_LIMDESCONTO"
[       736]    58-2      		endif
[       737]    59-1      	endif
[       738]              	
[       739]              	;thamati 12/05/2010 [Proj. 0156 - Tar. 0305]
[       740]              ;	if ($dbocc("TRA_LIMDESCONTO"))
[       741]              ;		vVlBrutoTransacao = VL_TRANSACAO.TRA_TRANSACAO + VL_DESCONTO.TRA_TRANSACAO
[       742]              ;		vVlLiquidoTransacao = VL_TRANSACAO.TRA_TRANSACAO - vVlTotalDesc
[       743]              ;		vVlCalc = (vVlBrutoTransacao - vVlLiquidoTransacao) / vVlBrutoTransacao * 100
[       744]              ;		$prDescTransacao$ = vVlCalc[round, 6]
[       745]              ;		if ($prDescTransacao$ > PR_DESCMAX.TRA_LIMDESCONTO)
[       746]              ;			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Perc. de desconto na transação de %%$prDescTransacao$ maior que o máximo permitido de %%PR_DESCMAX.TRA_LIMDESCONTO%%%! Existe desconto nos itens!", "")
[       747]              ;			return(-1)
[       748]              ;		endif
[       749]              ;	endif
[       750]              	;
[       752]    60        	vVlResto = vVlTotalDesc
[       753]              	
[       754]    61-1      	if ($empty("TRA_TRANSITEM") = 0)
[       755]    62-1      		$instancehandle->agrupaItem("F")
[       756]    63-2      		if ($procerror)
[       757]    64-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       758]    65-2      		endif
[       760]    66-1      		vVlMaior = 0
[       761]    67-1      		setocc "TRA_TRANSITEM", 1 
[       762]    68-2      		while ($status >= 0)
[       763]              			;Fiuza prj 41 tar 98 25/01/07 - bloquear desconto para item em promoção
[       764]    69-3      			if (($InBloqDesItemProm$ = "T") & (CD_PROMOCAO.TRA_TRANSITEM > 0))
[       765]    70-3      			else
[       766]              				;>-- MAC - PRJ 156/276 - 29/04/2010 ---
[       767]              				;vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM * vPrTotalDesc / 100
[       768]              				;VL_TOTALDESCCAB.TRA_TRANSITEM = vVlCalc[round, 2]
[       769]              				;VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[       770]              				;vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       771]              				;VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[       772]              				;vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       773]              				;VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[       775]    71-3      				vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM
[       776]    72-3      				vVlCalc = vVlCalc * vPrTotalDesc / 100			
[       777]    73-3      				VL_TOTALDESCCAB.TRA_TRANSITEM = vVlCalc[round, 2]
[       778]    74-3      				VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[       779]    75-3      				vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       780]    76-3      				VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[       781]    77-3      				vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       782]    78-3      				VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[       784]    79-4      				if (VL_TOTALDESCCAB.TRA_TRANSITEM > vVlResto)				
[       785]    80-4      					VL_TOTALDESCCAB.TRA_TRANSITEM = vVlResto 
[       786]    81-4      	   				VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[       787]    82-4      					vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       788]    83-4      					VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[       789]    84-4      					vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       790]    85-4      					VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[       791]    86-4      					vVlResto = 0
[       792]    87-4      					break
[       793]    88-4      				endif
[       794]              				;--<
[       796]    89-3      				vVlResto = vVlResto - VL_TOTALDESCCAB.TRA_TRANSITEM
[       797]    90-4      				if (VL_TOTALLIQUIDO.TRA_TRANSITEM > vVlMaior)
[       798]    91-4      					vVlMaior = VL_TOTALLIQUIDO.TRA_TRANSITEM
[       799]    92-4      					vNrOcc = $curocc("TRA_TRANSITEM")
[       800]    93-4      				endif
[       801]    94-3      			endif
[       802]    95-2      			setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[       803]    96-2      		endwhile
[       804]    97-2      		if (vVlResto != 0)
[       805]    98-2      			setocc "TRA_TRANSITEM", vNrOcc
[       806]    99-2      			VL_TOTALDESCCAB.TRA_TRANSITEM = VL_TOTALDESCCAB.TRA_TRANSITEM + vVlResto
[       807]   100-2      			VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[       808]   101-2      			vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       809]   102-2      			VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[       810]   103-2      			vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[       811]   104-2      			VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[       812]   105-2      		endif
[       813]              	
[       814]   106-1      		setocc "TRA_TRANSITEM", 1 
[       815]   107-2      		while ($status >= 0)
[       816]   108-2      			viParams = ""
[       817]   109-2      			putlistitems/occ viParams, "TRA_TRANSITEM"
[       818]   110-2      			activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       819]   111-3      			if ($procerror)       
[       820]   112-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       821]   113-3      				return(-1)
[       822]   114-3      			elseif ($status < 0)
[       823]   115-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       824]   116-3      				return(-1)
[       825]   117-3      			endif
[       826]   118-2      			setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[       827]   119-2      		endwhile
[       829]              		;Mendes - PRJ=156/TAR=682 - 23/11/2011
[       830]   120-2      		if ($item("DS_MENSAGEM", voParams) != "")
[       831]   121-2      			message/info "%%$item("DS_MENSAGEM", voParams)"
[       832]   122-2      		endif
[       833]              		;;;
[       835]              		;thamati 12/05/2010 [Proj. 0156 - Tar. 0305]	
[       836]   123-1      		viParams = ""
[       837]   124-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       838]   125-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       839]   126-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       840]   127-1      		putitem/id viParams, "PR_DESCMAXIMO", vPrDescMaximo
[       841]   128-1      		$keyboard = "KB_GLOBAL"
[       842]   129-1      		activate "TRAFP059".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[       843]   130-1      		$keyboard = "KB_PDV"	
[       844]   131-2      		if ($procerror)       
[       845]   132-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       846]   133-2      			rollback
[       847]   134-2      			return(-1)			
[       848]   135-2      		elseif ($status < 0)		
[       849]   136-2      			rollback
[       850]   137-2      			return(-1)
[       851]   138-2      		endif  
[       852]              		
[       853]   139-1      		vCdUsuAntLib    = $cdUsuarioDesc$ ;Hugo em 08/04/11 Tarefa 182-39
[       854]   140-1      		$cdUsuarioDesc$ = $item("CD_USUARIODESC", voParams)
[       856]   141-2      		if ($cdUsuarioDesc$ > 0) & ($cdUsuarioDesc$ != vCdUsuario)
[       857]   142-2      			clear/e "TRA_LIMDESCONTO"
[       858]   143-2      			CD_OPERACAO.TRA_LIMDESCONTO/init = CD_OPERACAO.TRA_TRANSACAO
[       859]   144-2      			CD_USUARIO.TRA_LIMDESCONTO/init = $cdUsuarioDesc$
[       860]   145-2      			retrieve/e "TRA_LIMDESCONTO"
[       861]   146-3      			if ($status < 0)
[       862]   147-3      				clear/e "TRA_LIMDESCONTO"
[       863]   148-3      			endif
[       864]              			
[       865]   149-2      			vDsLstTransacao = ""
[       866]   150-2      			vDsRegistro = ""
[       867]   151-2      			putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       868]   152-2      			putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       869]   153-2      			putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       870]   154-2      			putitem vDsLstTransacao, -1, vDsRegistro
[       872]   155-2      			vDsLinha = "Desconto liberado pelo usuario %%$cdUsuarioDesc$, componente TRAFP059"
[       873]   156-2      			viParams = ""
[       874]   157-2      			putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[       875]   158-2      			putitem/id viParams, "DS_OBSERVACAO", vDsLinha
[       876]   159-2      			putitem/id viParams, "CD_COMPONENTE", $componentname
[       877]   160-2      			putitem/id viParams, "IN_MANUTENCAO", "F"
[       878]   161-2      			putitem/id viParams, "IN_OBSNF", "F"
[       879]   162-2      			activate "TRASVCO016".gravaObsTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       880]   163-3      			if ($procerror)     
[       881]   164-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       882]   165-3      				return(-1)
[       883]   166-3      			elseif ($status < 0)
[       884]   167-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       885]   168-3      				return(-1)
[       886]   169-3      			endif
[       888]              			;Hugo em 08/04/11 Tarefa 182-39
[       889]   170-2      			$cdUsuarioDesc$ = ""
[       890]   171-2      		elseif ($cdUsuarioDesc$ = "") & (vCdUsuAntLib != "") 
[       891]   172-2      			$cdUsuarioDesc$ = vCdUsuAntLib 
[       892]   173-2      		endif
[       893]              		;
[       895]   174-1      		commit
[       896]   175-2      		if ($status < 0)
[       897]   176-2      			rollback
[       898]   177-2      			return (-1) 
[       899]   178-2      		else
[       900]   179-2      			$instancehandle->SetHint("ID=APLINFO002")
[       901]   180-2      		endif	
[       902]   181-1      	endif	
[       904]   182        	$instancehandle->recarregaTransacao()
[       905]   183-1      	if ($procerror)
[       906]   184-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       907]   185-1      	endif    
[       908]              	
[       909]   186        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[       911]   187        	return(0)
[       912]   188        end
[       914]              ;----------------------
[       915]******        partner operation BT_08
[       916]              	;----------------------
[       917]              	variables
[       918]              		string viParams, voParams
[       919]              		numeric vNrOcc, vNrItemAnt 
[       920]              	endvariables
[       921]              	
[       922]     1-1      	if ($empty("TRA_TRANSITEM") != 0)
[       923]     2-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação não possui nenhuma item a ser removido!", "")
[       924]     3-1      		return(-1)
[       925]     4-1      	endif
[       927]              	;---Elia Proj. 102/551 13/05/09
[       928]              	;;---Elia Proj. 102/434 29/10/08
[       929]              	;;---Elia Proj. 102/162 27/11/07
[       930]              	;;if ($inBloqExcluiItem$ = "T") 
[       931]              	;;if ($inBloqExcluiItem$ = "T") & (CD_USUIMPRESSAO.TRA_TRANSACAO > 0)
[       932]              	;if ($inBloqExcluiItem$ = 1) | ($inBloqExcluiItem$ = 2) ; 1 - Sim - Nao permiti sair do componente / 2 - Sim - Permiti sai do componente
[       933]              	;* Claudemir - Prj/Tarefa: 156/99  - 04/11/2009 (Inclusão da validação da opção 4 do parâmetro: IN_BLOQ_EXCLUIR_ITEM)
[       934]              	;if ((($inBloqExcluiItem$ = 1) | ($inBloqExcluiItem$ = 2)) & (CD_USUIMPRESSAO.TRA_TRANSACAO > 0)) | ($inBloqExcluiItem$ = 3) ;
[       935]     5-1      	if ((($inBloqExcluiItem$ = 1) | ($inBloqExcluiItem$ = 2)) & (CD_USUIMPRESSAO.TRA_TRANSACAO > 0)) | ($inBloqExcluiItem$ = 3) | ($inBloqExcluiItem$ = 4) ;* 	
[       936]     6-1      		viParams = ""
[       937]     7-1      		putitem/id viParams, "IN_USULOGADO", "T"
[       938]              		;putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO", $$gParamGlb)
[       939]     8-1      		putitem/id viParams, "DS_COMPONENTE", "TRAFM060EX"
[       940]     9-1      		activate "ADMFM020".exec(viParams, voParams, $xCdErro$, $xCtxerro$)
[       941]    10-2      		if ($procerror)  
[       942]    11-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")     
[       943]    12-2      			return (-1)
[       944]    13-2      		endif
[       945]    14-2      		if ($status < 0)
[       946]    15-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Função bloqueada!", "ADICIONAL=Parâmetro empresa->IN_BLOQ_EXCLUIR_ITEM")
[       947]    16-2      			return(-1)		
[       948]    17-2      		endif
[       949]    18-1      	endif
[       951]    19        	askmess "Deseja realmente remover o registro?","Remover,Cancelar"
[       952]    20-1      	if ($status = 2) 
[       953]    21-1      		return (-1)
[       954]    22-1      	endif
[       955]              	
[       956]    23        	viParams = ""
[       957]    24        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       958]    25        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       959]    26        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       960]    27        	putitem/id viParams, "NR_ITEM", NR_ITEM.TRA_TRANSITEM
[       961]    28        	activate "TRASVCO004".removeItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       962]    29-1      	if ($procerror)       
[       963]    30-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       964]    31-1      		return(-1)
[       965]    32-1      	elseif ($status < 0)
[       966]    33-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       967]    34-1      		return(-1)
[       968]    35-1      	endif
[       969]              	
[       970]    36-1      	if (TP_DOCTO.GER_OPERACAO = 3)
[       971]    37-1      		viParams = ""
[       972]    38-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       973]    39-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       974]    40-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       975]    41-1      		putitem/id viParams, "NR_ITEM", NR_ITEM.TRA_TRANSITEM		
[       976]    42-1      		activate "ECFSVCO010".cancelaItem($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       977]    43-2      		if ($procerror)       
[       978]    44-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       979]    45-2      			return(-1)
[       980]    46-2      		elseif ($status = -10)
[       981]    47-2      			viParams = ""
[       982]    48-2      			voParams = ""
[       983]    49-2      			putitem/id viParams,"TITULO", "Erro de comunicação com a ECF"
[       984]    50-2      			putitem/id viParams,"MENSAGEM", $item("DESCRICAO",$xctxerro$)
[       985]    51-2      			activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[       986]    52-3      			if ($procerror)       
[       987]    53-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       988]    54-3      				rollback
[       989]    55-3      				return(-1)
[       990]    56-3      			endif
[       991]    57-2      			rollback
[       992]    58-2      			return(-1)
[       993]    59-2      		elseif ($status = -50)
[       994]    60-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       995]    61-2      			apexit
[       996]    62-2      		elseif ($status < 0)
[       997]    63-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       998]    64-2      			return(-1)
[       999]    65-2      		endif
[      1000]              		;-=LSC=- (14/04/2008) TAR 280 PRJ 102 - ITEM ECF CONCOMITANTE NAO PERDER A SEQUENCIA
[      1001]    66-1      		vNrItemAnt = NR_ITEM.TRA_TRANSITEM
[      1002]    67-2      		if (vNrItemAnt > $vNrItem$) 
[      1003]    68-2      			$vNrItem$ = vNrItemAnt	
[      1004]    69-2      		endif
[      1005]              		;
[      1006]    70-1      	endif
[      1007]              	
[      1008]    71        	commit
[      1009]    72-1      	if ($status < 0)
[      1010]    73-1      		rollback
[      1011]    74-1      		return (-1) 
[      1012]    75-1      	else
[      1013]    76-1      		$instancehandle->SetHint("ID=APLINFO002")
[      1014]    77-1      	endif
[      1015]              	
[      1016]    78        	$instancehandle->recarregaTransacao()
[      1017]    79-1      	if ($procerror)
[      1018]    80-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1019]    81-1      	endif    
[      1020]              	
[      1021]    82        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[      1022]              	
[      1023]    83        	return(0)
[      1024]    84        end
[      1026]              ;----------------------
[      1027]******        partner operation BT_09
[      1028]              ;----------------------
[      1029]              	variables
[      1030]              		string viParams, voParams, vDsLstColetor
[      1031]              		boolean vInAgruparItem, vInColetor
[      1032]              		numeric vCdPessoa, vCdPessoaAnt
[      1033]              	endvariables
[      1035]     1        	viParams = ""
[      1036]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1037]     3        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1038]     4        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1039]     5        	putitem/id viParams, "TP_FOCO", TP_FOCO.TRA_TRANSACAO
[      1040]     6-1      	if($empty("TRA_TRANSITEM") = 1)
[      1041]     7-1      		putitem/id viParams, "IN_ITENS", "F"
[      1042]     8-1      	endif
[      1043]     9        	$keyboard = "KB_GLOBAL"
[      1044]    10        	activate "TRAFP011".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1045]    11        	$keyboard = "KB_PDV"
[      1046]    12-1      	if ($procerror)       
[      1047]    13-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1048]    14-1      		return(-1)
[      1049]    15-1      	endif	
[      1051]    16-1      	if ($status >= 0)
[      1052]    17-1      		vInAgruparItem = $item("IN_AGRUPARITEM", voParams)
[      1053]    18-2      		if (vInAgruparItem = "T")
[      1054]    19-2      			$instancehandle->agrupaItem("T")
[      1055]    20-3      			if ($procerror)
[      1056]    21-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1057]    22-3      			endif	
[      1058]    23-2      		endif
[      1059]    24-2      		if ($item("IN_AGRUPATRANSACAO", voParams) = "T");carrega transacao agrupada
[      1060]    25-2      			clear/e "TRA_TRANSACAO"
[      1061]    26-2      			DT_TRANSACAO.TRA_TRANSACAO = $item("DT_TRANSACAO", voParams)
[      1062]    27-2      			NR_TRANSACAO.TRA_TRANSACAO = $item("NR_TRANSACAO",voParams)
[      1063]    28-2      			retrieve/e "TRA_TRANSACAO"
[      1064]    29-2      		endif
[      1065]    30-1      		vInColetor = $item("IN_ENTRADACOLETOR", voParams)
[      1066]    31-2      		if (vInColetor = "T")
[      1067]    32-2      			vDsLstColetor = $item("DS_LSTCOLETOR",voParams)	
[      1068]    33-3      			if (vDsLstColetor != "")
[      1069]    34-3      				$instancehandle->entradaColetor(vDsLstColetor)
[      1070]    35-4      				if ($procerror)
[      1071]    36-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1072]    37-4      				endif
[      1073]    38-3      			endif
[      1074]    39-2      		endif	
[      1075]    40-1      	endif
[      1077]    41        	vCdPessoa = $item("CD_PESSOA", voParams)
[      1078]    42        	vCdPessoaAnt = CD_PESSOA.TRA_TRANSACAO
[      1080]    43-1      	if ($dbocc("TRA_TRANSACAO"))
[      1081]    44-1      		$instancehandle->recarregaTransacao()
[      1082]    45-2      		if ($procerror)
[      1083]    46-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1084]    47-2      		endif	
[      1085]    48-1      	endif
[      1086]              	
[      1087]    49-1      	if (NR_TRANSACAO.TRA_TRANSACAO > 0) & (vCdPessoa > 0) & (vCdPessoa != vCdPessoaAnt)
[      1088]    50-1      		clear/e "PES_PESSOA"
[      1089]    51-1      		CD_PESSOA.PES_PESSOA/init = vCdPessoa
[      1090]    52-1      		retrieve/e "PES_PESSOA"
[      1091]              		
[      1092]    53-1      		viParams = ""
[      1093]    54-1      		putlistitems/occ viParams, "TRA_TRANSACAO"
[      1094]    55-1      		activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1095]    56-2      		if ($procerror)       
[      1096]    57-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1097]    58-2      			return(-1)
[      1098]    59-2      		elseif ($status < 0)
[      1099]    60-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1100]    61-2      			return(-1)
[      1101]    62-2      		endif
[      1102]              		
[      1103]    63-1      		commit
[      1104]    64-2      		if ($status < 0)
[      1105]    65-2      			rollback
[      1106]    66-2      			return (-1) 
[      1107]    67-2      		else
[      1108]    68-2      			$instancehandle->SetHint("ID=APLINFO002")
[      1109]    69-2      		endif
[      1110]              		
[      1111]    70-2      		if (vCdPessoa != $cdCliente$)
[      1112]    71-2      			$instancehandle->buscaAniversario()
[      1113]    72-3      			if ($procerror)
[      1114]    73-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1115]    74-3      			endif
[      1116]    75-2      		endif
[      1117]    76-1      	endif
[      1119]    77        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[      1120]              	
[      1121]    78        	return(0)
[      1122]    79        end
[      1124]              ;----------------------
[      1125]******        partner operation BT_11
[      1126]              ;----------------------
[      1128]              	variables
[      1129]              		string viParams, voParams, vDsLstTransacao, vDsLstEncargoFin, vDsLstVariacao
[      1130]              		string vDsRegistro, vDsComponente, vDsLinha, vDsLstEmpresa, vDsLstNF, vDsLstLiquidacao
[      1131]              		numeric vVlTrocoMaximoTra, vVlTrocoMaximoEnc, vCdUsuario, vStatus, vTpVariacao, vVlDescVariacao
[      1132]              		numeric vCdOperTroca, vVlTroca, vCdOperNF, vTpValidacaoConf, vQtTotal, vPrDescVariacao, vQtMinima, vQtMaxima
[      1133]              		boolean vInImprimir, vInTrocoMaximo, vInSangria, vInFatura, vInMostraTroco, vInConsultaSaldoCredev
[      1134]              		numeric vVlResto, vVlCalc, vVlMaior, vPrTotalDesc, vNrOcc, vVlTotalDesconto, vVlTotalBruto, vTotalDescCab, vPrTotalDescCab
[      1135]              	endvariables
[      1137]     1        	vTpValidacaoConf = $item("TP_VALIDACAO_CONF_TRA", $xlplemp$)
[      1138]              	
[      1139]     2-1      	if ($empty("R_TRA_TRANSACAO") = 0)
[      1140]     3-2      		if (CD_PESSOA.TRA_TRANSACAO != CD_PESSOA.R_TRA_TRANSACAO)
[      1141]     4-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Pessoa da transação de vale troca(%%CD_PESSOA.R_TRA_TRANSACAO%%%) diferente da transação de troca(%%CD_PESSOA.TRA_TRANSACAO%%%)!", "")
[      1142]     5-2      			return(-1)
[      1143]     6-2      		endif
[      1145]     7-2      		if ($InMantVendValeTroca$ = "F");;
[      1146]     8-2      			viParams = ""
[      1147]     9-2      			putitem/id viParams "CD_EMPRESA", CD_EMPRESA.R_TRA_TRANSACAO
[      1148]    10-2      			putitem/id viParams "NR_TRANSACAO", NR_TRANSACAO.R_TRA_TRANSACAO
[      1149]    11-2      			putitem/id viParams "DT_TRANSACAO", DT_TRANSACAO.R_TRA_TRANSACAO
[      1150]    12-2      			putitem/id viParams "CD_COMPVEND", CD_COMPVEND.TRA_TRANSACAO
[      1151]    13-2      			activate "TRASVCO004".alteraVendedorTransacaoNF($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1152]    14-3      			if($procerror)
[      1153]    15-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1154]    16-3      				rollback
[      1155]    17-3      				return(-1)
[      1156]    18-3      			elseif ($status < 0)
[      1157]    19-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1158]    20-3      				rollback
[      1159]    21-3      				return(-1)
[      1160]    22-3      			endif	
[      1161]    23-2      		endif	
[      1162]    24-1      	endif
[      1163]              	
[      1164]    25-1      	if (CD_COMPVEND.TRA_TRANSACAO = 0) & ($cdCompVend$ != 0)
[      1165]    26-1      		clear/e "PES_VENDEDOR"
[      1166]    27-1      		CD_VENDEDOR.PES_VENDEDOR/init = $cdCompVend$
[      1167]    28-1      		retrieve/e "PES_VENDEDOR"
[      1168]    29-1      	endif
[      1169]              	
[      1170]              	;------------------------------
[      1171]              	;Hugo em 02/02/11 Tarefa 182-14
[      1172]    30-1      	if (TP_MODALIDADE.GER_OPERACAO = 4) & (TP_OPERACAO.TRA_TRANSACAO = "S") ;Venda
[      1173]    31-1      		viParams = ""
[      1174]    32-1      		putitem/id viParams, "CD_OPERACAO", CD_OPERACAO.TRA_TRANSACAO
[      1175]    33-1      		activate "GERSVCO054".dadosAdicionaisOperacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      1176]    34-2      		if ($procerror)       
[      1177]    35-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1178]    36-2      			return(-1)
[      1179]    37-2      		elseif ($status < 0)
[      1180]    38-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1181]    39-2      			return(-1)
[      1182]    40-2      		endif
[      1183]              		
[      1184]    41-1      		vQtMinima = $item("QT_MINIMA", voParams)
[      1185]    42-1      		vQtMaxima = $item("QT_MAXIMA", voParams)
[      1186]              		
[      1187]    43-2      		if (vQtMinima > 0) & (QT_SOLICITADA.TRA_TRANSACAO < vQtMinima)
[      1188]    44-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação %%NR_TRANSACAO.TRA_TRANSACAO não possui quantidade mínima %%vQtMinima%%% por operação!", "")
[      1189]    45-2      			return(-1)
[      1190]    46-2      		elseif (vQtMaxima > 0) & (QT_SOLICITADA.TRA_TRANSACAO > vQtMaxima)
[      1191]    47-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação %%NR_TRANSACAO.TRA_TRANSACAO ultrapassou a quantidade máxima %%vQtMaxima%%% por operação!", "")
[      1192]    48-2      			return(-1)
[      1193]    49-2      		endif
[      1194]    50-1      	endif
[      1195]              	;------------------------------
[      1196]              	
[      1197]    51        	viParams = ""
[      1198]    52        	putlistitems/occ viParams, "TRA_TRANSACAO"
[      1199]    53        	activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1200]    54-1      	if ($procerror)       
[      1201]    55-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1202]    56-1      		rollback
[      1203]    57-1      		return(-1)
[      1204]    58-1      	elseif ($status < 0)
[      1205]    59-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1206]    60-1      		rollback
[      1207]    61-1      		return(-1)
[      1208]    62-1      	endif
[      1210]              	; --- DIONE |156/380| 30/07/2010
[      1211]    63-1      	if($nrDiaAtraso$ <= $nrDiasCarenciaAtraso$) & ($nrDiasCarenciaAtraso$ > 0) & ($nrDiaAtraso$ > 0)
[      1212]    64-1      		$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Cliente com %%$nrDiaAtraso$ dias em atraso!", "")
[      1213]    65-1      	endif
[      1214]              	; ---
[      1216]    66-1      	if (vTpValidacaoConf = 2) | (vTpValidacaoConf = 3)
[      1217]    67-1      		viParams = ""
[      1218]    68-1      		$keyboard = "KB_GLOBAL"
[      1219]    69-1      		putitem/id viParams, "QT_TOTAL", QT_SOLICITADA.TRA_TRANSACAO ; DIONE |156/381| 30/07/2010	
[      1220]    70-1      		activate "TRAFP058".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1221]    71-1      		$keyboard = "KB_PDV"
[      1222]    72-2      		if ($procerror)       
[      1223]    73-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1224]    74-2      			return(-1)
[      1225]    75-2      		elseif ($status < 0)
[      1226]    76-2      			$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Quantidade para conferência obrigatória!", "")
[      1227]    77-2      			return(-1)
[      1228]    78-2      		endif
[      1229]              		
[      1230]              		; --- DIONE |156/381| 30/07/2010
[      1231]    79-2      		if(vTpValidacaoConf = 3)	
[      1232]              			
[      1233]    80-2      			CD_USUCONF.TRA_TRANSACAO = $item("CD_USUCONF", voParams)	
[      1234]    81-2      			viParams = ""
[      1235]    82-2      			putlistitems/occ viParams, "TRA_TRANSACAO"
[      1236]    83-2      			activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1237]    84-3      			if ($procerror)       
[      1238]    85-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1239]    86-3      				return(-1)
[      1240]    87-3      			elseif ($status < 0)
[      1241]    88-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1242]    89-3      				return(-1)
[      1243]    90-3      			endif	
[      1244]    91-2      		endif
[      1245]              		; ---		
[      1246]    92-1      	endif
[      1247]              	
[      1248]    93-1      	if ($tpAgrupamento$ = 0 | $tpAgrupamento$ = 3)
[      1249]    94-1      		$instancehandle->agrupaItem("F")
[      1250]    95-2      		if ($procerror)
[      1251]    96-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1252]    97-2      			rollback
[      1253]    98-2      			return(-1)
[      1254]    99-2      		elseif ($status < 0)
[      1255]   100-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1256]   101-2      			rollback
[      1257]   102-2      			return(-1)
[      1258]   103-2      		endif
[      1259]   104-1      	endif
[      1261]   105        	vCdUsuario = $item("CD_USUARIO", $$gParamGlb)
[      1263]   106-1      	if ($cdUsuarioDesc$ > 0) & ($cdUsuarioDesc$ != vCdUsuario)
[      1264]   107-1      		vDsLstTransacao = ""
[      1265]   108-1      		vDsRegistro = ""
[      1266]   109-1      		putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1267]   110-1      		putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1268]   111-1      		putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1269]   112-1      		putitem vDsLstTransacao, -1, vDsRegistro
[      1271]   113-1      		vDsLinha = "Desconto liberado pelo usuario %%$cdUsuarioDesc$"
[      1272]   114-1      		viParams = ""
[      1273]   115-1      		putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1274]   116-1      		putitem/id viParams, "DS_OBSERVACAO", vDsLinha
[      1275]   117-1      		putitem/id viParams, "CD_COMPONENTE", $componentname
[      1276]   118-1      		putitem/id viParams, "IN_OBSNF", "F"
[      1277]   119-1      		activate "TRASVCO016".gravaObsTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1278]   120-2      		if ($procerror)     
[      1279]   121-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1280]   122-2      			rollback
[      1281]   123-2      			return(-1)
[      1282]   124-2      		elseif ($status < 0)
[      1283]   125-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1284]   126-2      			rollback
[      1285]   127-2      			return(-1)
[      1286]   128-2      		endif
[      1287]   129-1      		$cdUsuarioDesc$ = ""
[      1288]   130-1      	endif
[      1289]              	
[      1290]              	;--> ALX - 191/11 - 11/11/2011 --;
[      1291]   131-1      	if($tpUtilizaBoleta$ = 2)
[      1292]   132-1      		viParams = ""
[      1293]   133-1      		$keyboard = "KB_GLOBAL"
[      1294]   134-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1295]   135-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1296]   136-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1297]   137-1      		activate "TRAFM140".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1298]   138-1      		$keyboard = "KB_PDV"
[      1299]   139-2      		if ($procerror)       
[      1300]   140-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1301]   141-2      			return(-1)
[      1302]   142-2      		elseif ($status < 0)
[      1303]   143-2      			return(-1)
[      1304]   144-2      		endif
[      1305]   145-1      	endif
[      1306]              	;--<
[      1308]   146        	commit
[      1309]   147-1      	if ($status < 0)
[      1310]   148-1      		rollback
[      1311]   149-1      		return (-1) 
[      1312]   150-1      	else
[      1313]   151-1      		$instancehandle->SetHint("ID=APLINFO002")
[      1314]   152-1      	endif    
[      1316]   153        	vCdOperTroca = $item("CD_OPER_TROCA_VALOR_VD", $xlplemp$)
[      1317]   154        	vVlTroca = $item("VL_TROCA_TPVALOR_VD", $xlplemp$)
[      1319]   155-1      	if (vCdOperTroca != 0) & (VL_TRANSACAO.TRA_TRANSACAO >= vVlTroca) & (TP_MODALIDADE.GER_OPERACAO = 4) & (TP_OPERACAO.TRA_TRANSACAO = "S") ;Venda
[      1320]   156-1      		$vlTransacaoAnt$ = VL_TRANSACAO.TRA_TRANSACAO
[      1321]              		
[      1322]   157-1      		viParams = ""
[      1323]   158-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1324]   159-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1325]   160-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1326]   161-1      		putitem/id viParams, "CD_OPERACAO", vCdOperTroca
[      1327]   162-1      		putitem/id viParams, "CD_OPERACAONF", vCdOperNF
[      1328]   163-1      		activate "TRASVCO024".trocaOperacaoTra($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1329]   164-2      		if ($procerror)       
[      1330]   165-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1331]   166-2      			return(-1)
[      1332]   167-2      		elseif ($status < 0)
[      1333]   168-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1334]   169-2      			return(-1)
[      1335]   170-2      		endif	
[      1336]              		
[      1337]   171-1      		commit
[      1338]   172-2      		if ($status < 0)
[      1339]   173-2      			rollback
[      1340]   174-2      			return (-1) 
[      1341]   175-2      		else
[      1342]   176-2      			$instancehandle->SetHint("ID=APLINFO002")
[      1343]   177-2      		endif
[      1344]              		
[      1345]   178-1      		$instancehandle->recarregaTransacao()
[      1346]   179-2      		if ($procerror)
[      1347]   180-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1348]   181-2      		endif
[      1349]              		
[      1350]   182-1      		message/info "Valor total antigo: %%$vlTransacaoAnt$   Valor total novo: %%VL_TRANSACAO.TRA_TRANSACAO%%%.%%^Troca de operação, parâmetros: CD_OPER_TROCA_VALOR_VD e VL_TROCA_TPVALOR_VD"
[      1351]   183-1      	endif
[      1352]              	
[      1353]   184-1      	if (TP_MODALIDADE.GER_OPERACAO = 4) & (TP_OPERACAO.TRA_TRANSACAO = "S") ;Venda
[      1354]   185-2      		if ($qtPecasDescontoVlMin$ > 0)
[      1355]   186-2      			$instancehandle->aplicaQtPecasDescontoVlMin()
[      1356]   187-3      			if ($procerror)
[      1357]   188-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1358]   189-3      				rollback
[      1359]   190-3      				return(-1)
[      1360]   191-3      			elseif ($status < 0)
[      1361]   192-3      				rollback
[      1362]   193-3      				return(-1)
[      1363]   194-3      			endif
[      1364]   195-2      		endif
[      1365]              		
[      1366]   196-1      		vTpVariacao = $item("TP_VARIACAO_DESCONTO_VD", $xlplemp$)
[      1367]   197-2      		if (vTpVariacao = 1)
[      1368]   198-2      			viParams = ""
[      1369]   199-2      			putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1370]   200-2      			putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1371]   201-2      			putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1372]   202-2      			activate "TRASVCO005".descontoVariacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1373]   203-3      			if ($procerror)
[      1374]   204-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1375]   205-3      				return(-1)
[      1376]   206-3      			elseif ($status < 0)
[      1377]   207-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1378]   208-3      				return(-1)
[      1379]   209-3      			endif			
[      1380]              			
[      1381]   210-2      			vDsLstVariacao  = $item("DS_LSTRETORNO", voParams)
[      1382]   211-2      			vVlDescVariacao = $item("VL_DESCONTO", voParams)
[      1383]   212-2      			vPrDescVariacao = $item("PR_DESCONTO", voParams)
[      1385]              			;* Claudemir - Prj/Tarefa: 102/965 - 06/10/2010
[      1386]   213-3      			if (vDsLstVariacao != "")
[      1387]   214-3      				viParams = ""
[      1388]   215-3      				putitem/id viParams, "TITULO", "Item com variação de desconto"
[      1389]   216-3      				putitem/id viParams, "MENSAGEM", vDsLstVariacao
[      1390]   217-3      				activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[      1391]   218-4      				if ($procerror)       
[      1392]   219-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1393]   220-4      					rollback
[      1394]   221-4      					return(-1)
[      1395]   222-4      				endif
[      1397]   223-3      				askmess "Confirma variação de desconto?" , "Sim, Não"
[      1398]   224-4      				if ($status = 2) ;Não
[      1399]   225-4      					rollback ; <-- Hugo em 20/10/10 Precisava do rollback para desfazer a aplicação do desconto
[      1400]   226-4      					return(-1)
[      1401]   227-4      				endif
[      1402]   228-3      			endif	  ;*
[      1404]   229-3      			if (vPrDescVariacao > 0)
[      1405]              				;* Claudemir - Prj/Tarefa: 102/965 - 06/10/2010
[      1406]   230-3      				vPrTotalDescCab = 0
[      1407]   231-3      				vTotalDescCab   = 0
[      1408]   232-3      				setocc "TRA_TRANSITEM", 1 
[      1409]   233-4      				while ($status >= 0)
[      1410]   234-4      					vTotalDescCab   = vTotalDescCab + VL_TOTALDESCCAB.TRA_TRANSITEM
[      1411]   235-4      					setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      1412]   236-4      				endwhile
[      1413]   237-3      				vPrTotalDescCab = (vTotalDescCab / (VL_TRANSACAO.TRA_TRANSACAO + vTotalDescCab)) * 100 ;*
[      1415]              				;* Claudemir - Prj/Tarefa: 102/965 - 06/10/2010
[      1416]              				;vVlResto     = vVlDescVariacao
[      1417]   238-3      				vVlResto     = vVlDescVariacao + vTotalDescCab ;*
[      1419]              				;* Claudemir - Prj/Tarefa: 102/965 - 06/10/2010
[      1420]              				;vPrTotalDesc = vPrDescVariacao
[      1421]   239-3      				vPrTotalDesc = vPrDescVariacao + vPrTotalDescCab ;*
[      1422]              			
[      1423]   240-4      				if ($empty("TRA_TRANSITEM") = 0)
[      1424]   241-4      					vVlMaior = 0
[      1425]   242-4      					setocc "TRA_TRANSITEM", 1 
[      1426]   243-5      					while ($status >= 0)
[      1427]   244-5      						vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM
[      1428]   245-5      						vVlCalc = vVlCalc * vPrTotalDesc / 100			
[      1429]   246-5      						VL_TOTALDESCCAB.TRA_TRANSITEM = vVlCalc[round, 2]
[      1430]              	
[      1431]   247-5      						VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      1432]   248-5      						vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      1433]   249-5      						VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[      1434]   250-5      						vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      1435]   251-5      						VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      1436]              					
[      1437]   252-6      						if (VL_TOTALDESCCAB.TRA_TRANSITEM > vVlResto)				
[      1438]   253-6      							VL_TOTALDESCCAB.TRA_TRANSITEM = vVlResto 
[      1439]   254-6      	   					VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      1440]   255-6      							vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      1441]   256-6      							VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[      1442]   257-6      							vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      1443]   258-6      							VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      1444]   259-6      							vVlResto = 0
[      1445]   260-6      							break
[      1446]   261-6      						endif
[      1447]              					
[      1448]   262-5      						vVlResto = vVlResto - VL_TOTALDESCCAB.TRA_TRANSITEM
[      1449]              					
[      1450]   263-6      						if (VL_TOTALLIQUIDO.TRA_TRANSITEM > vVlMaior)
[      1451]   264-6      							vVlMaior = VL_TOTALLIQUIDO.TRA_TRANSITEM
[      1452]   265-6      							vNrOcc = $curocc("TRA_TRANSITEM")
[      1453]   266-6      						endif
[      1454]              					
[      1455]   267-5      						setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      1456]   268-5      					endwhile
[      1457]   269-4      				endif
[      1458]              			
[      1459]   270-4      				if (vVlResto != 0)
[      1460]   271-4      					setocc "TRA_TRANSITEM", vNrOcc
[      1461]   272-4      					VL_TOTALDESCCAB.TRA_TRANSITEM = VL_TOTALDESCCAB.TRA_TRANSITEM + vVlResto
[      1462]   273-4      					VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      1463]   274-4      					vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      1464]   275-4      					VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[      1465]   276-4      					vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      1466]   277-4      					VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      1467]   278-4      				endif
[      1468]              			
[      1469]   279-3      				setocc "TRA_TRANSITEM", 1 
[      1470]   280-4      				while ($status >= 0)
[      1471]   281-4      					viParams = ""
[      1472]   282-4      					putlistitems/occ viParams, "TRA_TRANSITEM"
[      1473]   283-4      					putitem/id viParams, "IN_TOTAL", "F"
[      1474]   284-4      					putitem/id viParams, "IN_NAOVALIDALOTE", "T"
[      1475]   285-4      					activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1476]   286-5      					if ($procerror)       
[      1477]   287-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1478]   288-5      						return(-1)
[      1479]   289-5      					elseif ($status < 0)
[      1480]   290-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1481]   291-5      						return(-1)
[      1482]   292-5      					endif
[      1483]   293-4      					setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      1484]   294-4      				endwhile
[      1486]              				;Mendes - PRJ=156/TAR=682 - 23/11/2011
[      1487]   295-4      				if ($item("DS_MENSAGEM", voParams) != "")
[      1488]   296-4      					message/info "%%$item("DS_MENSAGEM", voParams)"
[      1489]   297-4      				endif
[      1490]              				;;;
[      1491]              			
[      1492]   298-3      				vDsLstTransacao = ""
[      1493]   299-3      				vDsRegistro = ""
[      1494]   300-3      				putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1495]   301-3      				putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1496]   302-3      				putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1497]   303-3      				putitem vDsLstTransacao, -1, vDsRegistro    
[      1498]   304-3      				putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1499]   305-3      				activate "TRASVCO004".gravaTotalTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1500]   306-4      				if ($procerror)       
[      1501]   307-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1502]   308-4      					return(-1)
[      1503]   309-4      				elseif ($status < 0)
[      1504]   310-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1505]   311-4      					return(-1)
[      1506]   312-4      				endif	
[      1507]              			
[      1508]   313-3      				commit
[      1509]   314-4      				if ($status < 0)
[      1510]   315-4      					rollback
[      1511]   316-4      					return (-1) 
[      1512]   317-4      				else
[      1513]   318-4      					$instancehandle->SetHint("ID=APLINFO002")
[      1514]   319-4      				endif
[      1515]              			
[      1516]              				;* Claudemir - Prj/Tarefa: 102/965 - 06/10/2010
[      1517]              				; movida a lógica abaixo para cima
[      1519]              				;if (vDsLstVariacao != "")
[      1520]              				;	viParams = ""
[      1521]              				;	putitem/id viParams, "TITULO", "Item com variação de desconto"
[      1522]              				;	putitem/id viParams, "MENSAGEM", vDsLstVariacao
[      1523]              				;	activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[      1524]              				;	if ($procerror)       
[      1525]              				;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1526]              				;		rollback
[      1527]              				;		return(-1)
[      1528]              				;	endif
[      1529]              				;endif ;*
[      1530]              			
[      1531]   320-3      				$instancehandle->recarregaTransacao()
[      1532]   321-4      				if ($procerror)
[      1533]   322-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1534]   323-4      				endif
[      1535]   324-3      			endif
[      1536]   325-2      		endif
[      1537]   326-1      	endif
[      1538]              		
[      1539]   327-1      	if ($inUtilizaCTC$ = "T")
[      1540]   328-1      		$instancehandle->carregaBonusCartao()
[      1541]   329-2      		if ($procerror)
[      1542]   330-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1543]   331-2      			rollback
[      1544]   332-2      			return(-1)
[      1545]   333-2      		elseif ($status < 0)
[      1546]   334-2      			rollback
[      1547]   335-2      			return(-1)
[      1548]   336-2      		endif
[      1549]   337-1      	endif
[      1550]              	
[      1551]   338        	$instancehandle->bonusDesconto()
[      1552]   339-1      	if ($procerror)
[      1553]   340-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      1554]   341-1      		rollback
[      1555]   342-1      		return(-1)
[      1556]   343-1      	elseif ($status < 0)
[      1557]   344-1      		rollback
[      1558]   345-1      		return(-1)
[      1559]   346-1      	endif
[      1561]   347        	$instancehandle->carregaFormaPagamento()
[      1562]   348-1      	if ($procerror)
[      1563]   349-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      1564]   350-1      		rollback
[      1565]   351-1      		return(-1)
[      1566]   352-1      	elseif ($status < 0)
[      1567]   353-1      		rollback
[      1568]   354-1      		return(-1)
[      1569]   355-1      	endif
[      1570]              	
[      1571]   356        	vInImprimir = "T"
[      1572]   357-1      	if ($tpImpressaoTraVenda$ != 1) & ($tpImpressaoTraVenda$ != 2)
[      1573]   358-1      		vInImprimir = "F"
[      1574]   359-1      	endif
[      1575]              	
[      1576]   360-1      	if (vInImprimir = "T")
[      1577]   361-1      		viParams = ""
[      1578]   362-1      		putitem/id viParams, "CD_OPERACAO", CD_OPERACAO.GER_OPERACAO
[      1579]   363-1      		activate "GERSVCO054".dadosAdicionaisOperacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1580]   364-2      		if ($procerror)       
[      1581]   365-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1582]   366-2      			return(-1)
[      1583]   367-2      		elseif ($status < 0)
[      1584]   368-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1585]   369-2      			return(-1)
[      1586]   370-2      		endif	
[      1587]              		
[      1588]   371-2      		if ($item("TP_IMPRESSAOTRA", voParams) = 1)
[      1589]   372-2      			vInImprimir = "F"
[      1590]   373-2      		endif
[      1591]   374-1      	endif
[      1592]              	
[      1593]   375-1      	if (vInImprimir = "T")
[      1594]   376-1      		viParams = ""
[      1595]   377-1      		vDsLstTransacao = ""
[      1596]   378-1      		vDsRegistro = ""
[      1597]   379-1      		putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1598]   380-1      		putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1599]   381-1      		putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1600]   382-1      		putitem vDsLstTransacao, -1, vDsRegistro	
[      1601]   383-1      		putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1602]   384-2      		if (TP_MODALIDADE.GER_OPERACAO = 4 | TP_MODALIDADE.GER_OPERACAO = 3 | TP_MODALIDADE.GER_OPERACAO = 8) ;Venda/Devolucao/Troca
[      1603]   385-3      			if ($tpImpressaoTraVenda$ = 02)
[      1604]   386-3      				putitem/id viParams, "IN_DIRETO", "F"
[      1605]   387-3      			else
[      1606]   388-3      				putitem/id viParams, "IN_DIRETO", "T"
[      1607]   389-3      			endif
[      1608]   390-2      		else
[      1609]   391-2      			putitem/id viParams, "IN_DIRETO", "F"
[      1610]   392-2      		endif
[      1611]              		
[      1612]   393-1      		$keyboard = "KB_GLOBAL"
[      1613]   394-1      		activate "TRAFP004".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1614]   395-1      		$keyboard = "KB_PDV"
[      1615]   396-2      		if ($procerror)       
[      1616]   397-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1617]   398-2      		endif
[      1618]   399-2      		if ($status >= 0)
[      1619]   400-2      			commit
[      1620]   401-3      			if ($status < 0)
[      1621]   402-3      				rollback
[      1622]   403-3      			else
[      1623]   404-3      				$instancehandle->SetHint("ID=APLINFO002")
[      1624]   405-3      			endif
[      1625]   406-2      		else
[      1626]   407-2      			rollback
[      1627]   408-2      		endif   
[      1628]   409-1      	endif	
[      1629]              	
[      1630]   410-1      	if ($tpLiberacaoTraVd$ = 01 | $tpLiberacaoTraVd$ = 02) & (TP_MODALIDADE.GER_OPERACAO = 4) & (TP_OPERACAO.TRA_TRANSACAO = "S") ;Venda
[      1631]   411-1      		vDsLstTransacao = ""
[      1632]   412-1      		vDsRegistro = ""
[      1633]   413-1      		putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1634]   414-1      		putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1635]   415-1      		putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1636]   416-1      		putitem vDsLstTransacao, -1, vDsRegistro
[      1637]   417-1      		viParams = ""
[      1638]   418-1      		putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1639]   419-2      		if ($tpLiberacaoTraVd$ = 01)
[      1640]   420-2      			putitem/id viParams, "TP_SITUACAO", 2 ;Liberada para faturamento
[      1641]   421-2      		else
[      1642]   422-2      			putitem/id viParams, "TP_SITUACAO", 8 ;Bloqueada
[      1643]   423-2      		endif
[      1644]   424-1      		putitem/id viParams, "CD_COMPONENTE", $componentname
[      1645]   425-1      		activate "TRASVCO004".alteraSituacaoTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      1646]   426-2      		if ($procerror)       
[      1647]   427-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1648]   428-2      			return(-1)
[      1649]   429-2      		elseif ($status < 0)
[      1650]   430-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1651]   431-2      			return(-1)
[      1652]   432-2      		endif
[      1653]   433-1      		commit
[      1654]   434-2      		if ($status < 0)
[      1655]   435-2      			rollback
[      1656]   436-2      			return (-1) 
[      1657]   437-2      		else
[      1658]   438-2      			$instancehandle->SetHint("ID=APLINFO002")
[      1659]   439-2      		endif
[      1660]   440-1      	endif
[      1661]              	
[      1662]   441        	vDsComponente = "TRAFM061"
[      1663]   442        	activate "LOGSVCO003".GetNivelComponente($$gCdUsuario, $$gCdEmpresa, vDsComponente, $xCdNivel$, $xCdErro$, $xCtxErro$)
[      1664]   443-1      	if ($procerror)
[      1665]   444-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=LOGSVCO003.GETNIVELCOMPONENTE")
[      1666]   445-1      	elseif ($xCdNivel$ > 0)	
[      1667]   446-1      		viParams = ""
[      1668]   447-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1669]   448-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1670]   449-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1671]   450-1      		putitem/id viParams, "CD_USUARIODESC", $cdUsuarioDesc$
[      1672]              		;ECF Concomitante / ECF Não concomitante
[      1673]   451-2      		if (TP_DOCTO.GER_OPERACAO = 2) | (TP_DOCTO.GER_OPERACAO = 3)
[      1674]   452-2      			putitem/id viParams, "IN_DIRETO", "T"
[      1675]   453-2      		else
[      1676]   454-2      			putitem/id viParams, "IN_DIRETO", "F"
[      1677]   455-2      		endif
[      1678]   456-1      		$keyboard = "KB_GLOBAL"
[      1679]   457-1      		activate "TRAFM061".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1680]   458-1      		$keyboard = "KB_PDV"
[      1681]   459-2      		if ($procerror)       
[      1682]   460-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1683]   461-2      			return(-1)
[      1684]   462-2      		endif	
[      1685]   463-2      		if ($status >= 0) | ($status = -3) ;Status -3 é pq a transacao foi bloqueada no TRAFM061
[      1686]   464-2      			vStatus = $status
[      1687]   465-2      			commit
[      1688]   466-3      			if ($status < 0)
[      1689]   467-3      				rollback
[      1690]   468-3      				return (-1) 
[      1691]   469-3      			else
[      1692]   470-3      				$instancehandle->SetHint("ID=APLINFO002")
[      1693]   471-3      			endif
[      1694]              			
[      1695]   472-3      			if (vStatus = -3)
[      1696]   473-3      				$instancehandle->recarregaTransacao()
[      1697]   474-4      				if ($procerror)
[      1698]   475-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1699]   476-4      				endif
[      1700]              				
[      1701]   477-3      				return(-1)
[      1702]   478-3      			endif
[      1703]   479-2      		else
[      1704]   480-2      			rollback
[      1705]   481-2      			return(-1)
[      1706]   482-2      		endif
[      1708]   483-2      		if (TP_DOCTO.GER_OPERACAO = 1) ;Nota Fiscal
[      1709]   484-2      			viParams = voParams
[      1710]   485-3      			if (TP_MODALIDADE.GER_OPERACAO = 4) ;Venda
[      1711]   486-4      				if ($tpImpressaoNFVenda$ = 01)
[      1712]   487-4      					putitem/id viParams, "IN_DIRETO", "F"
[      1713]   488-4      				else
[      1714]   489-4      					putitem/id viParams, "IN_DIRETO", "T"
[      1715]   490-4      				endif
[      1716]   491-3      			else
[      1717]   492-3      				putitem/id viParams, "IN_DIRETO", "F"
[      1718]   493-3      			endif
[      1719]   494-2      			$keyboard = "KB_GLOBAL"	;>-- MAC - PRJ 61 TAR 716 - 25/11/2009
[      1720]   495-2      			activate "FISFP008".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1721]   496-2      			$keyboard = "KB_PDV"  ;>-- MAC - PRJ 61 TAR 716 - 25/11/2009
[      1722]   497-3      			if ($procerror)       
[      1723]   498-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1724]   499-3      			endif
[      1725]   500-3      			if ($status >= 0)
[      1726]   501-3      				commit
[      1727]   502-4      				if ($status < 0)
[      1728]   503-4      					rollback
[      1729]   504-4      				else
[      1730]   505-4      					$instancehandle->SetHint("ID=APLINFO002")
[      1731]   506-4      				endif
[      1732]   507-3      			else
[      1733]   508-3      				rollback
[      1734]   509-3      			endif   
[      1735]   510-2      		endif
[      1737]              		;-=CANONICO=- (10/08/2011) TAR 111 PR 182 IMPRESSAO DE SALDO CREDEV ECF		
[      1738]              		;vInConsultaSaldoCredev = "F"					
[      1739]              		;selectcase $tpConsultaSaldoCredev$
[      1740]              		;case 1 ;PERGUNTA
[      1741]              		;	askmess "Deseja consultar Saldo Credev?", "Sim,Não"
[      1742]              		;	if ($status = 1)
[      1743]              		;		vInConsultaSaldoCredev = "T"					
[      1744]              		;	endif
[      1745]              		;case 2 ;AUTOMATICO
[      1746]              		;	vInConsultaSaldoCredev = "T"
[      1747]              		;endselectcase    
[      1748]              		; --- DIONE |156/0641| 22/09/2011
[      1749]              		;if (vInConsultaSaldoCredev = "T")
[      1750]              		;	viParams = ""
[      1751]              		;	putitem/id viParams, "CD_EMPRESA"  , CD_EMPRESA.TRA_TRANSACAO
[      1752]              		;	putitem/id viParams, "CD_PESSOA"   , CD_PESSOA.TRA_TRANSACAO
[      1753]              		;	activate "TRAFC018".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1754]              		;	if ($procerror)       
[      1755]              		;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1756]              		;		return(-1)
[      1757]              		;	endif
[      1758]              		;endif
[      1759]              		; ---
[      1761]   511-2      		if (TP_MODALIDADE.GER_OPERACAO = 3) ;Devolução
[      1762]   512-2      			vDsComponente = "TRAFM068"
[      1763]   513-2      		else
[      1764]   514-2      			vDsComponente = "TRAFM066"
[      1765]   515-2      		endif
[      1766]   516-1      		activate "LOGSVCO003".GetNivelComponente($$gCdUsuario, $$gCdEmpresa, vDsComponente, $xCdNivel$, $xCdErro$, $xCtxErro$)
[      1767]   517-2      		if ($procerror)
[      1768]   518-2      			$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=LOGSVCO003.GETNIVELCOMPONENTE")
[      1769]   519-2      		elseif ($xCdNivel$ > 0)	
[      1770]   520-2      			viParams = ""
[      1771]   521-2      			vDsLstTransacao = ""
[      1772]   522-2      			vDsRegistro = ""
[      1773]   523-2      			putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      1774]   524-2      			putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      1775]   525-2      			putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      1776]   526-2      			putitem vDsLstTransacao, -1, vDsRegistro    
[      1777]   527-2      			putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1778]   528-2      			activate "SICSVCO005".validaRecebimento($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      1779]   529-3      			if ($procerror)       
[      1780]   530-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1781]   531-3      				macro "^CLEAR"
[      1782]   532-3      				return(-1)
[      1783]   533-3      			elseif ($status < 0)
[      1784]   534-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1785]   535-3      				macro "^CLEAR"
[      1786]   536-3      				return(-1)
[      1787]   537-3      			endif
[      1789]   538-2      			vDsLstTransacao = $item("DS_LSTTRANSACAO", voParams)
[      1790]   539-2      			vDsLstEncargoFin = $item("DS_LSTENCARGOFIN", voParams)
[      1792]   540-3      			if (vDsLstTransacao = "") & (vDsLstEncargoFin = "")
[      1793]   541-3      				$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Nenhuma transação validada para recebimento!", "")
[      1794]   542-3      				macro "^CLEAR"
[      1795]   543-3      				return(-1)
[      1796]   544-3      			endif
[      1798]   545-2      			viParams = ""
[      1799]   546-2      			putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1800]   547-2      			putitem/id viParams, "DS_LSTENCARGOFIN", vDsLstEncargoFin
[      1801]   548-2      			activate "SICSVCO005".buscaMaxTroco($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      1802]   549-3      			if ($procerror)       
[      1803]   550-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1804]   551-3      				macro "^CLEAR"
[      1805]   552-3      				return(-1)
[      1806]   553-3      			elseif ($status < 0)
[      1807]   554-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      1808]   555-3      				macro "^CLEAR"
[      1809]   556-3      				return(-1)
[      1810]   557-3      			endif
[      1812]   558-2      			$tpTrocoMaximo$ = $item("TP_TROCOMAXIMO", voParams)
[      1813]   559-2      			vVlTrocoMaximoTra = $item("VL_TROCOMAXIMOTRA", voParams)	
[      1814]   560-2      			vVlTrocoMaximoEnc = $item("VL_TROCOMAXIMOENC", voParams)
[      1816]   561-2      			vInTrocoMaximo = "F"
[      1818]   562-3      			if ($tpTrocoMaximo$ = 1)
[      1819]   563-3      				vInTrocoMaximo = "T"
[      1820]   564-3      			elseif ($tpTrocoMaximo$ = 2)
[      1821]   565-3      				askmess "Utiliza controle de troco máximo?", "Sim, Não"
[      1822]   566-4      				if ($status = 1) 
[      1823]   567-4      					vInTrocoMaximo = "T"
[      1824]   568-4      				else
[      1825]   569-4      					vInTrocoMaximo = "F"
[      1826]   570-4      				endif
[      1827]   571-3      			endif
[      1829]   572-3      			if (vDsLstTransacao != "")
[      1830]   573-3      				viParams = ""
[      1831]   574-3      				putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      1832]   575-3      				putitem/id viParams, "IN_TROCOMAXIMO", vInTrocoMaximo
[      1833]   576-3      				putitem/id viParams, "VL_TROCOMAXIMO", vVlTrocoMaximoTra
[      1834]   577-3      				putitem/id viParams, "CD_EMPECF", $CdEmpEcf$
[      1835]   578-3      				putitem/id viParams, "NR_ECF", $NrEcf$
[      1836]   579-3      				putitem/id viParams, "NR_CUPOM", $NrCupom$
[      1837]   580-4      				if (TP_MODALIDADE.GER_OPERACAO = 3) ;Devolução
[      1838]   581-4      					$keyboard = "KB_GLOBAL"
[      1839]   582-4      					activate "TRAFM068".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1840]   583-4      					$keyboard = "KB_PDV"
[      1841]   584-5      					if ($procerror)       
[      1842]   585-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1843]   586-5      						macro "^CLEAR"
[      1844]   587-5      						return(-1)
[      1845]   588-5      					endif	
[      1846]   589-4      				else
[      1847]   590-4      					$keyboard = "KB_GLOBAL"
[      1848]   591-4      					activate "TRAFM066".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1849]   592-4      					$keyboard = "KB_PDV"
[      1850]   593-5      					if ($procerror)       
[      1851]   594-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1852]   595-5      						macro "^CLEAR"
[      1853]   596-5      						return(-1)
[      1854]   597-5      					endif
[      1855]   598-4      					vInFatura = $item("IN_FATURA", voParams) ;>-- MAC - PRJ 102/926 - 27/08/2010 ---
[      1856]   599-4      					$vlTroco$ = $item("VL_TROCO" , voParams) ;Hugo em 28/12/2010 Tarefa 180-32
[      1857]   600-4      					vDsLstNF  = $item("DS_LSTNF" , voParams) ;--Douglas Ferreira - [Prj/Tarefa 180/86] - 09/02/2011
[      1858]              					;-=CANONICO=- (11/08/2011) TAR 125 PRJ 186 -ERRO CONTA CORRENTE
[      1859]   601-5      					if ($item("CD_EMPLIQ", voParams)!= '') & ($item("DT_LIQ", voParams)!= '') & $item("NR_SEQLIQ", voParams)
[      1860]   602-5      						vDsRegistro = ""
[      1861]   603-5      						putitem/id vDsRegistro, "CD_EMPLIQ"  , $item("CD_EMPLIQ", voParams)
[      1862]   604-5      						putitem/id vDsRegistro, "DT_LIQ"     , $item("DT_LIQ", voParams)
[      1863]   605-5      						putitem/id vDsRegistro, "NR_SEQLIQ"  , $item("NR_SEQLIQ", voParams)
[      1864]   606-5      						vDsLstLiquidacao = ""
[      1865]   607-5      						putitem vDsLstLiquidacao, -1, vDsRegistro
[      1866]   608-5      					endif
[      1867]   609-4      				endif
[      1868]   610-3      			else
[      1869]   611-3      				$status = 0
[      1870]   612-3      			endif
[      1872]   613-3      			if ($status >= 0) & (vDsLstEncargoFin != "")
[      1873]   614-3      				viParams = ""
[      1874]   615-3      				putitem/id viParams, "DS_LSTTRANSACAO", vDsLstEncargoFin
[      1875]   616-3      				putitem/id viParams, "IN_TROCOMAXIMO", vInTrocoMaximo
[      1876]   617-3      				putitem/id viParams, "VL_TROCOMAXIMO", vVlTrocoMaximoEnc
[      1877]   618-3      				putitem/id viParams, "CD_EMPECF", $CdEmpEcf$
[      1878]   619-3      				putitem/id viParams, "NR_ECF", $NrEcf$
[      1879]   620-3      				putitem/id viParams, "NR_CUPOM", $NrCupom$
[      1880]   621-4      				if (TP_MODALIDADE.GER_OPERACAO = 3) ;Devolução
[      1881]   622-4      					$keyboard = "KB_GLOBAL"
[      1882]   623-4      					activate "TRAFM068".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1883]   624-4      					$keyboard = "KB_PDV"
[      1884]   625-5      					if ($procerror)       
[      1885]   626-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1886]   627-5      						macro "^CLEAR"
[      1887]   628-5      						return(-1)
[      1888]   629-5      					endif	
[      1889]   630-4      				else
[      1890]   631-4      					$keyboard = "KB_GLOBAL"
[      1891]   632-4      					activate "TRAFM066".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1892]   633-4      					$keyboard = "KB_PDV"
[      1893]   634-5      					if ($procerror)       
[      1894]   635-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1895]   636-5      						macro "^CLEAR"
[      1896]   637-5      						return(-1)
[      1897]   638-5      					endif	
[      1898]              					;-=CANONICO=- (11/08/2011) TAR 125 PRJ 186 -ERRO CONTA CORRENTE
[      1899]   639-5      					if ($item("CD_EMPLIQ", voParams)!= '') & ($item("DT_LIQ", voParams)!= '') & $item("NR_SEQLIQ", voParams)
[      1900]   640-5      						vDsRegistro = ""
[      1901]   641-5      						putitem/id vDsRegistro, "CD_EMPLIQ"  , $item("CD_EMPLIQ", voParams)
[      1902]   642-5      						putitem/id vDsRegistro, "DT_LIQ"     , $item("DT_LIQ", voParams)
[      1903]   643-5      						putitem/id vDsRegistro, "NR_SEQLIQ"  , $item("NR_SEQLIQ", voParams)
[      1904]   644-5      						putitem vDsLstLiquidacao, -1, vDsRegistro
[      1905]   645-5      					endif
[      1906]   646-4      				endif
[      1907]   647-3      			endif
[      1909]   648-3      			if ($status >= 0)
[      1910]   649-3      				commit
[      1911]   650-4      				if ($status < 0)
[      1912]   651-4      					rollback
[      1913]   652-4      					macro "^CLEAR"
[      1914]   653-4      					return(-1)
[      1915]   654-4      				else
[      1916]   655-4      					$instancehandle->SetHint("ID=APLINFO002")
[      1917]   656-4      				endif
[      1918]   657-3      			else
[      1919]   658-3      				rollback
[      1920]   659-3      				clear
[      1921]   660-3      				$prompt = TP_TRANSACAO.TRA_TRANSACAO
[      1922]   661-3      				macro "^CLEAR"
[      1923]   662-3      				return(-1)
[      1924]   663-3      			endif 
[      1925]              			
[      1926]              			;-=CANONICO=- (11/08/2011) TAR 125 PRJ 186 -ERRO CONTA CORRENTE
[      1927]   664-3      			if (vDsLstLiquidacao != '') & ($cdModImpRecebTra$ > 0)
[      1928]   665-4      				repeat
[      1929]   666-4      					getitem vDsRegistro, vDsLstLiquidacao , 1
[      1931]   667-4      					viParams = ""
[      1932]   668-4      					putitem/id viParams, "CD_EMPLIQ", $item("CD_EMPLIQ", vDsRegistro)
[      1933]   669-4      					putitem/id viParams, "DT_LIQ", $item("DT_LIQ", vDsRegistro)
[      1934]   670-4      					putitem/id viParams, "NR_SEQLIQ", $item("NR_SEQLIQ", vDsRegistro)
[      1935]   671-4      					putitem/id viParams, "CD_MODFIN", $cdModImpRecebTra$
[      1936]   672-4      					putitem/id viParams, "IN_FATURAMENTO", "T"
[      1937]   673-4      					activate "FCRFF002".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1938]   674-5      					if ($procerror)       
[      1939]   675-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1940]   676-5      					endif
[      1942]   677-4      					delitem vDsLstLiquidacao , 1
[      1943]   678-4      				until (vDsLstLiquidacao = "")	
[      1944]   679-3      			endif			
[      1946]              			;Hugo em 28/12/2010 Tarefa 180-32
[      1947]   680-2      			vInMostraTroco = $item("IN_MOSTRA_TROCO_RECEB", $xlplemp$)
[      1948]              			
[      1949]   681-3      			if (vInMostraTroco = "T") & (TP_MODALIDADE.GER_OPERACAO != 3) & ($vlTroco$ != 0) ;Devolução
[      1950]   682-3      				message/info "VALOR TROCO: R$ %%$vlTroco$%%%"
[      1951]   683-3      			endif
[      1952]              			;
[      1953]              			;--Douglas Ferreira - [Prj/Tarefa 180/86] - 09/02/2011
[      1954]   684-3      			if (vDsLstNF != "")
[      1955]   685-3      				viParams = ""
[      1956]   686-3      				putitem/id viParams, "DS_LSTNF"             , vDsLstNF
[      1957]   687-3      				putitem/id viParams, "IN_GERA_NFE_AUTOMATIC", "T"
[      1958]   688-3      				activate "FISFP042".EXEC(viParams, voParams, $xCdErro$, $xCtxerro$)
[      1959]   689-4      				if ($procerror)
[      1960]   690-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1961]   691-4      				endif
[      1962]   692-3      			endif
[      1963]              			;			
[      1964]              			;>-- MAC - PRJ 102/926 - 27/08/2010 ---
[      1965]   693-3      			if (vDsLstTransacao != "") & ($tpImpRichTextVD$ = 1) & ($cdModRichTextVD$ != "") & (vInFatura = "T")
[      1967]   694-3      				viParams = ""
[      1968]   695-3      				putitem/id viParams, "CD_EMPRESA"   , CD_EMPRESA.TRA_TRANSACAO
[      1969]   696-3      				putitem/id viParams, "DT_TRANSACAO" , DT_TRANSACAO.TRA_TRANSACAO
[      1970]   697-3      				putitem/id viParams, "NR_TRANSACAO" , NR_TRANSACAO.TRA_TRANSACAO
[      1971]   698-3      				putitem/id viParams, "CD_MODELO"    , "TRA"
[      1972]   699-3      				putitem/id viParams, "CD_RICHTEXT"  , $cdModRichTextVD$
[      1973]   700-3      				activate "TRAFP061".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1974]   701-4      				if ($procerror)       
[      1975]   702-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      1976]   703-4      					return(-1)
[      1977]   704-4      				endif
[      1978]   705-3      			endif
[      1979]              			;--<
[      1980]   706-2      		endif
[      1981]              		
[      1982]              		; --- DIONE |156/0641| 22/09/2011
[      1983]   707-1      		vInConsultaSaldoCredev = "F"					
[      1984]   708-2      		selectcase $tpConsultaSaldoCredev$
[      1985]   709-2      		case 1 ;PERGUNTA
[      1986]   710-2      			askmess "Deseja consultar Saldo Credev?", "Sim,Não"
[      1987]   711-3      			if ($status = 1)
[      1988]   712-3      				vInConsultaSaldoCredev = "T"					
[      1989]   713-3      			endif
[      1990]   714-2      		case 2 ;AUTOMATICO
[      1991]   715-2      			vInConsultaSaldoCredev = "T"
[      1992]   716-2      		endselectcase  
[      1993]   717-2      		if (vInConsultaSaldoCredev = "T")
[      1994]   718-2      			viParams = ""
[      1995]   719-2      			putitem/id viParams, "CD_EMPRESA"  , CD_EMPRESA.TRA_TRANSACAO
[      1996]   720-2      			putitem/id viParams, "CD_PESSOA"   , CD_PESSOA.TRA_TRANSACAO
[      1997]   721-2      			activate "TRAFC018".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      1998]   722-3      			if ($procerror)       
[      1999]   723-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2000]   724-3      				return(-1)
[      2001]   725-3      			endif
[      2002]   726-2      		endif
[      2003]              		; ---
[      2005]   727-1      		viParams = ""
[      2006]   728-1      		putitem/id viParams, "LST_EMPRESA", $item("CD_EMPRESA", $$gParamGlb)
[      2007]   729-1      		activate "FCXSVCO001".buscarSaldoCaixaUsuario($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      2008]   730-2      		if ($procerror)       
[      2009]   731-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2010]   732-2      			return(-1)
[      2011]   733-2      		elseif ($status < 0)
[      2012]   734-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2013]   735-2      		endif
[      2014]              		
[      2015]   736-1      		vInSangria = $item("IN_SANGRIA", voParams)
[      2016]              		
[      2017]   737-2      		if (vInSangria = "T")
[      2018]   738-2      			message/info "<<<< ATENÇÃO >>>>%%^%%^Efetuar sangria de caixa!"
[      2019]   739-2      		endif
[      2020]   740-1      	endif
[      2022]   741        	clear
[      2023]   742        	macro "^CLEAR"
[      2024]              	
[      2025]   743        	return(0)
[      2026]   744        end
[      2028]              ;------------------------------
[      2029]******        partner operation carregaListas
[      2030]              ;------------------------------
[      2031]              	variables
[      2032]              		string viParams, voParams, vDsLstOperacao
[      2033]              		numeric vCdEmpresa, vCdUsuario
[      2034]              	endvariables
[      2035]              	
[      2036]     1        	vCdEmpresa = $item("CD_EMPRESA", $$gParamGlb)
[      2037]     2        	vCdUsuario = $item("CD_USUARIO", $$gParamGlb)
[      2038]              	
[      2039]     3        	vDsLstOperacao = ""
[      2040]     4        	clear/e "ADM_USUOPERCMP"
[      2041]     5        	CD_EMPRESA.ADM_USUOPERCMP/init = vCdEmpresa
[      2042]     6        	CD_USUARIO.ADM_USUOPERCMP/init = vCdUsuario
[      2043]     7        	CD_COMPONENTE.ADM_USUOPERCMP/init = $componentname
[      2044]     8        	retrieve/e "ADM_USUOPERCMP"
[      2045]     9-1      	if ($status >= 0)
[      2046]    10-1      		$tpTransacaoPadrao$ = 0
[      2047]    11-1      		$qtOperacao$ = 0
[      2048]    12-1      		setocc "ADM_USUOPERCMP", 1
[      2049]    13-2      		while ($status >=0)
[      2050]    14-3      			if (CD_OPERACAO.ADM_USUOPERCMP = $cdOperacaoVenda$)
[      2051]    15-3      				putitem vDsLstOperacao, -1, "1=Venda"
[      2052]    16-3      				$qtOperacao$ = $qtOperacao$ + 1
[      2053]    17-4      				if ($tpTransacaoPadrao$ = 0)
[      2054]    18-4      					$tpTransacaoPadrao$ = 1
[      2055]    19-4      				endif
[      2056]    20-3      			elseif (CD_OPERACAO.ADM_USUOPERCMP = $cdOperacaoValeTroca$)				
[      2057]    21-3      				putitem vDsLstOperacao, -1, "2=Vale troca"
[      2058]    22-3      				$qtOperacao$ = $qtOperacao$ + 1
[      2059]    23-4      				if ($tpTransacaoPadrao$ = 0)
[      2060]    24-4      					$tpTransacaoPadrao$ = 2
[      2061]    25-4      				endif
[      2062]    26-3      			elseif (CD_OPERACAO.ADM_USUOPERCMP = $cdOperacaoTroca$)
[      2063]    27-3      				putitem vDsLstOperacao, -1, "3=Troca"
[      2064]    28-3      				$qtOperacao$ = $qtOperacao$ + 1
[      2065]    29-4      				if ($tpTransacaoPadrao$ = 0)
[      2066]    30-4      					$tpTransacaoPadrao$ = 3
[      2067]    31-4      				endif
[      2068]    32-3      			endif
[      2069]    33-2      			setocc "ADM_USUOPERCMP", $curocc("ADM_USUOPERCMP") + 1
[      2070]    34-2      		endwhile
[      2071]    35-2      		if (vDsLstOperacao = "")
[      2072]    36-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Usuário %%vCdUsuario não possui permissão em nenhuma das operações utilizadas por este componente(%%$cdOperacaoVenda$ / %%$cdOperacaoValeTroca$ / %%$cdOperacaoTroca$%%%)!", "")
[      2073]    37-2      			return(-1)
[      2074]    38-2      		else
[      2075]    39-2      			$valrep(TP_TRANSACAO.TRA_TRANSACAO) = vDsLstOperacao	
[      2076]    40-2      		endif		
[      2077]    41-1      	else
[      2078]    42-1      		$tpTransacaoPadrao$ = 1
[      2079]    43-1      		$qtOperacao$ = 3
[      2080]    44-1      	endif
[      2082]    45        	TP_TRANSACAO.TRA_TRANSACAO = $tpTransacaoPadrao$
[      2084]    46        	return(0)
[      2085]    47        end
[      2087]              ;--------------------------------
[      2088]******        partner operation posicionaCursor
[      2089]              	;--------------------------------
[      2090]              	variables
[      2091]              		boolean vInCodigo
[      2092]              	endvariables
[      2093]              	
[      2094]     1-1      	if ($empty("TRA_TRANSITEM") = 0)
[      2095]     2-1      		setocc "TRA_TRANSITEM", -1
[      2096]     3-1      		$prompt = NR_ITEM.TRA_TRANSITEM
[      2097]     4-1      	endif        
[      2098]              	
[      2099]     5        	vInCodigo = IN_CODIGO.SIS_FILTRO
[      2100]     6        	clear/e "SIS_FILTRO"
[      2101]     7        	IN_CODIGO.SIS_FILTRO = vInCodigo
[      2102]              	
[      2103]     8-1      	if (TP_INCLUSAO.TRA_TRANSACAO = "QUANTIDADE")
[      2104]     9-1      		QT_SOLICITADA.SIS_FILTRO = ""
[      2105]    10-1      		fieldsyntax QT_SOLICITADA.SIS_FILTRO, ""    
[      2106]    11-1      		$prompt = QT_SOLICITADA.SIS_FILTRO
[      2107]    12-1      	else
[      2108]    13-1      		QT_SOLICITADA.SIS_FILTRO = 1
[      2109]    14-1      		fieldsyntax QT_SOLICITADA.SIS_FILTRO, "DIM"    
[      2110]    15-1      		$prompt = CD_BARRAPRD.SIS_FILTRO
[      2111]    16-1      	endif
[      2112]              	
[      2113]    17        	return(0)
[      2114]    18        end
[      2116]              ;-------------------------------
[      2117]******        partner operation validaVendedor
[      2118]              ;-------------------------------
[      2119]              	variables
[      2120]              		string  viParams, voParams, vDsErro
[      2121]              	endvariables
[      2122]              	
[      2123]     1        	viParams = ""
[      2124]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2125]     3        	putitem/id viParams, "CD_AUXILIAR", CD_AUXILIAR.PES_VENDEDOR
[      2126]     4        	activate "PESSVCO015".validaVendedor($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2127]     5-1      	if ($procerror)       
[      2128]     6-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2129]     7-1      		return(-1)
[      2130]     8-1      	elseif ($status < 0)
[      2131]     9-1      		vDsErro = $item("DESCRICAO", $xCtxErro$)
[      2132]    10-1      		vDsErro = "%%vDsErro%%^%%%Continuar?"
[      2133]    11-2      		repeat
[      2134]    12-2      			askmess vDsErro, "Não, Sim"
[      2135]    13-2      		until ($status = 2)
[      2136]    14-1      		$prompt = CD_AUXILIAR.PES_VENDEDOR
[      2137]    15-1      		return(-1)
[      2138]    16-1      	endif  
[      2140]    17        	clear/e "PES_VENDEDOR"
[      2141]    18        	CD_VENDEDOR.PES_VENDEDOR/init = $item("CD_VENDEDOR", voParams)
[      2142]    19        	retrieve/e "PES_VENDEDOR"
[      2143]              	
[      2144]    20        	return(0)
[      2145]    21        end
[      2147]              ;---------------------------
[      2148]******        partner operation validaItem
[      2149]              ;---------------------------
[      2151]              	variables
[      2152]              		string  viParams, voParams, vDsErro, vDsRegistro, vDsLstProduto, vCdEmpresa, vDsTrasvco004
[      2153]              		numeric vNrItem, vCdProduto, vQtEmbalagem, vCdGrupoEmpresa, vVlTransacao, vTpValidaVendedor, vQtSolicitada, vVlUnitLiquido
[      2154]              		numeric vInLimiteCredito
[      2155]              		boolean vInValidaItem
[      2156]              	endvariables
[      2158]     1        	vInValidaItem = "T"
[      2159]     2        	vInLimiteCredito = $item("IN_LIMITE_CREDITO_ITEM_VD", $xlplemp$)
[      2160]              	
[      2161]     3-1      	if (IN_CODIGO.SIS_FILTRO != "T")
[      2162]     4-1      		viParams = ""
[      2163]     5-1      		putitem/id viParams, "CD_BARRAPRD", CD_BARRAPRD.SIS_FILTRO
[      2164]     6-1      		putitem/id viParams, "IN_CODIGO", IN_CODIGO.SIS_FILTRO
[      2165]     7-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2166]     8-1      		activate "PRDSVCO004".verificaProduto($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2167]     9-2      		if ($procerror)
[      2168]    10-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      2169]    11-2      			return(-1)
[      2170]    12-2      		elseif ($xCdErro$)
[      2171]    13-2      			vDsErro = $item("DESCRICAO", $xCtxErro$)
[      2172]    14-2      			vDsErro = "%%vDsErro%%^%%%Continuar?"
[      2173]    15-3      			repeat
[      2174]    16-3      				askmess vDsErro, "Não, Sim"
[      2175]    17-3      			until ($status = 2)
[      2176]    18-2      			CD_BARRAPRD.SIS_FILTRO = CD_BARRAPRD.SIS_FILTRO
[      2177]    19-2      			$prompt = CD_BARRAPRD.SIS_FILTRO 
[      2178]    20-2      			return(-1)
[      2179]    21-2      		else
[      2180]    22-2      			vDsLstProduto = $item("DS_LSTPRODUTO", voParams)
[      2181]    23-3      			if (vDsLstProduto != "")
[      2182]    24-3      				vInValidaItem = "F"
[      2183]              				
[      2184]    25-4      				repeat
[      2185]    26-4      					getitem vDsRegistro, vDsLstProduto, 1
[      2186]              					
[      2187]    27-4      					vCdProduto = $item("CD_PRODUTO", vDsRegistro)
[      2188]    28-4      					vQtEmbalagem = $item("QT_PRODUTO", vDsRegistro)
[      2189]    29-4      					vQtEmbalagem = vQtEmbalagem * QT_SOLICITADA.SIS_FILTRO
[      2190]              					
[      2191]    30-4      					viParams = ""
[      2192]              					;>-- MAC - PRJ 156/395 - 16/09/2010 ---
[      2193]    31-5      					if ($tpBuscaVlValeTroca$ = 1) & (TP_MODALIDADE.GER_OPERACAO = 3) & (TP_OPERACAO.TRA_TRANSACAO = "E") ;Entrada de devolução
[      2194]    32-5      						viParams = ""
[      2195]    33-5      						putitem/id viParams, "CD_EMPRESA"  , CD_EMPRESA.TRA_TRANSACAO
[      2196]    34-5      						putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2197]    35-5      						putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2198]    36-5      						putitem/id viParams, "CD_PRODUTO"  , vCdProduto
[      2199]    37-5      						putitem/id viParams, "IN_CODIGO", "T" ;Codigo de Produto e Nao de Barras
[      2200]    38-5      						$keyboard = "KB_GLOBAL"
[      2201]    39-5      						activate "TRAFP062".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      2202]    40-5      						$keyboard = "KB_PDV"
[      2203]    41-6      						if ($procerror)       
[      2204]    42-6      							$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2205]    43-6      							return(-1)
[      2206]    44-6      						endif
[      2208]    45-5      						viParams = ""
[      2209]    46-5      						putitem/id viParams, "VL_BRUTO"    , $item("VL_UNITBRUTO"   , voParams)
[      2210]    47-5      						putitem/id viParams, "VL_DESCONTO" , $item("VL_UNITDESC"    , voParams)
[      2211]    48-5      						putitem/id viParams, "VL_LIQUIDO"  , $item("VL_UNITLIQUIDO" , voParams)
[      2212]    49-5      					endif
[      2213]              					;--<
[      2214]    50-4      					putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2215]    51-4      					putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2216]    52-4      					putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2217]    53-4      					putitem/id viParams, "CD_BARRAPRD", vCdProduto
[      2218]    54-4      					putitem/id viParams, "IN_CODIGO", "T" ;Codigo de Produto e Nao de Barras
[      2219]              ;					if (TP_INCLUSAO.TRA_TRANSACAO = "QUANTIDADE")
[      2220]    55-4      						putitem/id viParams, "QT_SOLICITADA", vQtEmbalagem
[      2221]              ;					endif
[      2222]    56-4      					putitem/id viParams, "CD_CFOP", CD_CFOP.TRA_TRANSACAO
[      2223]    57-4      					putitem/id viParams, "CD_CST", CD_CST.TRA_TRANSACAO
[      2224]    58-4      					putitem/id viParams, "CD_TABPRECO", $cdTabPreco$ ;---Elia Proj. 102/317 11/06/08
[      2225]    59-4      					activate "TRASVCO004".validaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2226]    60-5      					if ($procerror)       
[      2227]    61-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2228]    62-5      						return(-1)
[      2229]    63-5      					elseif ($status < 0)
[      2230]    64-5      						vDsErro = $item("DESCRICAO", $xCtxErro$)
[      2231]    65-5      						vDsErro = "%%vDsErro%%^%%%Continuar?"
[      2232]    66-6      						repeat
[      2233]    67-6      							askmess vDsErro, "Não, Sim"
[      2234]    68-6      						until ($status = 2)
[      2235]    69-5      						CD_BARRAPRD.SIS_FILTRO = CD_BARRAPRD.SIS_FILTRO
[      2236]    70-5      						$prompt = CD_BARRAPRD.SIS_FILTRO 
[      2237]    71-5      						return(-1)
[      2238]    72-5      					endif 
[      2240]              					;---Elia Proj. 102/337 27/06/08
[      2241]    73-4      					vDsTrasvco004 = voParams
[      2242]    74-5      					if (TP_TRANSACAO.TRA_TRANSACAO = 2) & ($inValidaPrdValeTroca$ = "T");2 - Valetroca
[      2243]              						;---Elia Proj. 102/351 11/07/08 Comentada a logica para nao fazer a verificacao por empresa
[      2244]              						;clear/e "GER_EMPRESA"
[      2245]              						;CD_EMPRESA.GER_EMPRESA/init = CD_EMPRESA.TRA_TRANSACAO
[      2246]              						;retrieve/e "GER_EMPRESA"
[      2247]              						;if ($status >= 0)
[      2248]              						;	vCdGrupoEmpresa = CD_GRUPOEMPRESA.GER_EMPRESA
[      2249]              						;	clear/e "GER_EMPRESA"
[      2250]              						;	CD_GRUPOEMPRESA.GER_EMPRESA/init = vCdGrupoEmpresa
[      2251]              						;	retrieve/e "GER_EMPRESA"
[      2252]              						;	if ($status >= 0)
[      2253]              						;		setocc "GER_EMPRESA", -1
[      2254]              						;		setocc "GER_EMPRESA", 1
[      2255]              						;		putlistitems vCdEmpresa, CD_EMPRESA.GER_EMPRESA
[      2256]              						;	endif
[      2257]              						;endif
[      2258]              		
[      2259]    75-5      						clear/e "V_FIS_NFITEMPROD"
[      2260]              						;CD_EMPFAT.V_FIS_NFITEMPROD/init = vCdEmpresa
[      2261]    76-5      						CD_PRODUTO.V_FIS_NFITEMPROD/init = vCdProduto
[      2262]    77-5      						CD_PESSOA.V_FIS_NFITEMPROD/init = CD_PESSOA.TRA_TRANSACAO
[      2263]    78-5      						TP_OPERACAO.V_FIS_NFITEMPROD/init = "S"
[      2264]    79-5      						TP_MODALIDADE.V_FIS_NFITEMPROD/init = "4"
[      2265]    80-5      							TP_SITUACAO.V_FIS_NFITEMPROD/init = "N·;E"
[      2266]    81-5      						retrieve/e "V_FIS_NFITEMPROD"
[      2267]    82-6      						if ($status < 0)
[      2268]    83-6      							$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Produto %%vCdProduto nunca foi vendido para este cliente!", "")
[      2269]    84-6      							viParams = ""
[      2270]    85-6      							putitem/id viParams, "CD_COMPONENTE", $componentname
[      2271]    86-6      							putitem/id viParams, "DS_CAMPO", "IN_LIBERA_VALETROCA"
[      2272]    87-6      							putitem/id viParams, "CD_EMPRESA", $item("CD_EMPRESA", $$gParamGlb)
[      2273]    88-6      							putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO", $$gParamGlb)
[      2274]    89-6      							putitem/id viParams, "VL_VALOR", ""
[      2275]    90-6      							activate "ADMSVCO009".verificaRestricao(viParams, voParams, $xCdErro$, $xCtxerro$)
[      2276]    91-7      							if ($procerror)       
[      2277]    92-7      								$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2278]    93-7      								return(-1)
[      2279]    94-7      							elseif ($status < 0)
[      2280]    95-7      								$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Usuário com restrição para executar processo.%%^Restrição - IN_LIBERA_VALETROCA", "")
[      2281]    96-7      								$prompt = CD_BARRAPRD.SIS_FILTRO
[      2282]    97-7      								return(-1)
[      2283]    98-7      							endif
[      2284]    99-6      						endif
[      2285]              		
[      2286]              					;	clear/e "GER_EMPRESA" ;; Marcus Vinicius - 156/384 - 02/08/2010
[      2287]   100-5      						clear/e "V_FIS_NFITEMPROD"
[      2288]   101-5      					endif
[      2289]              						
[      2290]   102-5      					if (vInLimiteCredito > 0) & ($vlLimite$ != "")
[      2291]   103-5      						vVlTransacao = VL_TRANSACAO.TRA_TRANSACAO + $item("VL_TOTALLIQUIDO", vDsTrasvco004)
[      2292]              						
[      2293]   104-6      						if (vVlTransacao > $vlLimite$)
[      2294]   105-7      							if (vInLimiteCredito = 1)
[      2295]   106-7      								askmess/question "Limite do cliente ultrapassado. Deseja continuar?", "Não,Sim"
[      2296]   107-8      								if ($status = 1)
[      2297]   108-8      									$prompt = CD_BARRAPRD.SIS_FILTRO
[      2298]   109-8      									return(-1)
[      2299]   110-8      								endif
[      2300]   111-7      							elseif (vInLimiteCredito = 2)
[      2301]   112-7      								viParams = ""
[      2302]   113-7      								putitem/id viParams, "CD_COMPONENTE", $componentname
[      2303]   114-7      								putitem/id viParams, "DS_CAMPO", "IN_LIBERA_LIMITE"                   
[      2304]   115-7      								putitem/id viParams, "CD_EMPRESA", $item("CD_EMPRESA" ,$$gParamGlb)
[      2305]   116-7      								putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO" ,$$gParamGlb)
[      2306]   117-7      								putitem/id viParams, "VL_VALOR", ""    
[      2307]   118-7      								activate "ADMSVCO009".VerificaRestricao(viParams, voParams, $xCdErro$, $xCtxerro$)
[      2308]   119-8      								if ($procerror)       
[      2309]   120-8      									$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2310]   121-8      									return(-1)
[      2311]   122-8      								elseif ($status < 0)
[      2312]   123-8      									$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Limite do cliente ultrapassado. Usuário com restrição para executar processo.%%^Restrição - IN_LIBERA_LIMITE", "")
[      2313]   124-8      									return(-1)
[      2314]   125-8      								endif	
[      2315]   126-7      							endif
[      2316]   127-6      						endif
[      2317]   128-5      					endif
[      2318]              			
[      2319]              					;viParams = voParams
[      2320]   129-4      					viParams =	vDsTrasvco004
[      2321]              					;
[      2322]   130-4      					putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2323]   131-4      					putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2324]   132-4      					putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2325]              					;-=LSC=- (14/04/2008) TAR 280 PRJ 102 - ITEM ECF CONCOMITANTE NAO PERDER A SEQUENCIA
[      2326]   133-5      					if (TP_DOCTO.GER_OPERACAO = 3)
[      2327]   134-5      						$vNrItem$ = $vNrItem$ + 1
[      2328]   135-5      						putitem/id viParams, "NR_ITEM", $vNrItem$
[      2329]   136-5      					endif
[      2330]              					;
[      2331]   137-4      					activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2332]   138-5      					if ($procerror)       
[      2333]   139-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2334]   140-5      						return(-1)
[      2335]   141-5      					elseif ($status < 0)
[      2336]   142-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2337]   143-5      						return(-1)
[      2338]   144-5      					endif  
[      2340]              					;Mendes - PRJ=156/TAR=682 - 23/11/2011
[      2341]   145-5      					if ($item("DS_MENSAGEM", voParams) != "")
[      2342]   146-5      						message/info "%%$item("DS_MENSAGEM", voParams)"
[      2343]   147-5      					endif
[      2344]              					;;;
[      2345]              				 	
[      2346]   148-4      					vNrItem = $item("NR_ITEM",voParams)
[      2348]              					;FIUZA 20/12/05 - IMPRESSAO ECF CONCOMITANTE
[      2349]   149-5      					if (TP_DOCTO.GER_OPERACAO = 3)
[      2350]   150-6      						if ($InCupomAberto$ = "S")
[      2351]   151-6      							viParams = ""
[      2352]   152-6      							putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2353]   153-6      							putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2354]   154-6      							putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2355]   155-6      							putitem/id viParams, "NR_ITEM", vNrItem		
[      2356]   156-6      							activate "ECFSVCO010".lancaItemConcomitante($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2357]   157-7      							if ($procerror)       
[      2358]   158-7      								$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2359]   159-7      								return(-1)
[      2360]   160-7      							elseif ($status = -10)
[      2361]   161-7      								viParams = ""
[      2362]   162-7      								voParams = ""
[      2363]   163-7      								putitem/id viParams,"TITULO", "Erro de comunicação com a ECF"
[      2364]   164-7      								putitem/id viParams,"MENSAGEM", $item("DESCRICAO",$xctxerro$)
[      2365]   165-7      								activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[      2366]   166-8      								if ($procerror)       
[      2367]   167-8      									$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2368]   168-8      									rollback
[      2369]   169-8      									return(-1)
[      2370]   170-8      								endif
[      2371]   171-7      								rollback
[      2372]   172-7      								$prompt = CD_BARRAPRD.SIS_FILTRO
[      2373]   173-7      								return(-1)
[      2374]   174-7      							elseif ($status = -50)
[      2375]   175-7      								$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2376]   176-7      								apexit
[      2377]   177-7      							elseif ($status < 0)
[      2378]   178-7      								$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2379]   179-7      								rollback
[      2380]   180-7      								$prompt = CD_BARRAPRD.SIS_FILTRO
[      2381]   181-7      								return(-1)
[      2382]   182-7      							endif
[      2383]   183-6      						endif
[      2384]              			
[      2385]   184-5      						creocc "TMP_NR09", -1
[      2386]   185-5      						NR_GERAL.TMP_NR09 = vNrItem
[      2387]   186-5      					endif
[      2388]              					
[      2389]   187-4      					commit
[      2390]   188-5      					if ($status < 0)
[      2391]   189-5      						rollback
[      2392]   190-5      						return (-1) 
[      2393]   191-5      					else
[      2394]   192-5      						$instancehandle->SetHint("ID=APLINFO002")
[      2395]   193-5      					endif
[      2397]   194-4      					clear/e "SIS_PRODUTO"
[      2398]              					;MARTINEZ - PRJ/TAR 182/042 - 15/04/2011
[      2399]              					;CD_PRODUTO.SIS_PRODUTO = $item("CD_PRODUTO", viParams)
[      2400]              					;DS_PRODUTO.SIS_PRODUTO = $item("DS_PRODUTO", viParams)
[      2401]              					;QT_SOLICITADA.SIS_PRODUTO = $item("QT_SOLICITADA", viParams)
[      2402]              					;VL_UNITARIO.SIS_PRODUTO = $item("VL_UNITLIQUIDO", viParams)
[      2403]              					;VL_TOTAL.SIS_PRODUTO = $item("VL_TOTALLIQUIDO", viParams)
[      2404]   195-4      					CD_PRODUTO.SIS_PRODUTO = $item("CD_PRODUTO", vDsTrasvco004)
[      2405]   196-4      					DS_PRODUTO.SIS_PRODUTO = $item("DS_PRODUTO", vDsTrasvco004)
[      2406]   197-4      					QT_SOLICITADA.SIS_PRODUTO = $item("QT_SOLICITADA", vDsTrasvco004)
[      2407]   198-4      					VL_UNITARIO.SIS_PRODUTO = $item("VL_UNITLIQUIDO", vDsTrasvco004)
[      2408]   199-4      					VL_TOTAL.SIS_PRODUTO = $item("VL_TOTALLIQUIDO", vDsTrasvco004)
[      2409]              					;
[      2411]   200-5      					if ($inImagem$ = "T")
[      2412]   201-5      						clear/e "PRD_PRDIMAGEM"
[      2413]   202-5      						CD_PRODUTO.PRD_PRDIMAGEM/init = CD_PRODUTO.SIS_PRODUTO
[      2414]   203-5      						IN_PADRAO.PRD_PRDIMAGEM/init = "T"
[      2415]   204-5      						retrieve/e "PRD_PRDIMAGEM"
[      2416]   205-6      						if ($status >= 0)
[      2417]   206-6      							CD_IMAGEM.SIS_PRODUTO/init = CD_IMAGEM.PRD_PRDIMAGEM
[      2418]   207-6      						else
[      2419]   208-6      							clear/e "PRD_PRDIMAGEM"
[      2420]   209-6      							CD_PRODUTO.PRD_PRDIMAGEM/init = CD_PRODUTO.SIS_PRODUTO
[      2421]   210-6      							retrieve/e "PRD_PRDIMAGEM"
[      2422]   211-7      							if ($status >= 0)
[      2423]   212-7      								CD_IMAGEM.SIS_PRODUTO/init = CD_IMAGEM.PRD_PRDIMAGEM
[      2424]   213-7      							endif
[      2425]   214-6      						endif
[      2426]   215-5      					endif
[      2427]              					
[      2428]   216-5      					if (TP_MODALIDADE.GER_OPERACAO = 5) ;Outras Saídas/Entradas
[      2429]   217-5      						setocc "TRA_TRANSITEM", -1
[      2430]   218-5      						$instancehandle->alteraItem()
[      2431]   219-6      						if ($procerror)
[      2432]   220-6      							$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2433]   221-6      						endif
[      2434]   222-5      					endif
[      2435]              								
[      2436]   223-4      					delitem vDsLstProduto, 1
[      2437]   224-4      				until (vDsLstProduto = "")
[      2438]              				
[      2439]   225-3      				$instancehandle->recarregaTransacao()
[      2440]   226-4      				if ($procerror)
[      2441]   227-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2442]   228-4      				endif
[      2443]   229-3      			endif
[      2444]   230-2      		endif
[      2445]   231-1      	endif
[      2446]              	
[      2447]   232-1      	if (vInValidaItem = "T")
[      2448]   233-1      		viParams = ""
[      2449]              		;>-- MAC - PRJ 156/395 - 16/09/2010 ---
[      2450]   234-2      		if ($tpBuscaVlValeTroca$ = 1) & (TP_MODALIDADE.GER_OPERACAO = 3) & (TP_OPERACAO.TRA_TRANSACAO = "E") ;Entrada de devolução
[      2451]   235-2      			viParams = ""
[      2452]   236-2      			putitem/id viParams, "CD_EMPRESA"  , CD_EMPRESA.TRA_TRANSACAO
[      2453]   237-2      			putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2454]   238-2      			putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2455]   239-2      			putitem/id viParams, "CD_PRODUTO"  , CD_BARRAPRD.SIS_FILTRO
[      2456]   240-2      			putitem/id viParams, "IN_CODIGO"   , IN_CODIGO.SIS_FILTRO
[      2457]   241-2      			$keyboard = "KB_GLOBAL"
[      2458]   242-2      			activate "TRAFP062".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      2459]   243-2      			$keyboard = "KB_PDV"
[      2460]   244-3      			if ($procerror)       
[      2461]   245-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2462]   246-3      				return(-1)
[      2463]   247-3      			elseif ($status < 0)
[      2464]   248-3      				return(-1)
[      2465]   249-3      			endif
[      2467]   250-2      			viParams = ""
[      2468]   251-2      			putitem/id viParams, "VL_BRUTO"    , $item("VL_UNITBRUTO"   , voParams)
[      2469]   252-2      			putitem/id viParams, "VL_DESCONTO" , $item("VL_UNITDESC"    , voParams)
[      2470]   253-2      			putitem/id viParams, "VL_LIQUIDO"  , $item("VL_UNITLIQUIDO" , voParams)
[      2471]   254-2      		endif
[      2472]              		;--<
[      2473]   255-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2474]   256-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2475]   257-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2476]   258-1      		putitem/id viParams, "CD_BARRAPRD", CD_BARRAPRD.SIS_FILTRO
[      2477]   259-1      		putitem/id viParams, "IN_CODIGO", IN_CODIGO.SIS_FILTRO
[      2478]   260-2      		if (TP_INCLUSAO.TRA_TRANSACAO = "QUANTIDADE")
[      2479]   261-2      			putitem/id viParams, "QT_SOLICITADA", QT_SOLICITADA.SIS_FILTRO
[      2480]   262-2      		endif
[      2481]   263-1      		putitem/id viParams, "CD_CFOP", CD_CFOP.TRA_TRANSACAO
[      2482]   264-1      		putitem/id viParams, "CD_CST", CD_CST.TRA_TRANSACAO
[      2483]   265-1      		putitem/id viParams, "CD_TABPRECO", $cdTabPreco$ ;---Elia Proj. 102/317 11/06/08
[      2484]   266-1      		activate "TRASVCO004".validaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2485]   267-2      		if ($procerror)       
[      2486]   268-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2487]   269-2      			return(-1)
[      2488]   270-2      		elseif ($status < 0)
[      2489]   271-2      			vDsErro = $item("DESCRICAO", $xCtxErro$)
[      2490]   272-2      			vDsErro = "%%vDsErro%%^%%%Continuar?"
[      2491]   273-3      			repeat
[      2492]   274-3      				askmess vDsErro, "Não, Sim"
[      2493]   275-3      			until ($status = 2)
[      2494]   276-2      			CD_BARRAPRD.SIS_FILTRO = CD_BARRAPRD.SIS_FILTRO
[      2495]   277-2      			$prompt = CD_BARRAPRD.SIS_FILTRO 
[      2496]   278-2      			return(-1)
[      2497]   279-2      		endif    
[      2499]              		;---Elia Proj. 102/337 27/06/08
[      2500]   280-1      		vDsTrasvco004 = voParams
[      2501]   281-1      		vCdProduto = $item("CD_PRODUTO", voParams)
[      2502]   282-1      		vVlUnitLiquido = $item("VL_UNITLIQUIDO", voParams)
[      2503]   283-1      		vQtSolicitada = $item("QT_SOLICITADA", voParams)
[      2505]   284-2      		if (TP_TRANSACAO.TRA_TRANSACAO = 2) & ($inValidaPrdValeTroca$ = "T"); 2 - Valetroca
[      2506]              			;---Elia Proj. 102/351 11/07/08 Comentada a logica para nao fazer a verificacao por empresa
[      2507]              			;clear/e "GER_EMPRESA"
[      2508]              			;CD_EMPRESA.GER_EMPRESA/init = CD_EMPRESA.TRA_TRANSACAO
[      2509]              			;retrieve/e "GER_EMPRESA"
[      2510]              			;if ($status >= 0)
[      2511]              			;	vCdGrupoEmpresa = CD_GRUPOEMPRESA.GER_EMPRESA
[      2512]              			;	clear/e "GER_EMPRESA"
[      2513]              			;	CD_GRUPOEMPRESA.GER_EMPRESA/init = vCdGrupoEmpresa
[      2514]              			;	retrieve/e "GER_EMPRESA"
[      2515]              			;	if ($status >= 0)
[      2516]              			;		setocc "GER_EMPRESA", -1
[      2517]              			;		setocc "GER_EMPRESA", 1
[      2518]              			;		putlistitems vCdEmpresa, CD_EMPRESA.GER_EMPRESA
[      2519]              			;	endif
[      2520]              			;endif
[      2521]              		
[      2522]   285-2      			clear/e "V_FIS_NFITEMPROD"
[      2523]              			;CD_EMPFAT.V_FIS_NFITEMPROD/init = vCdEmpresa
[      2524]   286-2      			CD_PRODUTO.V_FIS_NFITEMPROD/init = vCdProduto
[      2525]   287-2      			CD_PESSOA.V_FIS_NFITEMPROD/init = CD_PESSOA.TRA_TRANSACAO
[      2526]   288-2      			TP_OPERACAO.V_FIS_NFITEMPROD/init = "S"
[      2527]   289-2      			TP_MODALIDADE.V_FIS_NFITEMPROD/init = "4"
[      2528]   290-2      			TP_SITUACAO.V_FIS_NFITEMPROD/init = "N·;E"
[      2529]   291-2      			retrieve/e "V_FIS_NFITEMPROD"
[      2530]   292-3      			if ($status < 0)
[      2531]   293-3      				$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Produto %%vCdProduto nunca foi vendido para este cliente!", "")
[      2532]   294-3      				viParams = ""
[      2533]   295-3      				putitem/id viParams, "CD_COMPONENTE", $componentname
[      2534]   296-3      				putitem/id viParams, "DS_CAMPO", "IN_LIBERA_VALETROCA"
[      2535]   297-3      				putitem/id viParams, "CD_EMPRESA", $item("CD_EMPRESA", $$gParamGlb)
[      2536]   298-3      				putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO", $$gParamGlb)
[      2537]   299-3      				putitem/id viParams, "VL_VALOR", ""
[      2538]   300-3      				activate "ADMSVCO009".verificaRestricao(viParams, voParams, $xCdErro$, $xCtxerro$)
[      2539]   301-4      				if ($procerror)       
[      2540]   302-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2541]   303-4      					return(-1)
[      2542]   304-4      				elseif ($status < 0)
[      2543]   305-4      					$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Usuário com restrição para executar processo.%%^Restrição - IN_LIBERA_VALETROCA", "")
[      2544]   306-4      					$prompt = CD_BARRAPRD.SIS_FILTRO
[      2545]   307-4      					return(-1)
[      2546]   308-4      				endif
[      2547]   309-3      			endif
[      2548]              		;	clear/e "GER_EMPRESA" ;; Marcus Vinicius - 156/384 - 02/08/2010
[      2549]   310-2      			clear/e "V_FIS_NFITEMPROD"
[      2550]   311-2      		endif
[      2551]              		
[      2552]              		;Tarefa 102-939 Hugo em 14/09/2010
[      2553]   312-2      		if (TP_OPERACAO.GER_OPERACAO = "S") ; S - Saida
[      2554]   313-3      			if ($tpCoeficientePrdVd$ = 01) & (TP_MODALIDADE.GER_OPERACAO = 4)
[      2555]   314-3      				$instancehandle->validaItemCoeficiente(vCdProduto, vVlUnitLiquido, vQtSolicitada)
[      2556]   315-4      				if ($procerror)
[      2557]   316-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2558]   317-4      					$prompt = CD_BARRAPRD.SIS_FILTRO
[      2559]   318-4      					return (-1)
[      2560]   319-4      				elseif ($status < 0)
[      2561]   320-4      					$prompt = CD_BARRAPRD.SIS_FILTRO
[      2562]   321-4      					return (-1)
[      2563]   322-4      				endif
[      2564]              				
[      2565]   323-3      				viParams = ""
[      2566]   324-3      				putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2567]   325-3      				putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2568]   326-3      				putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2569]   327-3      				putitem/id viParams, "CD_BARRAPRD", vCdProduto
[      2570]   328-3      				putitem/id viParams, "IN_CODIGO", "T"
[      2571]   329-3      				putitem/id viParams, "QT_SOLICITADA", vQtSolicitada
[      2572]   330-3      				putitem/id viParams, "CD_CFOP", CD_CFOP.TRA_TRANSACAO
[      2573]   331-3      				putitem/id viParams, "CD_CST", CD_CST.TRA_TRANSACAO
[      2574]   332-3      				putitem/id viParams, "VL_BRUTO", vVlUnitLiquido
[      2575]   333-3      				putitem/id viParams, "VL_LIQUIDO", vVlUnitLiquido
[      2576]   334-3      				putitem/id viParams, "CD_TABPRECO", $cdTabPreco$ ;---Elia Proj. 102/317 11/06/08
[      2577]   335-3      				activate "TRASVCO004".validaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2578]   336-4      				if ($procerror)       
[      2579]   337-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2580]   338-4      					return(-1)
[      2581]   339-4      				endif
[      2582]              				
[      2583]   340-3      				vDsTrasvco004 = voParams
[      2584]   341-3      			endif
[      2585]   342-2      		endif
[      2586]              		;
[      2587]              		
[      2588]   343-2      		if (vInLimiteCredito > 0) & ($vlLimite$ != "")
[      2589]   344-2      			vVlTransacao = VL_TRANSACAO.TRA_TRANSACAO + $item("VL_TOTALLIQUIDO", vDsTrasvco004)
[      2590]              			
[      2591]   345-3      			if (vVlTransacao > $vlLimite$)
[      2592]   346-4      				if (vInLimiteCredito = 1)
[      2593]   347-4      					askmess/question "Limite do cliente ultrapassado. Deseja continuar?", "Não,Sim"
[      2594]   348-5      					if ($status = 1)
[      2595]   349-5      						$prompt = CD_BARRAPRD.SIS_FILTRO
[      2596]   350-5      						return(-1)
[      2597]   351-5      					endif
[      2598]   352-4      				elseif (vInLimiteCredito = 2)
[      2599]   353-4      					viParams = ""
[      2600]   354-4      					putitem/id viParams, "CD_COMPONENTE", $componentname
[      2601]   355-4      					putitem/id viParams, "DS_CAMPO", "IN_LIBERA_LIMITE"                   
[      2602]   356-4      					putitem/id viParams, "CD_EMPRESA", $item("CD_EMPRESA" ,$$gParamGlb)
[      2603]   357-4      					putitem/id viParams, "CD_USUARIO", $item("CD_USUARIO" ,$$gParamGlb)
[      2604]   358-4      					putitem/id viParams, "VL_VALOR", ""    
[      2605]   359-4      					activate "ADMSVCO009".VerificaRestricao(viParams, voParams, $xCdErro$, $xCtxerro$)
[      2606]   360-5      					if ($procerror)       
[      2607]   361-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2608]   362-5      						return(-1)
[      2609]   363-5      					elseif ($status < 0)
[      2610]   364-5      						$instancehandle->SetStatus(-1, "GEN001", "DESCRICAO=Limite do cliente ultrapassado. Usuário com restrição para executar processo.%%^Restrição - IN_LIBERA_LIMITE", "")
[      2611]   365-5      						return(-1)
[      2612]   366-5      					endif	
[      2613]   367-4      				endif
[      2614]   368-3      			endif
[      2615]   369-2      		endif
[      2616]              		
[      2617]              		;viParams = voParams
[      2618]   370-1      		viParams =	vDsTrasvco004
[      2619]              		;		
[      2620]   371-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2621]   372-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2622]   373-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2623]              		;-=LSC=- (14/04/2008) TAR 280 PRJ 102 - ITEM ECF CONCOMITANTE NAO PERDER A SEQUENCIA
[      2624]   374-2      		if (TP_DOCTO.GER_OPERACAO = 3)
[      2625]   375-2      			$vNrItem$ = $vNrItem$ + 1
[      2626]   376-2      			putitem/id viParams, "NR_ITEM", $vNrItem$
[      2627]   377-2      		endif
[      2628]              		;
[      2629]   378-1      		activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2630]   379-2      		if ($procerror)       
[      2631]   380-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2632]   381-2      			return(-1)
[      2633]   382-2      		elseif ($status < 0)
[      2634]   383-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2635]   384-2      			return(-1)
[      2636]   385-2      		endif  
[      2638]              		;Mendes - PRJ=156/TAR=682 - 23/11/2011
[      2639]   386-2      		if ($item("DS_MENSAGEM", voParams) != "")
[      2640]   387-2      			message/info "%%$item("DS_MENSAGEM", voParams)"
[      2641]   388-2      		endif
[      2642]              		;;;
[      2643]              	 	
[      2644]   389-1      		vNrItem = $item("NR_ITEM",voParams)
[      2646]              		;FIUZA 20/12/05 - IMPRESSAO ECF CONCOMITANTE
[      2647]   390-2      		if (TP_DOCTO.GER_OPERACAO = 3)
[      2648]   391-3      			if ($InCupomAberto$ = "S")
[      2649]   392-3      				viParams = ""
[      2650]   393-3      				putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2651]   394-3      				putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2652]   395-3      				putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2653]   396-3      				putitem/id viParams, "NR_ITEM", vNrItem		
[      2654]   397-3      				activate "ECFSVCO010".lancaItemConcomitante($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2655]   398-4      				if ($procerror)       
[      2656]   399-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2657]   400-4      					return(-1)
[      2658]   401-4      				elseif ($status = -10)
[      2659]   402-4      					viParams = ""
[      2660]   403-4      					voParams = ""
[      2661]   404-4      					putitem/id viParams,"TITULO", "Erro de comunicação com a ECF"
[      2662]   405-4      					putitem/id viParams,"MENSAGEM", $item("DESCRICAO",$xctxerro$)
[      2663]   406-4      					activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[      2664]   407-5      					if ($procerror)       
[      2665]   408-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2666]   409-5      						rollback
[      2667]   410-5      						return(-1)
[      2668]   411-5      					endif
[      2669]   412-4      					rollback
[      2670]   413-4      					$prompt = CD_BARRAPRD.SIS_FILTRO
[      2671]   414-4      					return(-1)
[      2672]   415-4      				elseif ($status = -50)
[      2673]   416-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2674]   417-4      					apexit
[      2675]   418-4      				elseif ($status < 0)
[      2676]   419-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2677]   420-4      					rollback
[      2678]   421-4      					$prompt = CD_BARRAPRD.SIS_FILTRO
[      2679]   422-4      					return(-1)
[      2680]   423-4      				endif
[      2681]   424-3      			endif
[      2682]              			
[      2683]   425-2      			creocc "TMP_NR09", -1
[      2684]   426-2      			NR_GERAL.TMP_NR09 = vNrItem
[      2685]   427-2      		endif
[      2686]              		
[      2687]   428-1      		commit
[      2688]   429-2      		if ($status < 0)
[      2689]   430-2      			rollback
[      2690]   431-2      			return (-1) 
[      2691]   432-2      		else
[      2692]   433-2      			$instancehandle->SetHint("ID=APLINFO002")
[      2693]   434-2      		endif
[      2694]              	
[      2695]   435-1      		clear/e "SIS_PRODUTO"
[      2696]              		;MARTINEZ - PRJ/TAR 182/042 - 15/04/2011
[      2697]              		;CD_PRODUTO.SIS_PRODUTO = $item("CD_PRODUTO", viParams)
[      2698]              		;DS_PRODUTO.SIS_PRODUTO = $item("DS_PRODUTO", viParams)
[      2699]              		;QT_SOLICITADA.SIS_PRODUTO = $item("QT_SOLICITADA", viParams)
[      2700]              		;VL_UNITARIO.SIS_PRODUTO = $item("VL_UNITLIQUIDO", viParams)
[      2701]              		;VL_TOTAL.SIS_PRODUTO = $item("VL_TOTALLIQUIDO", viParams)
[      2702]   436-1      		CD_PRODUTO.SIS_PRODUTO = $item("CD_PRODUTO", vDsTrasvco004)
[      2703]   437-1      		DS_PRODUTO.SIS_PRODUTO = $item("DS_PRODUTO", vDsTrasvco004)
[      2704]   438-1      		QT_SOLICITADA.SIS_PRODUTO = $item("QT_SOLICITADA", vDsTrasvco004)
[      2705]   439-1      		VL_UNITARIO.SIS_PRODUTO = $item("VL_UNITLIQUIDO", vDsTrasvco004)
[      2706]   440-1      		VL_TOTAL.SIS_PRODUTO = $item("VL_TOTALLIQUIDO", vDsTrasvco004)
[      2707]              		;
[      2708]              		
[      2709]   441-2      		if($inImagem$ = "T")
[      2710]   442-2      			clear/e "PRD_PRDIMAGEM"
[      2711]   443-2      			CD_PRODUTO.PRD_PRDIMAGEM/init = CD_PRODUTO.SIS_PRODUTO
[      2712]   444-2      			IN_PADRAO.PRD_PRDIMAGEM/init = "T"
[      2713]   445-2      			retrieve/e "PRD_PRDIMAGEM"
[      2714]   446-3      			if ($status >= 0)
[      2715]   447-3      				CD_IMAGEM.SIS_PRODUTO/init = CD_IMAGEM.PRD_PRDIMAGEM
[      2716]   448-3      			else
[      2717]   449-3      				clear/e "PRD_PRDIMAGEM"
[      2718]   450-3      				CD_PRODUTO.PRD_PRDIMAGEM/init = CD_PRODUTO.SIS_PRODUTO
[      2719]   451-3      				retrieve/e "PRD_PRDIMAGEM"
[      2720]   452-4      				if ($status >= 0)
[      2721]   453-4      					CD_IMAGEM.SIS_PRODUTO/init = CD_IMAGEM.PRD_PRDIMAGEM
[      2722]   454-4      				endif
[      2723]   455-3      			endif
[      2724]   456-2      		endif
[      2725]   457-1      		$instancehandle->recarregaTransacao()
[      2726]   458-2      		if ($procerror)
[      2727]   459-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2728]   460-2      		endif
[      2729]              		
[      2730]   461-2      		if (TP_MODALIDADE.GER_OPERACAO = 5) ;Outras Saídas/Entradas
[      2731]   462-2      			setocc "TRA_TRANSITEM", -1
[      2732]   463-2      			$instancehandle->alteraItem()
[      2733]   464-3      			if ($procerror)
[      2734]   465-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2735]   466-3      			endif
[      2736]   467-2      		endif
[      2737]   468-1      	endif
[      2738]              	
[      2739]   469        	vTpValidaVendedor = $item("TP_VALIDA_VENEDOR_VD", $xlplemp$)
[      2740]              	
[      2741]   470-1      	if (vTpValidaVendedor = 1) %\
[      2741]              	 & ((TP_MODALIDADE.GER_OPERACAO = 4 & TP_OPERACAO.GER_OPERACAO = "S") %\ ;Venda
[      2741]              2743	 | (TP_MODALIDADE.GER_OPERACAO = 3 & TP_OPERACAO.GER_OPERACAO = "E") %\ ;Vale Troca
[      2741]              2744	 | (TP_MODALIDADE.GER_OPERACAO = 8)) ;Troca
[      2745]   471-1      		$cdCompVend$ = CD_COMPVEND.TRA_TRANSACAO
[      2746]              		
[      2747]   472-1      		$instancehandle->BT_05()
[      2748]   473-2      		if ($procerror)
[      2749]   474-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2750]   475-2      		endif
[      2751]              		
[      2752]   476-1      		$inFocoVendedor$ = "T"
[      2753]   477-1      	endif
[      2754]              	
[      2755]   478        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[      2756]              	
[      2757]   479        	return(0)
[      2758]   480        end
[      2760]              ;---------------------------
[      2761]******        partner operation validaQuantidade
[      2762]              ;---------------------------
[      2763]              	variables
[      2764]              		string vDsMsg
[      2765]              	endvariables
[      2767]     1-1      	if (QT_SOLICITADA.SIS_FILTRO > 100)
[      2768]     2-1      		vDsMsg = "Quantidade maior que 100%%^%%%Continuar?"
[      2769]     3-2      		repeat
[      2770]     4-2      			askmess vDsMsg, "Não, Sim"
[      2771]     5-2      		until ($status = 2)
[      2772]     6-1      	endif
[      2774]     7        	return(0)
[      2775]     8        end
[      2777]              ;---------------------------
[      2778]******        partner operation alteraItem
[      2779]              ;---------------------------
[      2780]              	variables
[      2781]              		string viParams, voParams
[      2782]              		numeric vInLimiteCredito
[      2783]              	endvariables
[      2785]     1        	vInLimiteCredito = $item("IN_LIMITE_CREDITO_ITEM_VD", $xlplemp$)
[      2786]              	
[      2787]     2        	viParams = ""
[      2788]     3        	putlistitems/occ viParams, "TRA_TRANSITEM"
[      2789]     4        	putitem/id viParams, "TP_ALTERAITEM", TP_ALTERAITEM.TRA_TRANSACAO
[      2790]     5        	putitem/id viParams, "IN_LIMITECREDITO", vInLimiteCredito
[      2791]     6        	putitem/id viParams, "VL_LIMITE", $vlLimite$
[      2792]     7        	putitem/id viParams, "VL_TRANSACAO", VL_TRANSACAO.TRA_TRANSACAO
[      2793]     8        	$keyboard = "KB_GLOBAL"
[      2794]     9        	activate "TRAFM071".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      2795]    10        	$keyboard = "KB_PDV"
[      2796]    11-1      	if ($procerror)       
[      2797]    12-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2798]    13-1      	endif 
[      2800]    14-1      	if ($status < 0)
[      2801]    15-1      		return(-1)
[      2802]    16-1      	endif
[      2804]    17        	CD_CFOP.TRA_TRANSACAO/init = $item("CD_CFOP", voParams)
[      2805]    18        	CD_CST.TRA_TRANSACAO/init = $item("CD_CST", voParams)
[      2807]    19        	viParams = voParams
[      2808]    20        	activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2809]    21-1      	if ($procerror)       
[      2810]    22-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2811]    23-1      		return(-1)
[      2812]    24-1      	elseif ($status < 0)
[      2813]    25-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2814]    26-1      		return(-1)
[      2815]    27-1      	endif   
[      2817]              	;Mendes - PRJ=156/TAR=682 - 23/11/2011
[      2818]    28-1      	if ($item("DS_MENSAGEM", voParams) != "")
[      2819]    29-1      		message/info "%%$item("DS_MENSAGEM", voParams)"
[      2820]    30-1      	endif
[      2821]              	;;;
[      2823]    31        	commit
[      2824]    32-1      	if ($status < 0)
[      2825]    33-1      		rollback
[      2826]    34-1      		return (-1) 
[      2827]    35-1      	else
[      2828]    36-1      		$instancehandle->SetHint("ID=APLINFO002")
[      2829]    37-1      	endif    
[      2831]    38        	$instancehandle->recarregaTransacao()
[      2832]    39-1      	if ($procerror)
[      2833]    40-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2834]    41-1      	endif	
[      2836]    42        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[      2837]              	
[      2838]    43        	return(0)
[      2839]    44        end
[      2841]              ;---------------------------
[      2842]******        partner operation agrupaItem
[      2843]              ;---------------------------
[      2844]              	params
[      2845]              		boolean vInConfirmacao : IN
[      2846]              	endparams
[      2848]              	variables
[      2849]              		string  viParams, voParams, vDsErro
[      2850]              	endvariables
[      2852]     1-1      	if (TP_DOCTO.GER_OPERACAO = 3) ;ECF concomitante
[      2853]     2-1      		return(0)
[      2854]     3-1      	endif
[      2855]              	
[      2856]     4-1      	if (vInConfirmacao = "T")
[      2857]     5-1      		askmess "Deseja agrupar os itens da transação?", "Sim, Não"
[      2858]     6-2      		if ($status = 2) 
[      2859]     7-2      			return(-1)
[      2860]     8-2      		endif        
[      2861]     9-1      	endif
[      2862]              	
[      2863]    10        	viParams = ""
[      2864]    11        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2865]    12        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2866]    13        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2867]    14        	activate "TRASVCO010".agrupaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2868]    15-1      	if ($procerror)       
[      2869]    16-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2870]    17-1      		return(-1)
[      2871]    18-1      	elseif ($status < 0)
[      2872]    19-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2873]    20-1      		return(-1)
[      2874]    21-1      	endif   
[      2875]              	
[      2876]    22        	commit
[      2877]    23-1      	if ($status < 0)
[      2878]    24-1      		rollback
[      2879]    25-1      		return (-1) 
[      2880]    26-1      	else
[      2881]    27-1      		$instancehandle->SetHint("ID=APLINFO002")
[      2882]    28-1      	endif    
[      2883]              	
[      2884]    29        	$instancehandle->recarregaTransacao()
[      2885]    30-1      	if ($procerror)
[      2886]    31-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2887]    32-1      	endif
[      2888]              	
[      2889]    33        	return(0)
[      2890]    34        end
[      2892]              ;-------------------------------
[      2893]******        partner operation relacionaTroca
[      2894]              ;-------------------------------
[      2895]              	variables
[      2896]              		string viParams, voParams, vDsRegTroca
[      2897]              		numeric vCdEmpresaDev, vNrTransacaoDev
[      2898]              		date vDtTransacaoDev
[      2899]              	endvariables
[      2901]     1        	viParams = ""
[      2902]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      2903]     3        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      2904]     4        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      2905]     5        	$keyboard = "KB_GLOBAL"
[      2906]     6        	activate "TRAFM082".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      2907]     7        	$keyboard = "KB_PDV"
[      2908]     8-1      	if ($procerror)       
[      2909]     9-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2910]    10-1      		return(-1)
[      2911]    11-1      	endif
[      2912]    12-1      	if ($status < 0)
[      2913]    13-1      		return(-1)
[      2914]    14-1      	endif
[      2916]    15        	vCdEmpresaDev = $item("CD_EMPRESA", voParams)
[      2917]    16        	vNrTransacaoDev = $item("NR_TRANSACAO", voParams)
[      2918]    17        	vDtTransacaoDev = $item("DT_TRANSACAO", voParams)
[      2920]    18-1      	if (vNrTransacaoDev = 0)
[      2921]    19-1      		return(-1)
[      2922]    20-1      	endif
[      2924]    21        	viParams = ""
[      2925]    22        	putitem/id viParams, "CD_EMPDEV", vCdEmpresaDev
[      2926]    23        	putitem/id viParams, "NR_TRADEV", vNrTransacaoDev
[      2927]    24        	putitem/id viParams, "DT_TRADEV", vDtTransacaoDev
[      2928]    25        	putitem/id viParams, "CD_EMPVEN", CD_EMPRESA.TRA_TRANSACAO
[      2929]    26        	putitem/id viParams, "NR_TRAVEN", NR_TRANSACAO.TRA_TRANSACAO
[      2930]    27        	putitem/id viParams, "DT_TRAVEN", DT_TRANSACAO.TRA_TRANSACAO
[      2931]    28        	activate "TRASVCO016".gravaTrocaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2932]    29-1      	if ($procerror)       
[      2933]    30-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2934]    31-1      		return(-1)
[      2935]    32-1      	elseif ($status < 0)
[      2936]    33-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2937]    34-1      		return(-1)
[      2938]    35-1      	endif
[      2940]              ;	Esta alteracao ficou no final(F11)
[      2941]              ;	viParams = ""
[      2942]              ;	putitem/id viParams "CD_EMPRESA", vCdEmpresaDev
[      2943]              ;	putitem/id viParams "NR_TRANSACAO", vNrTransacaoDev
[      2944]              ;	putitem/id viParams "DT_TRANSACAO", vDtTransacaoDev
[      2945]              ;	putitem/id viParams "CD_COMPVEND", CD_COMPVEND.TRA_TRANSACAO
[      2946]              ;	activate "TRASVCO004".alteraVendedorTransacaoNF($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      2947]              ;	if($procerror)
[      2948]              ;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      2949]              ;		return(-1)
[      2950]              ;	elseif ($status < 0)
[      2951]              ;		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      2952]              ;		return(-1)
[      2953]              ;	endif	
[      2955]    36        	commit
[      2956]    37-1      	if ($status < 0)
[      2957]    38-1      		rollback
[      2958]    39-1      		return (-1) 
[      2959]    40-1      	else
[      2960]    41-1      		$instancehandle->SetHint("ID=APLINFO002")
[      2961]    42-1      	endif
[      2963]    43        	return(0)
[      2964]    44        end
[      2966]              ;-----------------------------------
[      2967]******        partner operation recarregaTransacao
[      2968]              ;-----------------------------------
[      2969]              	variables
[      2970]              		string vTpFoco, vTpInclusao, vTpAlteraItem, vDsProduto
[      2971]              		numeric vCdEmpresa, vNrTransacao, vNrOcc, vTpTransacao, vCdPessoa
[      2972]              		numeric vCdProduto, vCdImagem, vQtSolicitada, vVlUnitario, vVlTotal
[      2973]              		date vDtTransacao
[      2974]              		boolean vInCodigo
[      2975]              	endvariables    
[      2976]              	
[      2977]     1        	vCdEmpresa = CD_EMPRESA.TRA_TRANSACAO
[      2978]     2        	vNrTransacao = NR_TRANSACAO.TRA_TRANSACAO
[      2979]     3        	vDtTransacao = DT_TRANSACAO.TRA_TRANSACAO
[      2980]     4        	vCdPessoa = CD_PESSOA.TRA_TRANSACAO
[      2981]     5        	vTpFoco = TP_FOCO.TRA_TRANSACAO
[      2982]     6        	vTpInclusao = TP_INCLUSAO.TRA_TRANSACAO
[      2983]     7        	vTpAlteraItem = TP_ALTERAITEM.TRA_TRANSACAO
[      2984]     8        	vTpTransacao = TP_TRANSACAO.TRA_TRANSACAO
[      2985]     9        	vInCodigo = IN_CODIGO.SIS_FILTRO
[      2986]    10        	vCdProduto = CD_PRODUTO.SIS_PRODUTO
[      2987]    11        	vDsProduto = DS_PRODUTO.SIS_PRODUTO
[      2988]    12        	vCdImagem = CD_IMAGEM.SIS_PRODUTO
[      2989]    13        	vQtSolicitada = QT_SOLICITADA.SIS_PRODUTO
[      2990]    14        	vVlUnitario = VL_UNITARIO.SIS_PRODUTO
[      2991]    15        	vVlTotal = VL_TOTAL.SIS_PRODUTO
[      2992]    16        	vNrOcc = $curocc("TRA_TRANSITEM")
[      2993]              	
[      2994]    17        	clear/e "TRA_TRANSACAO"
[      2995]    18        	CD_EMPRESA.TRA_TRANSACAO/init = vCdEmpresa
[      2996]    19        	NR_TRANSACAO.TRA_TRANSACAO/init = vNrTransacao
[      2997]    20        	DT_TRANSACAO.TRA_TRANSACAO/init = vDtTransacao
[      2998]    21        	retrieve/e "TRA_TRANSACAO"
[      2999]    22-1      	if ($status >= 0)
[      3000]    23-1      		TP_FOCO.TRA_TRANSACAO/init = vTpFoco
[      3001]    24-1      		TP_INCLUSAO.TRA_TRANSACAO/init = vTpInclusao
[      3002]    25-1      		TP_ALTERAITEM.TRA_TRANSACAO/init = vTpAlteraItem
[      3003]    26-1      		TP_TRANSACAO.TRA_TRANSACAO/init = vTpTransacao
[      3004]    27-1      		IN_CODIGO.SIS_FILTRO/init = vInCodigo
[      3005]    28-1      		CD_PRODUTO.SIS_PRODUTO/init = vCdProduto
[      3006]    29-1      		DS_PRODUTO.SIS_PRODUTO/init = vDsProduto
[      3007]    30-1      		CD_IMAGEM.SIS_PRODUTO/init = vCdImagem
[      3008]    31-1      		QT_SOLICITADA.SIS_PRODUTO/init = vQtSolicitada
[      3009]    32-1      		VL_UNITARIO.SIS_PRODUTO/init = vVlUnitario
[      3010]    33-1      		VL_TOTAL.SIS_PRODUTO/init = vVlTotal
[      3011]    34-2      		if (CD_IMAGEM.SIS_PRODUTO > 0)
[      3012]    35-2      			clear/e "PRD_IMAGEM"
[      3013]    36-2      			CD_IMAGEM.PRD_IMAGEM/init = CD_IMAGEM.SIS_PRODUTO
[      3014]    37-2      			retrieve/e "PRD_IMAGEM"
[      3015]    38-3      			if ($status >= 0)
[      3016]    39-3      				DS_IMAGEM.SIS_IMAGEM/init = DS_ARQUIVO.PRD_IMAGEM
[      3017]    40-3      			endif
[      3018]    41-2      		endif
[      3019]              		
[      3020]    42-2      		if (vCdPessoa != CD_PESSOA.TRA_TRANSACAO) & (CD_PESSOA.TRA_TRANSACAO != $cdCliente$)
[      3021]    43-2      			$instancehandle->buscaAniversario()
[      3022]    44-3      			if ($procerror)
[      3023]    45-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3024]    46-3      			endif
[      3025]    47-2      		endif
[      3026]              		
[      3027]    48-1      		setocc "TRA_TRANSITEM", vNrOcc
[      3028]    49-1      	endif
[      3030]              	;* Claudemir - Prj/Tarefa: 191/1 - 27/09/2011
[      3031]              	; permitir desconto no cupom concomitante
[      3032]              	;; --- DIONE |102/0961| 14/10/2010
[      3033]              	;; Cupom Concomitante desabilita desconto por item.	
[      3034]              	;if(TP_DOCTO.GER_OPERACAO = 3) 
[      3035]              	;	fieldsyntax BT_F6.SIS_BOTOES, "DIM"
[      3036]              	;	$inF6$ = "F"
[      3037]              	;endif
[      3038]              	;; ---  ;*
[      3040]    50        	return(0)
[      3041]    51        end
[      3043]              ;-------------------------------------
[      3044]******        partner operation carregaDadosIniciais
[      3045]              ;-------------------------------------
[      3046]              	variables
[      3047]              		string viParams, voParams
[      3048]              	endvariables
[      3050]     1-1      	if($inConferente$ = 1);se o parametro estiver habilitado para usar o conferente
[      3051]     2-2      		if ($item("CD_USUCONF", $$gParamGlb) < 1)
[      3052]     3-2      			$keyboard = "KB_GLOBAL"
[      3053]     4-2      			activate "GERFM039".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3054]     5-2      			$keyboard = "KB_PDV"
[      3055]     6-3      			if ($procerror)
[      3056]     7-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3057]     8-3      				return(-1)
[      3058]     9-3      			endif
[      3059]    10-3      			if($status < 0)
[      3060]    11-3      				exit(-1)
[      3061]    12-3      			endif
[      3062]    13-2      		endif
[      3063]    14-2      		if ($item("CD_USUCONF", $$gParamGlb) >= 1);carrega a descricao do confenrente
[      3064]    15-2      			clear/e "ADM_USUARIO"
[      3065]    16-2      			CD_USUARIO.ADM_USUARIO/init = $item("CD_USUCONF", $$gParamGlb)
[      3066]    17-2      			retrieve/e "ADM_USUARIO"
[      3067]              ;			$dsConferente$ = NM_LOGIN.ADM_USUARIO
[      3068]    18-3      			if($status >= 0)
[      3069]              			;--->MNT - Prj 094/1320 - 18/03/2010
[      3070]    19-4      				if (CD_USUARIO.ADM_USUARIO > 0)
[      3071]    20-4      					viParams = ""
[      3072]    21-4      					voParams = ""
[      3073]    22-4      					putitem/id viParams, "CD_USUARIO", CD_USUARIO.ADM_USUARIO
[      3074]    23-4      					activate "ADMSVCO027".validaUsuarioEspecial($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)	
[      3075]    24-5      					if ($procerror)
[      3076]    25-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3077]    26-5      						return(-1)
[      3078]    27-5      					elseif ($status < 0)
[      3079]    28-5      						$instancehandle->SetStatus("",$xCdErro$, $xCtxErro$, "")
[      3080]    29-5      						return(-1)
[      3081]    30-5      					endif
[      3083]    31-5      					if(voParams != "")
[      3084]    32-5      						$dsConferente$ = $item("NM_LOGIN", voParams)
[      3085]    33-5      					endif
[      3086]    34-4      				else
[      3087]    35-4      					$dsConferente$ = ""
[      3088]    36-4      				endif
[      3089]              				;<---	
[      3090]    37-3      			endif
[      3091]    38-2      		else;se não tiver conferente o conferente é o proprio caixa
[      3092]    39-2      			clear/e "ADM_USUARIO"
[      3093]    40-2      			CD_USUARIO.ADM_USUARIO/init = $item("CD_USUARIO", $$gParamGlb)
[      3094]    41-2      			retrieve/e "ADM_USUARIO"
[      3095]              			;$dsConferente$ = NM_LOGIN.ADM_USUARIO
[      3096]    42-3      			if($status >= 0)
[      3097]              			;--->MNT - Prj 094/1320 - 18/03/2010
[      3098]    43-4      				if (CD_USUARIO.ADM_USUARIO > 0)
[      3099]    44-4      					viParams = ""
[      3100]    45-4      					voParams = ""
[      3101]    46-4      					putitem/id viParams, "CD_USUARIO", CD_USUARIO.ADM_USUARIO
[      3102]    47-4      					activate "ADMSVCO027".validaUsuarioEspecial($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)	
[      3103]    48-5      					if ($procerror)
[      3104]    49-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3105]    50-5      						return(-1)
[      3106]    51-5      					elseif ($status < 0)
[      3107]    52-5      						$instancehandle->SetStatus("",$xCdErro$, $xCtxErro$, "")
[      3108]    53-5      						return(-1)
[      3109]    54-5      					endif
[      3111]    55-5      					if(voParams != "")
[      3112]    56-5      						$dsConferente$ = $item("NM_LOGIN", voParams)
[      3113]    57-5      					endif
[      3114]    58-4      				else
[      3115]    59-4      					$dsConferente$ = ""
[      3116]    60-4      				endif
[      3117]              				;<---	
[      3118]    61-3      			endif
[      3119]              ;			DS_CONFERENTE.TRA_TRANSACAO/init = NM_LOGIN.ADM_USUARIO
[      3120]    62-2      		endif		
[      3121]    63-1      	endif
[      3122]              	
[      3123]              	;carrega a descricao do caixa.
[      3124]    64        	clear/e "ADM_USUARIO"
[      3125]    65        	CD_USUARIO.ADM_USUARIO/init = $item("CD_USUARIO", $$gParamGlb)
[      3126]    66        	retrieve/e "ADM_USUARIO"
[      3127]    67-1      	if ($status < 0)
[      3128]    68-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Código do usuário não encontrado!", "")
[      3129]    69-1      		return(-1)
[      3130]    70-1      	else
[      3131]              		;$dsCaixa$ = NM_LOGIN.ADM_USUARIO
[      3132]              		;--->MNT - Prj 094/1320 - 18/03/2010
[      3133]    71-2      		if (CD_USUARIO.ADM_USUARIO > 0)
[      3134]    72-2      			viParams = ""
[      3135]    73-2      			voParams = ""
[      3136]    74-2      			putitem/id viParams, "CD_USUARIO", CD_USUARIO.ADM_USUARIO
[      3137]    75-2      			activate "ADMSVCO027".validaUsuarioEspecial($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)	
[      3138]    76-3      			if ($procerror)
[      3139]    77-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3140]    78-3      				return(-1)
[      3141]    79-3      			elseif ($status < 0)
[      3142]    80-3      				$instancehandle->SetStatus("",$xCdErro$, $xCtxErro$, "")
[      3143]    81-3      				return(-1)
[      3144]    82-3      			endif
[      3146]    83-3      			if(voParams != "")
[      3147]    84-3      				$dsCaixa$ = $item("NM_LOGIN", voParams)
[      3148]    85-3      			endif
[      3149]    86-2      		else
[      3150]    87-2      			$dsCaixa$ = ""
[      3151]    88-2      		endif
[      3152]              		;<---	
[      3153]    89-1      	endif
[      3154]              	;carrega a descricao do terminal
[      3156]    90-1      	if($item("CD_TERMINAL", $$gParamGlb) != "")
[      3157]    91-1      		clear/e "GER_TERMINAL"
[      3158]    92-1      		CD_EMPRESA.GER_TERMINAL/init = $item("CD_EMPRESA", $$gParamGlb)
[      3159]    93-1      		CD_TERMINAL.GER_TERMINAL/init = $item("CD_TERMINAL", $$gParamGlb)
[      3160]    94-1      		retrieve/e "GER_TERMINAL"
[      3161]    95-1      		$dsTerminal$ = DS_TERMINAL.GER_TERMINAL
[      3162]    96-1      	endif
[      3164]    97        	$cdUsuarioDesc$ = ""
[      3165]    98        	$nrCartao$ = ""
[      3167]    99        	return(0)
[      3168]   100        end
[      3170]              ;----------------------------
[      3171]******        partner operation BT_CTRL_A
[      3172]              ;----------------------------
[      3173]              	variables
[      3174]              		string viParams, voParams
[      3175]              		numeric vNrTransacao
[      3176]              	endvariables
[      3178]     1        	viParams = ""
[      3179]     2        	activate "FCXFM004".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3180]     3-1      	if ($procerror)       
[      3181]     4-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3182]     5-1      		return(-1)
[      3183]     6-1      	endif 
[      3185]     7        	return(0)
[      3186]     8        end;bt_ctrl_D
[      3189]              ;----------------------------
[      3190]******        partner operation BT_CTRL_D
[      3191]              ;----------------------------
[      3192]              	variables
[      3193]              		string viParams, voParams
[      3194]              		numeric vNrTransacao
[      3195]              	endvariables
[      3197]     1        	viParams = ""
[      3198]     2        	activate "FCXFM005".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3199]     3-1      	if ($procerror)       
[      3200]     4-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3201]     5-1      		return(-1)
[      3202]     6-1      	endif 
[      3204]     7        	return(0)
[      3205]     8        end;bt_ctrl_D
[      3207]              ;----------------------------
[      3208]******        partner operation BT_CTRL_G
[      3209]              ;----------------------------
[      3210]              	variables
[      3211]              		string viParams, voParams
[      3212]              		numeric vNrTransacao
[      3213]              	endvariables
[      3215]     1        	viParams = ""
[      3216]     2        	putlistitems/occ viParams, "TRA_TRANSACAO"
[      3217]     3        	activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3218]     4-1      	if ($procerror)       
[      3219]     5-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3220]     6-1      		return(-1)
[      3221]     7-1      	elseif ($status < 0)
[      3222]     8-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3223]     9-1      		return(-1)
[      3224]    10-1      	endif
[      3226]    11        	commit
[      3227]    12-1      	if ($status < 0)
[      3228]    13-1      		rollback
[      3229]    14-1      		return (-1) 
[      3230]    15-1      	else
[      3231]    16-1      		$instancehandle->SetHint("ID=APLINFO002")
[      3232]    17-1      	endif
[      3234]    18-1      	if (NR_TRANSACAO.TRA_TRANSACAO = 0)
[      3235]    19-1      		vNrTransacao = $item("NR_TRANSACAO", voParams)
[      3236]    20-1      		NR_TRANSACAO.TRA_TRANSACAO/init = vNrTransacao
[      3237]    21-1      	endif
[      3239]    22        	viParams = ""
[      3240]    23        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3241]    24        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3242]    25        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3243]    26        	$keyboard = "KB_GLOBAL"
[      3244]    27        	activate "TRAFM081".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3245]    28        	$keyboard = "KB_PDV"
[      3246]    29-1      	if ($procerror)       
[      3247]    30-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3248]    31-1      		return(-1)
[      3249]    32-1      	endif
[      3250]              	
[      3251]    33        	commit
[      3252]    34-1      	if ($status < 0)
[      3253]    35-1      		rollback
[      3254]    36-1      		return (-1) 
[      3255]    37-1      	else
[      3256]    38-1      		$instancehandle->SetHint("ID=APLINFO002")
[      3257]    39-1      	endif
[      3259]    40        	$instancehandle->recarregaTransacao()
[      3260]    41-1      	if ($procerror)
[      3261]    42-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3262]    43-1      	endif
[      3263]              	
[      3264]    44        	$prompt = TP_TRANSACAO.TRA_TRANSACAO
[      3265]              	
[      3266]    45        	return(0)
[      3267]    46        end;bt_ctrl_G
[      3269]              ;----------------------------
[      3270]******        partner operation BT_CTRL_S
[      3271]              ;----------------------------
[      3272]              	variables
[      3273]              		string viParams, voParams
[      3274]              		numeric vNrTransacao
[      3275]              	endvariables
[      3277]     1        	viParams = ""
[      3278]     2        	activate "FCXFM006".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3279]     3-1      	if ($procerror)       
[      3280]     4-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3281]     5-1      		return(-1)
[      3282]     6-1      	endif 
[      3284]     7        	return(0)
[      3285]     8        end;bt_ctrl_S
[      3287]              ;-----------------------------------
[      3288]******        partner operation entradaColetor
[      3289]              ;-----------------------------------
[      3290]              	;FIUZA PROJETO 41 TAREFA 15 - 02/03/06
[      3291]              	;FOI INCLUSO O BOTAO PARA ENTRADA POR COLETOR NA TRANSAÇÃO
[      3292]              	params
[      3293]              		string vDsLstColetor : IN
[      3294]              	endparams
[      3295]              	variables
[      3296]              		string viParams, voParams, vCdBarra, vDsRegistro
[      3297]              		numeric vCdProduto, vQtSolicitada, vNrSeq
[      3298]              		date vDtTransacao
[      3299]              	endvariables 
[      3301]     1-1      	if ($empty("TRA_TRANSITEM") = 0)
[      3302]     2-1      		setocc "TRA_TRANSITEM", -1
[      3303]     3-1      		vNrSeq = NR_ITEM.TRA_TRANSITEM + 1
[      3304]     4-1      	else
[      3305]     5-1      		vNrSeq = 1
[      3306]     6-1      	endif
[      3308]     7-1      	repeat
[      3309]     8-1      		vDsRegistro = ""
[      3310]     9-1      		getitem vDsRegistro, vDsLstColetor, 1
[      3311]    10-1      		vCdProduto = $item("CD_PRODUTO",vDsRegistro)
[      3312]    11-1      		vCdBarra = $item("CD_BARRAPRD", vDsRegistro)
[      3313]    12-1      		vQtSolicitada = $item("QT_COLETA",vDsRegistro)
[      3314]    13-1      		viParams = ""
[      3315]    14-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3316]    15-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3317]    16-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3318]    17-2      		if ($tpUtilizaEtiqRfidPdv$ > 0) ;-=CANONICO=- (10/06/2011) TAR 570 / PRJ 156 - Gravar o codigo de Barra RFID
[      3319]    18-2      			putitem/id viParams, "CD_BARRAPRD", vCdBarra
[      3320]    19-2      			putitem/id viParams, "IN_CODIGO", "F"    
[      3321]    20-2      		else
[      3322]    21-2      			putitem/id viParams, "CD_BARRAPRD", vCdProduto
[      3323]    22-2      			putitem/id viParams, "IN_CODIGO", "T"    
[      3324]    23-2      		endif
[      3325]    24-1      		putitem/id viParams, "QT_SOLICITADA", vQtSolicitada
[      3326]    25-1      		putitem/id viParams, "CD_TABPRECO", $cdTabPreco$ ;---Elia Proj. 102/317 11/06/08
[      3327]    26-1      		activate "TRASVCO004".validaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3328]    27-2      		if ($procerror)       
[      3329]    28-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3330]    29-2      		endif    
[      3331]    30-2      		if ($status < 0)
[      3332]    31-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3333]    32-2      		endif
[      3334]    33-2      		if ($status >= 0)
[      3335]    34-2      			clear/e "TRA_TRANSITEM"
[      3336]    35-2      			creocc "TRA_TRANSITEM", -1
[      3337]    36-2      			getlistitems/occ voParams, "TRA_TRANSITEM"
[      3338]    37-2      			NR_ITEM.TRA_TRANSITEM = vNrSeq
[      3339]    38-2      			CD_EMPFAT.TRA_TRANSITEM = CD_EMPFAT.TRA_TRANSACAO
[      3340]    39-2      			CD_GRUPOEMPRESA.TRA_TRANSITEM = CD_GRUPOEMPRESA.TRA_TRANSACAO
[      3342]    40-2      			viParams = ""
[      3343]    41-2      			putlistitems/occ viParams, "TRA_TRANSITEM"
[      3344]    42-2      			activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3345]    43-3      			if ($procerror)       
[      3346]    44-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3347]    45-3      				rollback
[      3348]    46-3      			elseif ($status < 0)
[      3349]    47-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3350]    48-3      				rollback	
[      3351]    49-3      			endif 
[      3353]              			;Mendes - PRJ=156/TAR=682 - 23/11/2011
[      3354]    50-3      			if ($item("DS_MENSAGEM", voParams) != "")
[      3355]    51-3      				message/info "%%$item("DS_MENSAGEM", voParams)"
[      3356]    52-3      			endif
[      3357]              			;;;
[      3359]    53-2      			commit
[      3360]    54-3      			if ($status < 0)
[      3361]    55-3      				rollback 
[      3362]    56-3      			else
[      3363]    57-3      				$instancehandle->SetHint("ID=APLINFO002")
[      3364]    58-3      			endif
[      3365]    59-2      		endif
[      3367]    60-1      		vNrSeq = vNrSeq + 1
[      3369]    61-1      		delitem vDsLstColetor, 1
[      3370]    62-1      	until (vDsLstColetor = "")
[      3371]              	
[      3372]    63        	return(0)
[      3373]    64        end
[      3375]              ;==================== ANO Pjt 90 Trf 1 20/12/2006
[      3376]              ;---------------------------
[      3377]******        partner operation observacao
[      3378]              	;---------------------------
[      3379]              	variables
[      3380]              		string  viParams, voParams
[      3381]              	endvariables
[      3382]              	
[      3383]     1        	viParams = ""
[      3384]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3385]     3        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3386]     4        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3387]     5        	activate "TRAFM065".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3388]     6-1      	if ($procerror)       
[      3389]     7-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3390]     8-1      		return(-1)
[      3391]     9-1      	endif 
[      3392]              	
[      3393]    10-1      	if ($status < 0)
[      3394]    11-1      		rollback
[      3395]    12-1      		return(-1)
[      3396]    13-1      	endif
[      3397]              	
[      3398]    14        	commit
[      3399]    15-1      	if ($status < 0)
[      3400]    16-1      		rollback
[      3401]    17-1      		return (-1) 
[      3402]    18-1      	else
[      3403]    19-1      		$instancehandle->SetHint("ID=APLINFO002")
[      3404]    20-1      	endif    
[      3405]              	
[      3406]    21        	return(0)
[      3407]    22        end ;observacao
[      3409]              ;--------------------------------------
[      3410]******        partner operation carregaFormaPagamento
[      3411]              ;--------------------------------------
[      3412]              	variables
[      3413]              		string viParams, voParams, vDsLstParcela
[      3414]              	endvariables
[      3415]              	
[      3416]     1-1      	if ($tpSimuladorFat$ = 0) & ($inSimuladorProduto$ = "F") & ($inSimuladorCondPgto$ = "F")
[      3417]              		;Hugo em 31/01/11 Tarefa 156-504
[      3418]     2-1      		commit
[      3419]     3-2      		if ($status < 0)
[      3420]     4-2      			rollback
[      3421]     5-2      		else
[      3422]     6-2      			$instancehandle->SetHint("ID=APLINFO002")
[      3423]     7-2      		endif
[      3424]              		;
[      3425]              		
[      3426]     8-1      		return(0)
[      3427]     9-1      	endif
[      3429]              	;-=CANONICO=- (03/07/2009) TAR 593 PRJ 102 - Não chamar o simulador quando valor devolução menor ou igual a transação
[      3430]    10-1      	if (TP_OPERACAO.TRA_TRANSACAO = "S") & (TP_MODALIDADE.GER_OPERACAO = 8) & (VL_TRANSACAO.TRA_TRANSACAO <= VL_TOTAL.R_TRA_TRANSACAO)
[      3431]              		;------------------------------
[      3432]              		;Comentado por Hugo em 02/02/10
[      3433]              		;Tarefa 156-162
[      3434]              		;------------------------------
[      3435]              		;;>-- MAC - PRJ 156 TAR 161 - 28/01/2010 ---
[      3436]              		;if ($inSimuladorProduto$ = "T")
[      3437]              		;	viParams = ""    
[      3438]              		;	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3439]              		;	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3440]              		;	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3441]              		;	activate "TRASVCO004".gravaParcelaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3442]              		;	if ($procerror)       
[      3443]              		;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3444]              		;		return(-1)
[      3445]              		;	elseif ($status < 0)
[      3446]              		;		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3447]              		;		return(-1)
[      3448]              		;	endif	
[      3449]              		;endif
[      3450]              		;;--<
[      3451]              		;------------------------------
[      3452]    11-1      		return(0)
[      3453]    12-1      	endif	
[      3454]              	;
[      3455]              	;>-- MAC - PRJ 156/400 - 17/09/2010 ---
[      3456]    13-1      	if (TP_MODALIDADE.GER_OPERACAO = 4 | TP_MODALIDADE.GER_OPERACAO = 8) & (TP_OPERACAO.TRA_TRANSACAO = "S")
[      3457]    14-1      	else
[      3458]              	;if (TP_MODALIDADE.GER_OPERACAO != 4 & TP_MODALIDADE.GER_OPERACAO != 8) | (TP_OPERACAO.TRA_TRANSACAO != "S")
[      3459]    15-1      		return(0)
[      3460]    16-1      	endif
[      3461]              	;--<
[      3462]    17-1      	if ($inSimuladorProduto$ = "T")
[      3463]    18-1      		viParams = ""
[      3464]    19-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3465]    20-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3466]    21-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3467]    22-1      		$keyboard = "KB_GLOBAL"
[      3468]    23-1      		activate "TRAFM113".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3469]    24-1      		$keyboard = "KB_PDV"
[      3470]    25-2      		if ($procerror)
[      3471]    26-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3472]    27-2      			return(-1)
[      3473]    28-2      		elseif ($status < 0)
[      3474]    29-2      			return(-1)
[      3475]    30-2      		endif
[      3476]    31-1      	elseif ($inSimuladorCondPgto$ = "T")
[      3477]    32-1      		viParams = ""
[      3478]    33-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3479]    34-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3480]    35-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3481]    36-1      		$keyboard = "KB_GLOBAL"
[      3482]    37-1      		activate "TRAFM123".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3483]    38-1      		$keyboard = "KB_PDV"
[      3484]    39-2      		if ($procerror)
[      3485]    40-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3486]    41-2      			return(-1)
[      3487]    42-2      		elseif ($status < 0)
[      3488]    43-2      			return(-1)
[      3489]    44-2      		endif
[      3490]    45-1      	elseif ($tpSimuladorFat$ > 0)
[      3491]    46-1      		viParams = ""
[      3492]    47-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3493]    48-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3494]    49-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3495]    50-1      		$keyboard = "KB_GLOBAL"
[      3496]    51-1      		activate "TRAFM078".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3497]    52-1      		$keyboard = "KB_PDV"
[      3498]    53-2      		if ($procerror)
[      3499]    54-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3500]    55-2      			return(-1)
[      3501]    56-2      		elseif ($status < 0)
[      3502]    57-2      			return(-1)
[      3503]    58-2      		endif
[      3504]    59-1      	endif
[      3506]    60-1      	if (voParams != "")
[      3507]    61-1      		$cdUsuarioDesc$ = $item("CD_USUARIODESC", voParams)
[      3508]    62-1      		vDsLstParcela = $item("DS_LSTPARCELA", voParams)
[      3509]              		
[      3510]    63-1      		viParams = voParams
[      3511]    64-1      		activate "TRASVCO017".gravaFormaPagamento($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3512]    65-2      		if ($procerror)       
[      3513]    66-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3514]    67-2      			return(-1)
[      3515]    68-2      		elseif ($status < 0)
[      3516]    69-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3517]    70-2      			return(-1)
[      3518]    71-2      		endif 
[      3519]    72-2      		if(vDsLstParcela != "")
[      3520]    73-2      			viParams = ""    
[      3521]    74-2      			putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3522]    75-2      			putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3523]    76-2      			putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3524]    77-2      			putitem/id viParams, "IN_SOBREPOR", "T"
[      3525]    78-2      			putitem/id viParams, "DS_LSTPARCELA", vDsLstParcela
[      3526]    79-2      			activate "TRASVCO004".gravaParcelaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3527]    80-3      			if ($procerror)       
[      3528]    81-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3529]    82-3      				return(-1)
[      3530]    83-3      			elseif ($status < 0)
[      3531]    84-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3532]    85-3      				return(-1)
[      3533]    86-3      			endif
[      3534]    87-2      		endif
[      3535]              		
[      3536]    88-1      		commit
[      3537]    89-2      		if ($status < 0)
[      3538]    90-2      			rollback
[      3539]    91-2      		else
[      3540]    92-2      			$instancehandle->SetHint("ID=APLINFO002")
[      3541]    93-2      		endif
[      3542]    94-1      	endif
[      3543]              	
[      3544]    95        	$instancehandle->recarregaTransacao()
[      3545]    96-1      	if ($procerror)
[      3546]    97-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3547]    98-1      	endif	
[      3548]              	
[      3549]    99        	return(0)
[      3550]   100        end
[      3552]              ;--------------------------
[      3553]******        partner operation BT_CTRL_T
[      3554]              ;--------------------------
[      3555]              	variables
[      3556]              		string viParams, voParams
[      3557]              		numeric vNrTransacao
[      3558]              	endvariables
[      3559]              	
[      3560]     1-1      	if (NR_TRANSACAO.TRA_TRANSACAO = 0)
[      3561]     2-1      		return(0)
[      3562]     3-1      	endif
[      3563]              	
[      3564]     4-1      	if (TP_MODALIDADE.GER_OPERACAO != "8" | TP_OPERACAO.TRA_TRANSACAO != "S")
[      3565]     5-1      		return(0)
[      3566]     6-1      	endif
[      3567]              	
[      3568]     7        	viParams = ""
[      3569]     8        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3570]     9        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3571]    10        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3572]    11        	$keyboard = "KB_GLOBAL"
[      3573]    12        	activate "TRAFL054".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3574]    13        	$keyboard = "KB_PDV"
[      3575]    14-1      	if ($procerror)       
[      3576]    15-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3577]    16-1      		return(-1)
[      3578]    17-1      	endif 
[      3580]    18        	return(0)
[      3581]    19        end
[      3583]              ;---Elia Proj. 115/3 11/10/07--
[      3584]******        partner operation listaDetalhe
[      3585]              ; Alteracao realisada pelo Sr. Fuiza 
[      3586]              ;------------------------------
[      3588]     1-1      	if ($dbocc("TRA_TRANSITEM"))
[      3589]     2-2      		if (CD_BARRAPRD.TRA_TRANSITEM = "")
[      3590]     3-2      			CD_BARRAPRD.DETALHE/init = CD_PRODUTO.TRA_TRANSITEM
[      3591]     4-2      		else
[      3592]     5-2      			CD_BARRAPRD.DETALHE/init = CD_BARRAPRD.TRA_TRANSITEM
[      3593]     6-2      		endif
[      3595]     7-1      		VL_UNITBRUTO.DETALHE/init = VL_UNITBRUTO.TRA_TRANSITEM
[      3596]     8-1      		PR_DESCONTO.DETALHE/init  =	PR_DESCONTO.TRA_TRANSITEM
[      3597]     9-1      		VL_UNITDESC.DETALHE/init  = VL_UNITDESC.TRA_TRANSITEM
[      3598]    10-1      	endif
[      3600]    11        	return (0)
[      3602]    12        end ; operation listaDetalhe
[      3604]              ;----------------------------
[      3605]******        partner operation buscaLimite
[      3606]              ;----------------------------
[      3607]              	variables
[      3608]              		string viParams, voParams
[      3609]              		boolean vInValidaFamiliar
[      3610]              	endvariables
[      3611]              	
[      3612]     1        	$vlLimite$ = ""
[      3613]              	
[      3614]     2        	vInValidaFamiliar = $item("IN_LIMITE_FAMILIAR_VD", $xlplemp$)
[      3615]     3-1      	if (vInValidaFamiliar = "T")
[      3616]     4-1      		vInValidaFamiliar = "F"
[      3617]              		
[      3618]     5-1      		clear/e "TRA_TRANSACADIC"
[      3619]     6-1      		CD_EMPRESA.TRA_TRANSACADIC/init = CD_EMPRESA.TRA_TRANSACAO
[      3620]     7-1      		DT_TRANSACAO.TRA_TRANSACADIC/init = DT_TRANSACAO.TRA_TRANSACAO
[      3621]     8-1      		NR_TRANSACAO.TRA_TRANSACADIC/init = NR_TRANSACAO.TRA_TRANSACAO
[      3622]     9-1      		retrieve/e "TRA_TRANSACADIC"
[      3623]    10-2      		if ($status >= 0) & (CD_FAMILIAR.TRA_TRANSACADIC != 0)
[      3624]    11-2      			vInValidaFamiliar = "T"
[      3625]    12-2      		endif
[      3626]    13-1      	endif
[      3627]              	
[      3628]    14        	viParams = ""
[      3629]    15        	putitem/id viParams, "CD_CLIENTE", CD_PESSOA.PES_PESSOA
[      3630]    16        	putitem/id viParams, "IN_TOTAL", "T"
[      3631]              	
[      3632]    17-1      	if (vInValidaFamiliar = "T") & (CD_FAMILIAR.TRA_TRANSACADIC != 0)
[      3633]    18-1      		putitem/id viParams, "CD_FAMILIAR", CD_FAMILIAR.TRA_TRANSACADIC
[      3634]    19-1      	else
[      3635]    20-1      		vInValidaFamiliar = "F"
[      3636]    21-1      	endif
[      3637]              	
[      3638]    22        	activate "FCRSVCO015".buscaLimiteCliente($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      3639]    23-1      	if ($procerror)       
[      3640]    24-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3641]    25-1      		return(-1)
[      3642]    26-1      	elseif ($status < 0)
[      3643]    27-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3644]    28-1      		return(-1)
[      3645]    29-1      	endif
[      3646]              	
[      3647]    30-1      	if (vInValidaFamiliar = "T")
[      3648]    31-1      		$vlLimite$ = $item("VL_SALDOFAMILIAR", voParams)
[      3649]    32-1      	else
[      3650]    33-1      		$vlLimite$ = $item("VL_SALDO", voParams)
[      3651]    34-1      	endif
[      3652]              	
[      3653]    35        	$nrDiaAtraso$ = $item("NR_DIAVENCTO", voParams)
[      3654]              	
[      3655]    36        	return(0)
[      3656]    37        end
[      3658]              ;---Elia Proj. 102/324 30/05/08-------------
[      3659]******        partner operation aplicaQtPecasDescontoVlMin
[      3660]              ;-------------------------------------------
[      3662]              	variables
[      3663]              		string viParams, voParams, vDsLstTransacao, vDsRegistro, vDsMensagemPRD
[      3664]              		numeric vVlTotalDesc, vPrTotalDesc, vVlResto, vVlCalc, vVlMaior, vNrOcc        
[      3665]              		numeric vVlBrutoTransacao, vQtDesconto, vQtDescontoAplic, vQtDescontoAplicPRD 
[      3666]              	endvariables
[      3668]     1-1      	if ($inSimuladorProduto$ = "T")
[      3669]     2-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto total o parâmetro por empresa IN_SIMULADOR_FAT_PRODUTO está configurado!", "")
[      3670]     3-1      		return(-1)
[      3671]     4-1      	endif
[      3673]     5-1      	if ($inSimuladorCondPgto$ = "T")
[      3674]     6-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto total o parâmetro por empresa IN_SIMULADOR_COND_PGTO está configurado!", "")
[      3675]     7-1      		return(-1)
[      3676]     8-1      	endif
[      3677]              	
[      3678]     9-1      	if ($tpSimuladorFat$ > 0)
[      3679]    10-1      		$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é possível aplicar desconto total o parâmetro por empresa TP_SIMULADOR_FAT está configurado!", "")
[      3680]    11-1      		return(-1)
[      3681]    12-1      	endif
[      3683]    13-1      	if ($qtPecasDescontoVlMin$ = 0)
[      3684]    14-1      		return (0)	
[      3685]    15-1      	endif
[      3687]              	;---Elia Proj. 102/529 08/05/09
[      3688]    16        	askmess "Deseja aplicar desconto?", "Cancelar, Sim, Não"
[      3689]    17-1      	if ($status = 1) ; 1 - Cancelar
[      3690]    18-1      		return (-1)
[      3691]    19-1      	elseif ($status = 3) ; 3 - Não
[      3692]    20-1      		return (0)
[      3693]    21-1      	endif
[      3694]              	;
[      3696]    22        	clear/e "TMP_NR10"
[      3697]              	;---Verifica quantos descontos seram dados
[      3698]    23        	vQtDesconto = (QT_SOLICITADA.TRA_TRANSACAO / $qtPecasDescontoVlMin$)
[      3699]    24        	vQtDesconto = vQtDesconto[trunc]
[      3700]    25        	$vlDescAcumulado$ = 0
[      3702]              	;---Carrega o valor o menor para aplicar desconto 
[      3703]              	;a partir da quantidade de desconto que sera dado.
[      3704]    26-1      	if (vQtDesconto > 0)
[      3705]    27-1      		clear/e "TRA_S_TRANSITEM"	
[      3706]    28-1      		CD_EMPRESA.TRA_S_TRANSITEM/init = CD_EMPRESA.TRA_TRANSACAO
[      3707]    29-1      		NR_TRANSACAO.TRA_S_TRANSITEM/init = NR_TRANSACAO.TRA_TRANSACAO
[      3708]    30-1      		DT_TRANSACAO.TRA_S_TRANSITEM/init = DT_TRANSACAO.TRA_TRANSACAO
[      3709]    31-1      		retrieve/e "TRA_S_TRANSITEM"
[      3710]    32-2      		if ($status >= 0)
[      3711]    33-2      			sort/e "TRA_S_TRANSITEM", "VL_UNITLIQUIDO.TRA_S_TRANSITEM,CD_PRODUTO.TRA_S_TRANSITEM"
[      3712]    34-2      			setocc "TRA_S_TRANSITEM", 1
[      3713]    35-2      			vQtDescontoAplic = 1
[      3714]    36-2      			vQtDescontoAplicPRD = 0
[      3715]    37-3      			repeat	
[      3716]    38-3      				vQtDescontoAplicPRD = vQtDescontoAplicPRD + 1
[      3717]    39-4      				if (QT_SOLICITADA.TRA_S_TRANSITEM >= vQtDescontoAplicPRD)			
[      3718]    40-4      					$vlDescAcumulado$ = $vlDescAcumulado$ + VL_UNITLIQUIDO.TRA_S_TRANSITEM
[      3719]    41-4      				else
[      3720]    42-4      					vQtDescontoAplicPRD = 1
[      3721]    43-4      					setocc "TRA_S_TRANSITEM", $curocc("TRA_S_TRANSITEM") + 1
[      3722]    44-4      					$vlDescAcumulado$ = $vlDescAcumulado$ + VL_UNITLIQUIDO.TRA_S_TRANSITEM
[      3723]    45-4      				endif
[      3724]              			
[      3725]              				;---Monta item para a msg.
[      3726]    46-3      				creocc "TMP_NR10", -1
[      3727]    47-3      				NR_GERAL.TMP_NR10 = CD_PRODUTO.TRA_S_TRANSITEM
[      3728]    48-3      				retrieve/o "TMP_NR10"
[      3730]    49-3      				DS_PRODUTO.TMP_NR10 = DS_PRODUTO.TRA_S_TRANSITEM
[      3731]    50-3      				VL_UNITARIO.TMP_NR10 = VL_UNITLIQUIDO.TRA_S_TRANSITEM
[      3732]    51-3      				QT_DESCONTO.TMP_NR10 = QT_DESCONTO.TMP_NR10 + 1
[      3733]              				;
[      3734]    52-3      				vQtDescontoAplic = vQtDescontoAplic + 1			
[      3735]    53-3      			until (vQtDescontoAplic > vQtDesconto)
[      3736]    54-2      		endif
[      3737]    55-1      	endif
[      3738]              	;
[      3739]              		
[      3740]    56-1      	if ($vlDescAcumulado$ > 0)	
[      3741]              		;---Gera msg. de desconto
[      3742]    57-1      		setocc "TMP_NR10", 1
[      3743]    58-2      		while ($status >= 0)
[      3744]    59-3      			if(vDsMensagemPRD = "")
[      3745]    60-3      				vDsMensagemPRD = "Produto:%%^ %%NR_GERAL.TMP_NR10 - %%DS_PRODUTO.TMP_NR10 - Qt. %%QT_DESCONTO.TMP_NR10 - Vl. unit. %%VL_UNITARIO.TMP_NR10"
[      3746]    61-3      			else
[      3747]    62-3      				vDsMensagemPRD = "%%vDsMensagemPRD %%^ %%NR_GERAL.TMP_NR10 - %%DS_PRODUTO.TMP_NR10 - Qt. %%QT_DESCONTO.TMP_NR10 - Vl. unit. %%VL_UNITARIO.TMP_NR10"
[      3748]    63-3      			endif
[      3749]    64-2      			setocc "TMP_NR10", $curocc("TMP_NR10") + 1
[      3750]    65-2      		endwhile
[      3752]    66-1      		vDsMensagemPRD = "%%vDsMensagemPRD %%^ %%^ Quantidade de produto com desconto: %%vQtDesconto"
[      3753]    67-1      		vDsMensagemPRD = "%%vDsMensagemPRD %%^ %%^ Valor bruto transação: %%VL_TOTAL.TRA_TRANSACAO"
[      3754]    68-1      		vDsMensagemPRD = "%%vDsMensagemPRD %%^ Valor total desconto: %%$vlDescAcumulado$"
[      3755]    69-1      		$vlLiqTransacao$ = VL_TOTAL.TRA_TRANSACAO - $vlDescAcumulado$
[      3756]    70-1      		vDsMensagemPRD = "%%vDsMensagemPRD %%^ Valor líquido transação: %%$vlLiqTransacao$"
[      3757]              		;
[      3759]    71-1      		viParams = ""
[      3760]    72-1      		voParams = ""
[      3761]    73-1      		putitem/id viParams,"TITULO", "Informação de Desconto"
[      3762]    74-1      		putitem/id viParams,"MENSAGEM", vDsMensagemPRD
[      3763]    75-1      		activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[      3764]    76-2      		if ($procerror)       
[      3765]    77-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3766]    78-2      		endif
[      3767]    79-1      		askmess "Confirmar desconto?","Sim,Não"
[      3768]    80-2      		if ($status = 2)
[      3769]    81-2      			return (-1)
[      3770]    82-2      		endif
[      3772]    83-1      		vVlBrutoTransacao = VL_TRANSACAO.TRA_TRANSACAO + VL_DESCONTO.TRA_TRANSACAO
[      3773]    84-1      		vVlTotalDesc = VL_DESCONTO.TRA_TRANSACAO + $vlDescAcumulado$
[      3774]    85-1      		vVlCalc = vVlTotalDesc / vVlBrutoTransacao * 100
[      3775]    86-1      		vPrTotalDesc = vVlCalc[round ,6]
[      3777]    87-1      		vVlResto = vVlTotalDesc
[      3778]              	
[      3779]    88-2      		if (!$empty("TRA_TRANSITEM"))
[      3780]    89-2      			vVlMaior = 0
[      3781]    90-2      			setocc "TRA_TRANSITEM", 1 
[      3782]    91-3      			while ($status >= 0)
[      3783]              				;Bloquear desconto para item em promoção
[      3784]    92-4      				if (($InBloqDesItemProm$ = "T") & (CD_PROMOCAO.TRA_TRANSITEM > 0))
[      3785]    93-4      				else
[      3786]              					;>-- MAC - PRJ 156/276 - 29/04/2010 ---
[      3787]              					;vVlCalc = VL_UNITLIQUIDO.TRA_TRANSITEM + VL_UNITDESCCAB.TRA_TRANSITEM
[      3788]              					;vVlCalc = vVlCalc * vPrTotalDesc / 100			
[      3789]              					;VL_UNITDESCCAB.TRA_TRANSITEM = vVlCalc[round, 2]
[      3790]              					;vVlCalc = VL_UNITDESCCAB.TRA_TRANSITEM * QT_SOLICITADA.TRA_TRANSITEM
[      3791]              					;VL_TOTALDESCCAB.TRA_TRANSITEM = vVlCalc[round, 2]
[      3792]              					;VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      3793]              					;vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3794]              					;VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      3796]    94-4      					vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM
[      3797]    95-4      					vVlCalc = vVlCalc * vPrTotalDesc / 100			
[      3798]    96-4      					VL_TOTALDESCCAB.TRA_TRANSITEM = vVlCalc[round, 2]
[      3799]    97-4      					VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      3800]    98-4      					vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3801]    99-4      					VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[      3802]   100-4      					vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3803]   101-4      					VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      3805]   102-5      					if (VL_TOTALDESCCAB.TRA_TRANSITEM > vVlResto)				
[      3806]   103-5      						VL_TOTALDESCCAB.TRA_TRANSITEM = vVlResto 
[      3807]   104-5      		   				VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      3808]   105-5      						vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3809]   106-5      						VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[      3810]   107-5      						vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3811]   108-5      						VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      3812]   109-5      						vVlResto = 0
[      3813]   110-5      						break
[      3814]   111-5      					endif
[      3815]              					;--<
[      3817]   112-4      					vVlResto = vVlResto - VL_TOTALDESCCAB.TRA_TRANSITEM
[      3818]              					
[      3819]   113-5      					if (VL_TOTALLIQUIDO.TRA_TRANSITEM > vVlMaior)
[      3820]   114-5      						vVlMaior = VL_TOTALLIQUIDO.TRA_TRANSITEM
[      3821]   115-5      						vNrOcc = $curocc("TRA_TRANSITEM")
[      3822]   116-5      					endif
[      3823]   117-4      				endif
[      3824]   118-3      				setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      3825]   119-3      			endwhile
[      3826]              	
[      3827]   120-3      			if (vVlResto != 0)
[      3828]   121-3      				setocc "TRA_TRANSITEM", vNrOcc
[      3829]   122-3      				VL_TOTALDESCCAB.TRA_TRANSITEM = VL_TOTALDESCCAB.TRA_TRANSITEM + vVlResto
[      3830]   123-3      				VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - (VL_TOTALDESC.TRA_TRANSITEM + VL_TOTALDESCCAB.TRA_TRANSITEM)
[      3831]   124-3      				vVlCalc = VL_TOTALDESCCAB.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3832]   125-3      				VL_UNITDESCCAB.TRA_TRANSITEM = vVLCalc[round, 6]
[      3833]   126-3      				vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      3834]   127-3      				VL_UNITLIQUIDO.TRA_TRANSITEM = vVLCalc[round, 6]
[      3835]   128-3      			endif	
[      3836]              		
[      3837]   129-2      			setocc "TRA_TRANSITEM", 1 
[      3838]   130-3      			while ($status >= 0)
[      3839]   131-3      				viParams = ""
[      3840]   132-3      				putlistitems/occ viParams, "TRA_TRANSITEM"
[      3841]   133-3      				putitem/id viParams, "IN_TOTAL", "F"
[      3842]   134-3      				activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3843]   135-4      				if ($procerror)       
[      3844]   136-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3845]   137-4      					return(-1)
[      3846]   138-4      				elseif ($status < 0)
[      3847]   139-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3848]   140-4      					return(-1)
[      3849]   141-4      				endif
[      3850]   142-3      				setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      3851]   143-3      			endwhile
[      3853]              			;Mendes - PRJ=156/TAR=682 - 23/11/2011
[      3854]   144-3      			if ($item("DS_MENSAGEM", voParams) != "")
[      3855]   145-3      				message/info "%%$item("DS_MENSAGEM", voParams)"
[      3856]   146-3      			endif
[      3857]              			;;;
[      3858]              	
[      3859]   147-2      			vDsLstTransacao = ""
[      3860]   148-2      			vDsRegistro = ""
[      3861]   149-2      			putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3862]   150-2      			putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3863]   151-2      			putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3864]   152-2      			putitem vDsLstTransacao, -1, vDsRegistro    
[      3865]   153-2      			putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      3866]   154-2      			activate "TRASVCO004".gravaTotalTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3867]   155-3      			if ($procerror)       
[      3868]   156-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3869]   157-3      				return(-1)
[      3870]   158-3      			elseif ($status < 0)
[      3871]   159-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3872]   160-3      				return(-1)
[      3873]   161-3      			endif	
[      3874]              	
[      3875]   162-2      			viParams = ""    
[      3876]   163-2      			putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3877]   164-2      			putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3878]   165-2      			putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3879]   166-2      			putitem/id viParams, "IN_SOBREPOR", "T"
[      3880]   167-2      			activate "TRASVCO004".gravaParcelaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3881]   168-3      			if ($procerror)       
[      3882]   169-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3883]   170-3      				return(-1)
[      3884]   171-3      			elseif ($status < 0)
[      3885]   172-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3886]   173-3      				return(-1)
[      3887]   174-3      			endif
[      3888]   175-2      		endif	
[      3890]              		;---Gera observacao
[      3891]   176-1      		vDsLstTransacao = ""
[      3892]   177-1      		vDsRegistro = ""
[      3893]   178-1      		putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3894]   179-1      		putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3895]   180-1      		putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3896]   181-1      		putitem vDsLstTransacao, -1, vDsRegistro
[      3898]   182-1      		viParams = ""
[      3899]   183-1      		putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      3900]   184-1      		putitem/id viParams, "DS_OBSERVACAO", "Vl. total desc.: %%$vlDescAcumulado$ / Qt. produto com desc.: %%vQtDesconto"
[      3901]   185-1      		putitem/id viParams, "CD_COMPONENTE", $componentname
[      3902]   186-1      		putitem/id viParams, "IN_OBSNF", "F"		
[      3903]   187-1      		activate "TRASVCO016".gravaObsTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3904]   188-2      		if ($procerror)     
[      3905]   189-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3906]   190-2      			return(-1)
[      3907]   191-2      		elseif ($status < 0)
[      3908]   192-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3909]   193-2      			return(-1)
[      3910]   194-2      		endif				
[      3911]              		;
[      3912]   195-1      	endif
[      3914]   196        	return (0)
[      3916]   197        End ; operation aplicaQtPecasDescontoVlMin
[      3918]              ;---Elia Proj. 102/317 10/06/08----------
[      3919]******        partner operation buscaDadosAdicTransacao
[      3920]              ;----------------------------------------
[      3922]              	variables
[      3923]              		string viParams, voParams
[      3924]              	endvariables
[      3926]     1        	viParams = ""
[      3927]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      3928]     3        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      3929]     4        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      3930]     5        	activate "TRASVCO016".buscaDadosAdicionais($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3931]     6-1      	if ($procerror)       
[      3932]     7-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3933]     8-1      		return(-1)
[      3934]     9-1      	elseif ($status < 0)
[      3935]    10-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3936]    11-1      		return(-1)
[      3937]    12-1      	endif
[      3939]    13        	$cdTabPreco$ = $item("CD_TABPRECO", voParams)
[      3941]    14        	return (0)
[      3943]    15        End ; operation buscaDadosAdicTransacao
[      3945]              ;---Elia Proj. 133/007 15/08/08-----
[      3946]******        partner operation carregaBonusCartao
[      3947]              ;-----------------------------------
[      3949]              	variables
[      3950]              		string viParams, voParams, vDsLstTransacao, vDsRegistro, vDsLstCartao
[      3951]              		numeric vCdCartao, vVlBrutoTransacao, vPrTotalBonus, vVlResto, vVlTotalBonusItem , vVlCalc
[      3952]              		numeric vVlMaior, vNrOcc, vCdCliente
[      3953]              	endvariables
[      3955]     1        	vDsLstCartao = ""
[      3956]     2        	vVlCalc = ""
[      3958]     3        	viParams = ""
[      3959]     4        	$keyboard = "KB_GLOBAL"
[      3960]     5        	putitem/id viParams, "NR_CARTAO", $nrCartao$ ;---Elia Proj. 102/492 13/04/09
[      3961]              	;==BY BIANCHINI[PRJ/TAREFA 186/0275] 18/10/2011 ==;
[      3962]     6        	putitem/id viParams, "VL_TRANSACAO", VL_TRANSACAO.TRA_TRANSACAO
[      3963]              	;==
[      3964]     7        	activate "CTCFP003".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      3965]     8        	$keyboard = "KB_PDV"
[      3966]     9-1      	if ($procerror)       
[      3967]    10-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3968]    11-1      		return(-1)
[      3969]    12-1      	elseif ($status < 0)
[      3970]    13-1      		return(-1)
[      3971]    14-1      	endif 
[      3973]    15        	vCdCartao = $item("CD_CARTAO", voParams)
[      3974]    16        	vCdCliente = $item("CD_CLIENTE", voParams)
[      3975]    17        	$vlBonusUtil$ = $item("VL_BONUSUTIL", voParams)
[      3976]    18        	vDsLstCartao = voParams
[      3978]    19-1      	if (vCdCartao != 0)
[      3979]              		;---Altera cliente da transacao
[      3980]    20-1      		CD_PESSOA.TRA_TRANSACAO = vCdCliente
[      3981]    21-1      		viParams = ""
[      3982]    22-1      		putlistitems/occ viParams, "TRA_TRANSACAO"
[      3983]    23-1      		activate "TRASVCO004".gravaCapaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      3984]    24-2      		if ($procerror)       
[      3985]    25-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      3986]    26-2      			return(-1)
[      3987]    27-2      		elseif ($status < 0)
[      3988]    28-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      3989]    29-2      			return(-1)
[      3990]    30-2      		endif
[      3992]              		;---Aplica Bonus do cartao alterando valor do produto
[      3993]    31-2      		if ($vlBonusUtil$ != 0)
[      3994]              			;---Elia Proj. 102/538 07/05/09 Logica movida para o TRASVCO024
[      3995]              			;;vVlBrutoTransacao = VL_TRANSACAO.TRA_TRANSACAO
[      3996]              			;vVlCalc = $vlBonusUtil$ / vVlBrutoTransacao * 100
[      3997]              			;vPrTotalBonus = vVlCalc[round ,6]
[      3998]              			;vVlResto = $vlBonusUtil$
[      3999]              			;
[      4000]              			;if (!$empty("TRA_TRANSITEM"))
[      4001]              			;	vVlMaior = 0
[      4002]              			;	setocc "TRA_TRANSITEM", 1 
[      4003]              			;	while ($status >= 0)
[      4004]              			;		vVlCalc = VL_UNITLIQUIDO.TRA_TRANSITEM
[      4005]              			;		vVlCalc = vVlCalc * vPrTotalBonus / 100	
[      4006]              			;		VL_UNITLIQUIDO.TRA_TRANSITEM = VL_UNITLIQUIDO.TRA_TRANSITEM - vVlCalc[round, 2]
[      4007]              			;		vVlTotalBonusItem = vVlCalc[round, 2] * QT_SOLICITADA.TRA_TRANSITEM
[      4008]              			;		vVlCalc = VL_UNITLIQUIDO.TRA_TRANSITEM * QT_SOLICITADA.TRA_TRANSITEM
[      4009]              			;		VL_TOTALLIQUIDO.TRA_TRANSITEM = vVlCalc[round, 2]		
[      4010]              			;
[      4011]              			;		vVlCalc = VL_UNITBRUTO.TRA_TRANSITEM
[      4012]              			;		vVlCalc = vVlCalc * vPrTotalBonus / 100	
[      4013]              			;		VL_UNITBRUTO.TRA_TRANSITEM = VL_UNITBRUTO.TRA_TRANSITEM - vVlCalc[round, 2]
[      4014]              			;		vVlCalc = VL_UNITBRUTO.TRA_TRANSITEM * QT_SOLICITADA.TRA_TRANSITEM
[      4015]              			;		VL_TOTALBRUTO.TRA_TRANSITEM = vVlCalc[round, 2]
[      4016]              			;
[      4017]              			;		vVlResto = vVlResto - vVlTotalBonusItem
[      4018]              			;		
[      4019]              			;		if (VL_TOTALLIQUIDO.TRA_TRANSITEM > vVlMaior)
[      4020]              			;			vVlMaior = VL_TOTALLIQUIDO.TRA_TRANSITEM
[      4021]              			;			vNrOcc = $curocc("TRA_TRANSITEM")
[      4022]              			;		endif
[      4023]              			;		setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      4024]              			;	endwhile
[      4025]              			;
[      4026]              			;	if (vVlResto != 0)
[      4027]              			;		setocc "TRA_TRANSITEM", vNrOcc
[      4028]              			;		VL_TOTALBRUTO.TRA_TRANSITEM = VL_TOTALBRUTO.TRA_TRANSITEM - vVlResto
[      4029]              			;		vVlCalc = VL_TOTALBRUTO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      4030]              			;		VL_UNITBRUTO.TRA_TRANSITEM = vVlCalc[round, 2]
[      4031]              			;
[      4032]              			;		VL_TOTALLIQUIDO.TRA_TRANSITEM = VL_TOTALLIQUIDO.TRA_TRANSITEM - vVlResto
[      4033]              			;		vVlCalc = VL_TOTALLIQUIDO.TRA_TRANSITEM / QT_SOLICITADA.TRA_TRANSITEM
[      4034]              			;		VL_UNITLIQUIDO.TRA_TRANSITEM = vVlCalc[round, 2]
[      4035]              			;	endif	
[      4036]              			;
[      4037]              			;	setocc "TRA_TRANSITEM", 1 
[      4038]              			;	while ($status >= 0)
[      4039]              			;		;---Elia Proj. 102/400 09/10/08 no caso do desconto se zerar o valor é lancado 0.01 pois o valor do item nao pode ser zero
[      4040]              			;		if (VL_UNITBRUTO.TRA_TRANSITEM < 0.01)
[      4041]              			;			VL_UNITBRUTO.TRA_TRANSITEM = 0.01
[      4042]              			;			vVlCalc = VL_UNITBRUTO.TRA_TRANSITEM * QT_SOLICITADA.TRA_TRANSITEM
[      4043]              			;			VL_TOTALBRUTO.TRA_TRANSITEM = vVlCalc[round, 2]
[      4044]              			;		endif
[      4045]              			;		;
[      4046]              			;
[      4047]              			;		;---Elia Proj. 102/400 09/10/08 ;no caso do desconto se zerar o valor é lancado 0.01 pois o valor do item nao pode ser zero
[      4048]              			;		if (VL_UNITLIQUIDO.TRA_TRANSITEM < 0.01)
[      4049]              			;			VL_UNITLIQUIDO.TRA_TRANSITEM = 0.01
[      4050]              			;			vVlCalc = VL_UNITLIQUIDO.TRA_TRANSITEM * QT_SOLICITADA.TRA_TRANSITEM
[      4051]              			;			VL_TOTALLIQUIDO.TRA_TRANSITEM = vVlCalc[round, 2]		
[      4052]              			;		endif
[      4053]              			;		;
[      4054]              			;
[      4055]              			;		viParams = ""
[      4056]              			;		putlistitems/occ viParams, "TRA_TRANSITEM"
[      4057]              			;		putitem/id viParams, "IN_TOTAL", "F"
[      4058]              			;		activate "TRASVCO004".gravaItemTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4059]              			;		if ($procerror)       
[      4060]              			;			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4061]              			;			return(-1)
[      4062]              			;		elseif ($status < 0)
[      4063]              			;			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4064]              			;			return(-1)
[      4065]              			;		endif
[      4066]              			;		setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      4067]              			;	endwhile
[      4068]              			;	
[      4069]              			;	viParams = ""
[      4070]              			;	vDsLstTransacao = ""
[      4071]              			;	vDsRegistro = ""
[      4072]              			;	putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      4073]              			;	putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4074]              			;	putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4075]              			;	putitem vDsLstTransacao, -1, vDsRegistro    
[      4076]              			;	putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      4077]              			;	activate "TRASVCO004".gravaTotalTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4078]              			;	if ($procerror)       
[      4079]              			;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4080]              			;		return(-1)
[      4081]              			;	elseif ($status < 0)
[      4082]              			;		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4083]              			;		return(-1)
[      4084]              			;	endif	
[      4085]              			;
[      4086]              			;	viParams = ""    
[      4087]              			;	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      4088]              			;	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4089]              			;	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4090]              			;	putitem/id viParams, "IN_SOBREPOR", "T"
[      4091]              			;	activate "TRASVCO004".gravaParcelaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4092]              			;	if ($procerror)       
[      4093]              			;		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4094]              			;		return(-1)
[      4095]              			;	elseif ($status < 0)
[      4096]              			;		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4097]              			;		return(-1)
[      4098]              			;	endif
[      4099]              			;endif
[      4100]    32-2      			viParams = ""    
[      4101]    33-2      			putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      4102]    34-2      			putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4103]    35-2      			putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4104]    36-2      			putitem/id viParams, "VL_BONUS", $vlBonusUtil$
[      4105]    37-2      			activate "TRASVCO024".gravaBonusTraItemAdic($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4106]    38-3      			if ($procerror)       
[      4107]    39-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4108]    40-3      				return(-1)
[      4109]    41-3      			elseif ($status < 0)
[      4110]    42-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4111]    43-3      				return(-1)
[      4112]    44-3      			endif
[      4113]              			;
[      4114]              		
[      4115]              			;---Gera observacao
[      4116]    45-2      			vDsLstTransacao = ""
[      4117]    46-2      			vDsRegistro = ""
[      4118]    47-2      			putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      4119]    48-2      			putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4120]    49-2      			putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4121]    50-2      			putitem vDsLstTransacao, -1, vDsRegistro		
[      4123]    51-2      			viParams = ""
[      4124]    52-2      			putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      4125]    53-2      			putitem/id viParams, "DS_OBSERVACAO", "Utilizado bonus de %%$vlBonusUtil$"
[      4126]    54-2      			putitem/id viParams, "CD_COMPONENTE", $componentname
[      4127]    55-2      			putitem/id viParams, "IN_OBSNF", "F"		
[      4128]    56-2      			activate "TRASVCO016".gravaObsTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4129]    57-3      			if ($procerror)     
[      4130]    58-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4131]    59-3      				return(-1)
[      4132]    60-3      			elseif ($status < 0)
[      4133]    61-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4134]    62-3      				return(-1)
[      4135]    63-3      			endif				
[      4136]              			;
[      4137]    64-2      		endif
[      4138]              		;
[      4140]              		;---Grava CTC_TRACARTAO
[      4141]    65-1      		viParams = vDsLstCartao
[      4142]    66-1      		putitem/id viParams, "CD_EMPTRANSACAO", CD_EMPRESA.TRA_TRANSACAO
[      4143]    67-1      		putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4144]    68-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4145]    69-1      		activate "CTCSVCO004".gravarCartaoTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4146]    70-2      		if ($procerror)     
[      4147]    71-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4148]    72-2      			return(-1)
[      4149]    73-2      		elseif ($status < 0)
[      4150]    74-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4151]    75-2      			return(-1)
[      4152]    76-2      		endif	
[      4153]    77-1      	endif
[      4155]    78        	return (0)
[      4157]    79        End ; operation carregaBonusCartao
[      4159]              ;-----------------------------------
[      4160]******        partner operation imprimirTransacao
[      4161]              ;-----------------------------------
[      4162]              	variables
[      4163]              		string viParams, voParams, vDsLstTransacao, vDsRegistro
[      4164]              		boolean vInImprimir
[      4165]              	endvariables
[      4167]     1        	vInImprimir = "T"
[      4168]     2-1      	if (vInImprimir = "T")
[      4169]     3-1      		viParams = ""
[      4170]     4-1      		vDsLstTransacao = ""
[      4171]     5-1      		vDsRegistro = ""
[      4172]     6-1      		putitem/id vDsRegistro, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      4173]     7-1      		putitem/id vDsRegistro, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4174]     8-1      		putitem/id vDsRegistro, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4175]     9-1      		putitem vDsLstTransacao, -1, vDsRegistro	
[      4176]    10-1      		putitem/id viParams, "DS_LSTTRANSACAO", vDsLstTransacao
[      4177]    11-2      		if ($tpImpressaoTraVenda$ = 02)
[      4178]    12-2      			putitem/id viParams, "IN_DIRETO", "F"
[      4179]    13-2      		else
[      4180]    14-2      			putitem/id viParams, "IN_DIRETO", "T"
[      4181]    15-2      		endif
[      4183]    16-1      		$keyboard = "KB_GLOBAL"
[      4184]    17-1      		activate "TRAFP004".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      4185]    18-1      		$keyboard = "KB_PDV"
[      4186]    19-2      		if ($procerror)       
[      4187]    20-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4188]    21-2      		endif
[      4189]    22-2      		if ($status >= 0)
[      4190]    23-2      			commit
[      4191]    24-3      			if ($status < 0)
[      4192]    25-3      				rollback
[      4193]    26-3      			else
[      4194]    27-3      				$instancehandle->SetHint("ID=APLINFO002")
[      4195]    28-3      			endif
[      4196]    29-2      		else
[      4197]    30-2      			rollback
[      4198]    31-2      		endif   
[      4199]    32-1      	endif	
[      4201]    33        	return(0)
[      4202]    34        end
[      4206]              ;----------------------
[      4207]              ;imprimi transacao
[      4208]******        partner operation BT_CTRL_F11
[      4209]              ;----------------------	
[      4210]     1-1      	if($dbocc("TRA_TRANSACAO") = 0)
[      4211]     2-1      		return(-1)
[      4212]     3-1      	endif
[      4213]              	
[      4214]     4        	$instancehandle->agrupaItem("F")
[      4215]     5-1      	if ($procerror)
[      4216]     6-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4217]     7-1      	endif
[      4219]     8        	$instancehandle->imprimirTransacao()
[      4220]     9-1      	if ($procerror)
[      4221]    10-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4222]    11-1      	endif
[      4224]    12        	$instancehandle->recarregaTransacao()
[      4225]    13-1      	if ($procerror)
[      4226]    14-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4227]    15-1      	endif
[      4228]              		
[      4229]              ;	$prompt = NR_ITEM.TRA_TRANSITEM
[      4231]    16        	return(0)
[      4232]    17        end
[      4234]              ;---------------------------------
[      4235]******        partner operation buscaAniversario
[      4236]              ;---------------------------------
[      4237]              	variables
[      4238]              		numeric vTpAniversario, vDiaNasc, vMesNasc, vDiaAtual, vMesAtual
[      4239]              		date vDtSistema
[      4240]              	endvariables
[      4241]              	
[      4242]     1        	vTpAniversario = $item("TP_AVISA_ANIVERSARIO", $xlplemp$)
[      4243]              	
[      4244]     2-1      	if (vTpAniversario = 1 | vTpAniversario = 4)
[      4245]     3-2      		if ($empty("PES_PESFISICA") = 0) & (DT_NASCIMENTO.PES_PESFISICA != "")
[      4246]     4-2      			vDtSistema = $item("DT_SISTEMA", $$gParamGlb)
[      4247]              			
[      4248]     5-2      			vDiaNasc = DT_NASCIMENTO.PES_PESFISICA[D]
[      4249]     6-2      			vMesNasc = DT_NASCIMENTO.PES_PESFISICA[M]
[      4250]     7-2      			vDiaAtual = vDtSistema[D]
[      4251]     8-2      			vMesAtual = vDtSistema[M]
[      4252]              			
[      4253]     9-3      			if (vDiaNasc = vDiaAtual & vMesNasc = vMesAtual)
[      4254]    10-3      				message/info "Atenção. Aniversariante!"
[      4255]    11-3      			endif
[      4256]    12-2      		endif
[      4257]    13-1      	endif
[      4258]              	
[      4259]    14        	return(0)
[      4260]    15        end
[      4262]              ;--------------------------
[      4263]******        partner operation simulacao
[      4264]              ;--------------------------
[      4265]              	variables
[      4266]              		string  viParams, voParams
[      4267]              	endvariables
[      4268]              	
[      4269]     1-1      	if (NR_TRANSACAO.TRA_TRANSACAO = 0)
[      4270]     2-1      		return(0)
[      4271]     3-1      	endif
[      4272]              	
[      4273]     4        	viParams = ""
[      4274]     5        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      4275]     6        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      4276]     7        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      4277]     8        	putitem/id viParams, "IN_PDV", "T"
[      4278]     9        	activate "TRAFM078".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      4279]    10-1      	if ($procerror)       
[      4280]    11-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4281]    12-1      		return(-1)
[      4282]    13-1      	endif 
[      4283]              	
[      4284]    14        	return(0)
[      4285]    15        end
[      4287]              ;-----------------------------------
[      4288]******        partner operation efetivaTEFPendente
[      4289]              ;-----------------------------------
[      4290]              	variables
[      4291]              		string viParams, voParams, vDsLstCupom, vDsRegistro, vDsConteudo, vDsAprovado, vDsMensagem, vDsLstEmpresa, vDsNsu
[      4292]              		boolean vInLoopConfirmacao, vInLoopImpressao
[      4293]              		numeric vNrLinhaCupom, vNrSequencia, vNrTotOcc, vNrOcc
[      4294]              	endvariables
[      4295]     1        	vDsLstEmpresa = ""
[      4297]              ;; Marcus Vinicius - 156/384 - 02/08/2010
[      4298]              ;	clear/e "GER_EMPRESA"
[      4299]              ;	CD_GRUPOEMPRESA.GER_EMPRESA = CD_GRUPOEMPRESA.TRA_TRANSACAO
[      4300]              ;	retrieve/e "GER_EMPRESA"
[      4301]              ;	if ($status >= 0)
[      4302]              ;		setocc "GER_EMPRESA", -1
[      4303]              ;		setocc "GER_EMPRESA", 1
[      4304]              ;		putlistitems vDsLstEmpresa, CD_EMPRESA.GER_EMPRESA
[      4305]              ;	endif
[      4306]     2        	viParams = ""
[      4307]     3        	putitem/id viParams, "IN_VALIDALOCAL", "F"
[      4308]     4-1      	if(CD_GRUPOEMPRESA.TRA_TRANSACAO != "")
[      4309]     5-1      		putitem/id viParams, "CD_GRUPOEMPRESA", CD_GRUPOEMPRESA.TRA_TRANSACAO
[      4310]     6-1      	else
[      4311]     7-1      		putitem/id viParams, "CD_GRUPOEMPRESA", $item("CD_GRUPOEMPRESA", $$gParamGlb)
[      4312]     8-1      	endif
[      4313]     9        	activate "GERSVCO032".buscaLstGrupoEmpresa($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      4314]    10-1      	if ($procerror)       
[      4315]    11-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4316]    12-1      	endif
[      4317]    13        	vDsLstEmpresa = $item("CD_EMPRESA", voParams)
[      4318]              ;;
[      4319]    14        	vNrTotOcc = 0
[      4320]    15        	vDsNsu = ""
[      4322]    16        	clear/e "F_TEF_TRANSACAO"
[      4323]    17        	CD_EMPRESA.F_TEF_TRANSACAO/init = vDsLstEmpresa
[      4324]    18        	CD_TERMINAL.F_TEF_TRANSACAO/init = $item("CD_TERMINAL",$$gParamglb)
[      4325]    19        	TP_SITUACAO.F_TEF_TRANSACAO/init = "1·;2·;4"
[      4326]    20        	retrieve/e "F_TEF_TRANSACAO"
[      4327]    21-1      	if ($status >= 0)
[      4328]    22-2      		if ($tpConfirmacaoTefPen$ = 1) ;-=CANONICO=- (07/12/2011) PRJ 156 TAR 694 -> Alterado o parametro antes utiliza o paygo resumido
[      4329]              			;-=CANONICO=- (23-11-2011) Quando tiver transacao atendida efetuar CNF - Confirmar a transacao TEF.
[      4330]    23-2      			vNrTotOcc = $totocc("F_TEF_TRANSACAO")
[      4331]    24-2      			clear/e "TEF_RELTRANSACAO"
[      4332]    25-2      			CD_EMPTEF.TEF_RELTRANSACAO/init = CD_EMPRESA.F_TEF_TRANSACAO
[      4333]    26-2      			DT_MOVIMENTO.TEF_RELTRANSACAO/init = DT_MOVIMENTO.F_TEF_TRANSACAO
[      4334]    27-2      			NR_SEQ.TEF_RELTRANSACAO/init = NR_SEQ.F_TEF_TRANSACAO
[      4335]    28-2      			retrieve/e "TEF_RELTRANSACAO"
[      4336]    29-3      			if ($status >= 0)
[      4337]    30-3      				clear/e "TRA_TRANSACAO"
[      4338]    31-3      				CD_EMPRESA.TRA_TRANSACAO/init  = CD_EMPTRA.TEF_RELTRANSACAO                          
[      4339]    32-3      				NR_TRANSACAO.TRA_TRANSACAO/init = NR_TRANSACAO.TEF_RELTRANSACAO
[      4340]    33-3      				DT_TRANSACAO.TRA_TRANSACAO/init = DT_TRANSACAO.TEF_RELTRANSACAO
[      4341]    34-3      				retrieve/e "TRA_TRANSACAO"
[      4342]    35-4      				if ($status >= 0)
[      4343]    36-5      					if (TP_SITUACAO.TRA_TRANSACAO = 4) ;atendida
[      4344]              	
[      4345]    37-5      						setocc "F_TEF_TRANSACAO", 1
[      4346]    38-6      						while ($status >= 0)
[      4347]    39-6      							vDsNsu = "%%vDsNsu%%^%%NR_NSU.F_TEF_TRANSACAO"
[      4348]              							;Transação com cupom fiscal impresso, então envia o CNF	
[      4349]    40-6      							$instancehandle->efetivaTEFPendenteGeral_CNF()
[      4350]    41-7      							if ($procerror)
[      4351]    42-7      								$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      4352]    43-7      							endif
[      4353]    44-6      							vNrOcc = $curocc("F_TEF_TRANSACAO")
[      4354]    45-6      							setocc "F_TEF_TRANSACAO", $curocc("F_TEF_TRANSACAO") + 1
[      4355]    46-6      						endwhile
[      4356]              					
[      4357]    47-6      						if (vNrOcc >= vNrTotOcc)
[      4358]    48-6      							$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação efetuada.%%^ Favor re-imprimir o cupom!%%^ %%vDsNsu", "") 			
[      4359]    49-6      						endif		
[      4361]    50-5      						clear/e "TRA_TRANSACAO"
[      4362]    51-5      						return(0)
[      4363]    52-5      					endif
[      4364]    53-4      				endif
[      4365]    54-3      			endif
[      4366]    55-2      		endif
[      4367]              		
[      4368]    56-2      		if ($tpTEF$ = 2)
[      4369]              			;ordena TEF_TRANSACAO por TP_SITUACAO, pois no TEF DISCADO usando múltiplos cartões
[      4370]              			;é necessário mandar o NCN da ultima transação cuja o TP_SITUACAO = 1  e depois cancelar
[      4371]              			;todas as transações TP_SITUACAO = 4, ou seja mandar CNC 
[      4372]    57-2      			sort/e "F_TEF_TRANSACAO","TP_SITUACAO.F_TEF_TRANSACAO"
[      4373]    58-2      		endif
[      4374]    59-1      		message/hint "Aguarde. Aplicaçao TEF sendo executada."
[      4375]    60-1      		setocc "F_TEF_TRANSACAO", 1
[      4376]    61-2      		while ($status >= 0)
[      4377]    62-3      			if (TP_SITUACAO.F_TEF_TRANSACAO = 1) 
[      4378]              				;Transaçao autorizada sem cupom impresso
[      4379]    63-3      				$instancehandle->efetivaTEFPendenteGeral_NCN()
[      4380]    64-4      				if ($procerror)
[      4381]    65-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      4382]    66-4      				endif
[      4383]    67-3      			elseif (TP_SITUACAO.F_TEF_TRANSACAO = 2) 
[      4384]              				;Transação com cupom impresso e não confirmada
[      4385]    68-3      				$instancehandle->efetivaTEFPendenteGeral_CNF()
[      4386]    69-4      				if ($procerror)
[      4387]    70-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      4388]    71-4      				endif
[      4389]    72-3      			elseif (TP_SITUACAO.F_TEF_TRANSACAO = 4) & ($tpTEF$ = 2) 
[      4390]              				;Transação autorizada e sem cupom impresso SOMENTE PARA DISCADO
[      4391]    73-3      				viParams = ""
[      4392]    74-3      				putitem/id viParams, "000-000", "CNC"
[      4393]    75-3      				putitem/id viParams, "001-000", NR_SEQ.F_TEF_TRANSACAO
[      4394]    76-3      				$vlTEF$ = VL_TRANSACAO.F_TEF_TRANSACAO
[      4395]    77-3      				putitem/id viParams, "003-000", "%%$vlTEF$"
[      4396]    78-3      				putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4397]              				;$nrNSU$ = NR_NSU.F_TEF_TRANSACAO
[      4398]              				;ate então a VISA trabalha somente com 6 digitos na NSU
[      4399]    79-3      				$nrNSU6DIG$ = NR_NSU.F_TEF_TRANSACAO
[      4400]    80-3      				$dsNSU$ = "%%NR_NSU.F_TEF_TRANSACAO"	
[      4401]    81-3      				putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO;"%%$nrNSU$"
[      4402]              				;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO
[      4403]              				;if (NM_REDETEF.F_TEF_TRANSACAO = "VISANET")
[      4404]              				;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      4405]              				;endif
[      4406]    82-4      				if (NM_REDETEF.F_TEF_TRANSACAO = "TECBAN")
[      4407]    83-4      					putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      4408]    84-4      				endif
[      4409]    85-3      				$dtTEF$ = DT_TRANSACAO.F_TEF_TRANSACAO
[      4410]    86-3      				putitem/id viParams, "022-000", "%%$dtTEF$"
[      4411]    87-3      				$hrTEF$ = HR_TRANSACAO.F_TEF_TRANSACAO
[      4412]    88-3      				putitem/id viParams, "023-000", "%%$hrTEF$"
[      4413]    89-3      				putitem/id viParams, "999-999", "0"
[      4414]    90-3      				putitem/id viParams, "DS_EXTENSAO", "001"
[      4415]    91-3      				putitem/id viParams, "IN_P1", "T"
[      4416]    92-3      				activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4417]    93-4      				if ($procerror)    	   
[      4418]    94-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4419]    95-4      				elseif ($status >= 0)
[      4420]    96-4      					vDsConteudo = voParams
[      4421]    97-4      					vNrLinhaCupom = $item("028-000", vDsConteudo)
[      4422]    98-4      					vDsAprovado = $item("009-000", vDsConteudo)
[      4423]    99-4      					vDsMensagem = $item("030-000", vDsConteudo)
[      4424]   100-5      					if (vDsAprovado != "0");caso nao seja confirmado retorna a mensagem
[      4425]   101-5      						$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=%%vDsMensagem%%%!", "")   
[      4426]   102-5      						return(-1)     
[      4427]   103-5      					endif
[      4428]   104-4      				elseif($tpTEF$ = 2);Loop aguardando GP ATIVO 
[      4429]   105-4      					vInLoopConfirmacao = "F"
[      4430]   106-5      					repeat
[      4431]   107-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4432]   108-5      						message/hint "Aguardando comunicação..."	
[      4433]   109-5      						activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4434]   110-6      						if ($procerror)       
[      4435]   111-6      							$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4436]   112-6      						elseif ($status >= 0)
[      4437]   113-6      							vDsConteudo = voParams
[      4438]   114-6      							vNrLinhaCupom = $item("028-000", vDsConteudo)
[      4439]   115-6      							vDsAprovado = $item("009-000", vDsConteudo)
[      4440]   116-6      							vDsMensagem = $item("030-000", vDsConteudo)
[      4441]   117-7      							if (vDsAprovado != "0");caso nao seja confirmado retorna a mensagem
[      4442]   118-7      								$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=%%vDsMensagem%%%!", "")    
[      4443]   119-7      								return(-1)    
[      4444]   120-7      							endif
[      4445]   121-7      							if (vNrLinhaCupom > 0)
[      4446]   122-7      								vInLoopConfirmacao = "T"
[      4447]   123-7      							endif
[      4448]   124-6      						endif
[      4449]   125-5      						message/hint " "
[      4450]   126-5      					until (vInLoopConfirmacao = "T")
[      4451]   127-4      				endif
[      4453]   128-4      				if (vNrLinhaCupom > 0)
[      4454]   129-4      					viParams = ""
[      4455]   130-4      					putitem/id viParams, "NM_ENTIDADE", "TEF_TRANSACAO"
[      4456]   131-4      					activate "GERSVCO031".getNumSeq($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxerro$)
[      4457]   132-5      					if ($procerror)       
[      4458]   133-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4459]   134-5      						return(-1)
[      4460]   135-5      					elseif ($status < 0)
[      4461]   136-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4462]   137-5      						return(-1)
[      4463]   138-5      					endif
[      4464]   139-4      					vNrSequencia = $item("NR_SEQUENCIA", voParams)
[      4466]              					;grava o registro no TEF_TRANSACAO    
[      4467]   140-4      					viParams = vDsConteudo
[      4468]   141-4      					putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4469]   142-4      					putitem/id viParams, "000-000", "CNC"
[      4470]   143-4      					putitem/id viParams, "001-000", vNrSequencia
[      4471]   144-4      					$vlTEF$ = VL_TRANSACAO.F_TEF_TRANSACAO
[      4472]   145-4      					putitem/id viParams, "003-000", "%%$vlTEF$"
[      4473]   146-4      					putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4474]              					;-=CANONICO=- (20/08/2009) HOMOLOGACAO PAY GO, ao enviar a CNC o sistema deve gravar a NSU da CNC
[      4475]              					;putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO
[      4476]   147-4      					putitem/id viParams, "011-000", TP_TRANSACAO.F_TEF_TRANSACAO
[      4477]   148-4      					putitem/id viParams, "012-000", $item("012-000", vDsConteudo)
[      4478]   149-4      					putitem/id viParams, "022-000", $item("022-000", vDsConteudo)
[      4479]   150-4      					putitem/id viParams, "023-000", $item("023-000", vDsConteudo)
[      4480]   151-4      					putitem/id viParams, "027-000", $item("027-000", vDsConteudo)
[      4481]   152-4      					putitem/id viParams, "NR_NSUAUX", NR_NSU.F_TEF_TRANSACAO
[      4482]              					;
[      4483]   153-4      					putitem/id viParams, "TP_SITUACAO", 1
[      4484]   154-4      					newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4485]   155-4      					activate "TEFSVCO011".gravaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4486]   156-5      					if ($procerror)       
[      4487]   157-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4488]   158-5      						return(-1)
[      4489]   159-5      					elseif ($status < 0)
[      4490]   160-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4491]   161-5      						return(-1)
[      4492]   162-5      					endif
[      4493]   163-4      					vDsConteudo = $item("DS_CUPOM",voParams)
[      4494]   164-4      				endif
[      4496]              				;Imprime cupom TEF
[      4497]   165-4      				if (vNrLinhaCupom > 0)
[      4498]   166-4      					$instancehandle->efetivaTEFPendenteGeral_CNC(vDsMensagem,vDsConteudo,vNrSequencia)
[      4499]   167-5      					if ($procerror)
[      4500]   168-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[      4501]   169-5      					endif
[      4502]   170-4      				endif
[      4503]   171-3      			endif
[      4504]   172-2      			setocc "F_TEF_TRANSACAO", $curocc("F_TEF_TRANSACAO") + 1
[      4505]   173-2      		endwhile
[      4506]   174-1      	endif
[      4508]   175        	message/hint ""
[      4509]              	
[      4510]   176        	return(0)
[      4511]   177        end
[      4513]              ;------------------------------
[      4514]******        partner operation efetivaTEFPendenteGeral_NCN
[      4515]              ;------------------------------
[      4516]              	variables
[      4517]              		string viParams, voParams
[      4518]              		boolean vInLoopConfirmacao, vInLoopImpressao
[      4519]              	endvariables
[      4521]     1        	viParams = ""
[      4522]     2        	putitem/id viParams, "000-000", "NCN"
[      4523]     3        	putitem/id viParams, "001-000", NR_SEQ.F_TEF_TRANSACAO
[      4524]     4        	putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4525]              	;$nrNSU$ = NR_NSU.F_TEF_TRANSACAO
[      4526]              	;ate então a VISA trabalha somente com 6 digitos na NSU
[      4527]     5        	$nrNSU6DIG$ = NR_NSU.F_TEF_TRANSACAO
[      4528]     6        	$dsNSU$ = "%%NR_NSU.F_TEF_TRANSACAO"	
[      4529]     7        	putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO;"%%$nrNSU$"
[      4530]              	;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO
[      4531]              	;if (NM_REDETEF.F_TEF_TRANSACAO = "VISANET")
[      4532]              	;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      4533]              	;endif
[      4534]     8-1      	if (NM_REDETEF.F_TEF_TRANSACAO = "TECBAN")
[      4535]     9-1      		putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      4536]    10-1      	endif
[      4537]    11        	putitem/id viParams, "027-000", DS_FINALIZACAO.F_TEF_TRANSACAO
[      4538]    12        	putitem/id viParams, "999-999", "0"
[      4539]    13        	putitem/id viParams, "DS_EXTENSAO", "001"
[      4540]    14        	putitem/id viParams, "IN_P1", "F"
[      4541]    15-1      	if ($tpTEF$ = 2)
[      4542]    16-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4543]    17-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4544]    18-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.F_TEF_TRANSACAO
[      4545]    19-1      	endif
[      4546]    20        	activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4547]    21-1      	if ($procerror)       
[      4548]    22-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4549]    23-1      	elseif ($status >= 0)
[      4550]    24-1      		viParams = ""
[      4551]    25-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4552]    26-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4553]    27-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.F_TEF_TRANSACAO
[      4554]    28-1      		putitem/id viParams, "TP_SITUACAO", -1 ;Não foi possível imprimir o cupom
[      4555]    29-1      		newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4556]    30-1      		activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4557]    31-2      		if ($procerror)       
[      4558]    32-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4559]    33-2      		elseif ($status < 0)
[      4560]    34-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4561]    35-2      		endif
[      4562]    36-2      		if (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO = 0)
[      4563]    37-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO", "") 
[      4564]    38-2      		elseif (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO > 0)
[      4565]    39-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO", "") 
[      4566]    40-2      		else
[      4567]    41-3      			if ($tpTEF$ = 1)
[      4568]    42-3      				$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação não efetuada.%%^ Favor reter o cupom!", "") 			
[      4569]    43-3      			else
[      4570]    44-3      				$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO%%^Valor: %%VL_TRANSACAO.F_TEF_TRANSACAO", "") 
[      4571]    45-3      			endif
[      4572]    46-2      		endif
[      4573]    47-1      	elseif ($tpTEF$ = 2) ;somente TEF DISCADO - Loop aguardando GP ATIVO 
[      4574]    48-1      		vInLoopConfirmacao = "F"
[      4575]    49-2      		repeat
[      4576]    50-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4577]    51-2      			message/hint "Aguardando comunicação..."	
[      4578]    52-2      			activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4579]    53-3      			if ($procerror)       
[      4580]    54-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4581]    55-3      			elseif ($status >= 0)
[      4582]    56-3      				viParams = ""
[      4583]    57-3      				putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4584]    58-3      				putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4585]    59-3      				putitem/id viParams, "NR_SEQ", NR_SEQ.F_TEF_TRANSACAO
[      4586]    60-3      				putitem/id viParams, "TP_SITUACAO", -1 ;Não foi possível imprimir o cupom
[      4587]    61-3      				newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4588]    62-3      				activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4589]    63-4      				if ($procerror)       
[      4590]    64-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4591]    65-4      				elseif ($status < 0)
[      4592]    66-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4593]    67-4      				endif
[      4594]    68-4      				if (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO = 0)
[      4595]    69-4      					$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO", "") 
[      4596]    70-4      				elseif (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO > 0)
[      4597]    71-4      					$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO", "") 
[      4598]    72-4      				else
[      4599]    73-4      					$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO %%^Valor: %%VL_TRANSACAO.F_TEF_TRANSACAO", "") 
[      4600]    74-4      				endif
[      4601]    75-3      				vInLoopConfirmacao = "T"
[      4602]    76-3      			endif
[      4603]    77-2      			message/hint " "
[      4604]    78-2      		until (vInLoopConfirmacao = "T")
[      4605]    79-1      	elseif ($status < 0)
[      4606]    80-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4607]    81-1      	endif
[      4609]    82        	return(0)
[      4611]    83        end;efetivaTEFPendenteGeral_NCN
[      4613]              ;------------------------------
[      4614]******        partner operation efetivaTEFPendenteGeral_CNF
[      4615]              ;------------------------------
[      4616]              	variables
[      4617]              		string viParams, voParams
[      4618]              		boolean vInLoopConfirmacao, vInLoopImpressao
[      4619]              	endvariables
[      4621]     1        	viParams = ""
[      4622]     2        	putitem/id viParams, "000-000", "CNF"
[      4623]     3        	putitem/id viParams, "001-000", NR_SEQ.F_TEF_TRANSACAO
[      4624]     4        	putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4625]              	;$nrNSU$ = NR_NSU.F_TEF_TRANSACAO
[      4626]              	;ate então a VISA trabalha somente com 6 digitos na NSU
[      4627]     5        	$nrNSU6DIG$ = NR_NSU.F_TEF_TRANSACAO
[      4628]     6        	$dsNSU$ = "%%NR_NSU.F_TEF_TRANSACAO"		
[      4629]     7        	putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO;"%%$nrNSU$"
[      4630]              	;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO
[      4631]              	;if (NM_REDETEF.F_TEF_TRANSACAO = "VISANET")
[      4632]              	;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      4633]              	;endif
[      4634]     8-1      	if (NM_REDETEF.F_TEF_TRANSACAO = "TECBAN")
[      4635]     9-1      		putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      4636]    10-1      	endif
[      4637]    11        	putitem/id viParams, "027-000", DS_FINALIZACAO.F_TEF_TRANSACAO
[      4638]    12        	putitem/id viParams, "999-999", "0"
[      4639]    13        	putitem/id viParams, "DS_EXTENSAO", "001"
[      4640]    14        	putitem/id viParams, "IN_P1", "F"
[      4641]    15        	activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4642]    16-1      	if ($procerror)       
[      4643]    17-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4644]    18-1      	elseif ($status >= 0)
[      4645]    19-1      		viParams = ""
[      4646]    20-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4647]    21-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4648]    22-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.F_TEF_TRANSACAO
[      4649]    23-1      		putitem/id viParams, "TP_SITUACAO", 3 ;Transação confirmada
[      4650]    24-1      		newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4651]    25-1      		activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4652]    26-2      		if ($procerror)       
[      4653]    27-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4654]    28-2      		elseif ($status < 0)
[      4655]    29-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4656]    30-2      		endif
[      4657]    31-1      	elseif ($tpTEF$ = 2)
[      4658]    32-1      		vInLoopConfirmacao = "F"
[      4659]    33-2      		repeat
[      4660]    34-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4661]    35-2      			message/hint "Aguardando comunicação..."	
[      4662]    36-2      			activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4663]    37-3      			if ($procerror)       
[      4664]    38-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4665]    39-3      			elseif ($status >= 0)
[      4666]    40-3      				viParams = ""
[      4667]    41-3      				putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4668]    42-3      				putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4669]    43-3      				putitem/id viParams, "NR_SEQ", NR_SEQ.F_TEF_TRANSACAO
[      4670]    44-3      				putitem/id viParams, "TP_SITUACAO", 3 ;Transação confirmada
[      4671]    45-3      				newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4672]    46-3      				activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4673]    47-4      				if ($procerror)       
[      4674]    48-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4675]    49-4      				elseif ($status < 0)
[      4676]    50-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4677]    51-4      				endif
[      4678]    52-3      				vInLoopConfirmacao = "T"
[      4679]    53-3      			endif
[      4680]    54-2      			message/hint " "
[      4681]    55-2      		until (vInLoopConfirmacao = "T")			
[      4682]    56-1      	endif	
[      4684]    57        	return(0)
[      4685]    58        end;efetivaTEFPendenteGeral_CNF
[      4687]              ;------------------------------
[      4688]******        partner operation efetivaTEFPendenteGeral_CNC
[      4689]              ;------------------------------
[      4690]              	params
[      4691]              		string vDsMensagem : IN
[      4692]              		string vDsConteudo : IN
[      4693]              		numeric vNrSequencia : IN
[      4694]              	endparams
[      4695]              	variables
[      4696]              		string viParams, voParams, vDsLstCupom, vDsRegistro, vDsAprovado, vDsLstEmpresa
[      4697]              		boolean vInLoopConfirmacao, vInLoopImpressao
[      4698]              		numeric vNrLinhaCupom
[      4699]              	endvariables
[      4701]     1        	vDsLstCupom = ""
[      4702]     2        	vDsRegistro = ""
[      4703]     3        	putitem/id vDsRegistro, "DS_MENSAGEM", vDsMensagem
[      4704]     4        	putitem/id vDsRegistro, "DS_CUPOM", vDsConteudo
[      4705]     5        	putitem vDsLstCupom, -1, vDsRegistro
[      4706]     6        	viParams = ""
[      4707]     7        	putitem/id viParams, "DS_LSTCUPOM", vDsLstCupom
[      4708]     8        	putitem/id viParams, "DS_FORMAPGTO", ""
[      4709]     9        	putitem/id viParams, "TP_IMPRESSAO", 2 ;Relatório gerencial
[      4710]    10        	activate "TEFFP002".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      4711]    11-1      	if ($procerror)
[      4712]    12-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4713]    13-1      		return(-1)
[      4714]    14-1      	elseif ($status < 0)
[      4715]    15-1      		vInLoopImpressao = "T"
[      4716]    16-2      		repeat
[      4717]    17-2      			askmess "Impressora não responde! Tentar novamente?", "Sim, Não"	
[      4718]    18-3      			if ($status = 2) 
[      4719]    19-3      				viParams = ""
[      4720]              				;-=CANONICO=- (21/08/2009) Homologacao
[      4721]    20-3      				clear/e "TEF_TRANSACAO"
[      4722]    21-3      				CD_EMPRESA.TEF_TRANSACAO/init = CD_EMPRESA.F_TEF_TRANSACAO	
[      4723]    22-3      				DT_MOVIMENTO.TEF_TRANSACAO/init = DT_MOVIMENTO.F_TEF_TRANSACAO
[      4724]    23-3      				CD_ARQUIVO.TEF_TRANSACAO/init = "CNC"	
[      4725]    24-3      				TP_TRANSACAO.TEF_TRANSACAO/init = TP_TRANSACAO.F_TEF_TRANSACAO			
[      4726]    25-3      				NR_NSUAUX.TEF_TRANSACAO/init = NR_NSU.F_TEF_TRANSACAO 
[      4727]    26-3      				retrieve/e "TEF_TRANSACAO"	
[      4728]    27-4      				if ($status >= 0)
[      4729]    28-4      					putitem/id viParams, "000-000", "NCN"
[      4730]    29-4      					putitem/id viParams, "001-000", NR_SEQ.TEF_TRANSACAO
[      4731]    30-4      					putitem/id viParams, "010-000", NM_REDETEF.TEF_TRANSACAO
[      4732]    31-4      					putitem/id viParams, "012-000", NR_NSU.TEF_TRANSACAO
[      4733]    32-4      					putitem/id viParams, "027-000", DS_FINALIZACAO.TEF_TRANSACAO
[      4734]    33-4      				else
[      4735]    34-4      					putitem/id viParams, "000-000", "NCN"
[      4736]    35-4      					putitem/id viParams, "001-000", NR_SEQ.F_TEF_TRANSACAO
[      4737]    36-4      					putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4738]              					;$nrNSU$ = NR_NSU.TEF_TRANSACAO
[      4739]              					;ate então a VISA trabalha somente com 6 digitos na NSU
[      4740]    37-4      					$nrNSU6DIG$ = NR_NSU.F_TEF_TRANSACAO
[      4741]    38-4      					$dsNSU$ = "%%NR_NSU.F_TEF_TRANSACAO"
[      4742]    39-4      					putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO;"%%$nrNSU$"
[      4743]              					;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO	
[      4744]              					;if (NM_REDETEF.TEF_TRANSACAO = "VISANET")
[      4745]              					;    putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      4746]              					;endif
[      4747]    40-5      					if (NM_REDETEF.F_TEF_TRANSACAO = "TECBAN")
[      4748]    41-5      						putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      4749]    42-5      					endif
[      4750]    43-4      					putitem/id viParams, "027-000", DS_FINALIZACAO.F_TEF_TRANSACAO
[      4751]    44-4      				endif
[      4752]              	
[      4753]    45-3      			    putitem/id viParams, "999-999", "0"
[      4754]    46-3      			    putitem/id viParams, "DS_EXTENSAO", "001"
[      4755]    47-3      			    putitem/id viParams, "IN_P1", "F"
[      4756]    48-3      			    activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4757]    49-4      			    if ($procerror)       
[      4758]    50-4      				    $instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4759]    51-4      			    elseif ($status >= 0)
[      4760]    52-5      					if (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO = 0)
[      4761]    53-5      						$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO", "") 
[      4762]    54-5      					elseif (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO > 0)
[      4763]    55-5      						$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO", "") 
[      4764]    56-5      					else
[      4765]    57-5      						$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO %%^Valor: %%VL_TRANSACAO.F_TEF_TRANSACAO", "") 
[      4766]    58-5      					endif
[      4767]    59-4      			    elseif ($tpTEF$ = 2)
[      4768]    60-4      				    vInLoopConfirmacao = "F"
[      4769]    61-5      				    repeat
[      4770]    62-5      					     $instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4771]    63-5      					     message/hint "Aguardando comunicação..."	
[      4772]    64-5      					     activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4773]    65-6      					     if ($procerror)       
[      4774]    66-6      					         $instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4775]    67-6      					     elseif ($status >= 0)
[      4776]    68-7      						     if (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO = 0)
[      4777]    69-7      						         $instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO", "") 
[      4778]    70-7      	                         elseif (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO > 0)
[      4779]    71-7      		                         $instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO", "") 
[      4780]    72-7      	                         else
[      4781]    73-7      		                        $instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.F_TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.F_TEF_TRANSACAO %%^Valor: %%VL_TRANSACAO.F_TEF_TRANSACAO", "") 
[      4782]    74-7      	                         endif
[      4783]    75-6      		                     vInLoopConfirmacao = "T"
[      4784]    76-6      					     endif
[      4785]    77-5      					     message/hint " "
[      4786]    78-5      					until (vInLoopConfirmacao = "T")
[      4787]    79-4      				endif
[      4788]    80-3      			else
[      4789]    81-3      				viParams = ""
[      4790]    82-3      			    putitem/id viParams, "DS_LSTCUPOM", vDsLstCupom
[      4791]    83-3      				putitem/id viParams, "DS_FORMAPGTO", ""
[      4792]    84-3      				putitem/id viParams, "TP_IMPRESSAO", 2 ;Relatório gerencial
[      4793]    85-3      				activate "TEFFP002".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      4794]    86-4      				if ($procerror)       
[      4795]    87-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")                        
[      4796]    88-4      				endif
[      4797]    89-4      				if ($status >= 0)
[      4798]    90-4      					viParams = ""
[      4799]              					;-=CANONICO=- (21/08/2009) Homologacao
[      4800]    91-4      					clear/e "TEF_TRANSACAO"	
[      4801]    92-4      					CD_EMPRESA.TEF_TRANSACAO/init = CD_EMPRESA.F_TEF_TRANSACAO	
[      4802]    93-4      					DT_MOVIMENTO.TEF_TRANSACAO/init = DT_MOVIMENTO.F_TEF_TRANSACAO
[      4803]    94-4      					CD_ARQUIVO.TEF_TRANSACAO/init = "CNC"	
[      4804]    95-4      					TP_TRANSACAO.TEF_TRANSACAO/init = TP_TRANSACAO.F_TEF_TRANSACAO			
[      4805]    96-4      					NR_NSUAUX.TEF_TRANSACAO/init = NR_NSU.F_TEF_TRANSACAO 
[      4806]    97-4      					retrieve/e "TEF_TRANSACAO"	
[      4807]    98-5      					if ($status >= 0)
[      4808]    99-5      						putitem/id viParams, "000-000", "CNF"
[      4809]   100-5      						putitem/id viParams, "001-000", vNrSequencia
[      4810]   101-5      						putitem/id viParams, "010-000", NM_REDETEF.TEF_TRANSACAO
[      4811]   102-5      						putitem/id viParams, "012-000", NR_NSU.TEF_TRANSACAO
[      4812]   103-5      						putitem/id viParams, "027-000", DS_FINALIZACAO.TEF_TRANSACAO
[      4813]   104-5      					else
[      4815]   105-5      						putitem/id viParams, "000-000", "CNF"
[      4816]   106-5      						putitem/id viParams, "001-000", vNrSequencia
[      4817]   107-5      						putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4818]              						;$nrNSU$ = NR_NSU.TEF_TRANSACAO
[      4819]              						;ate então a VISA trabalha somente com 6 digitos na NSU
[      4820]   108-5      						$nrNSU6DIG$ = NR_NSU.F_TEF_TRANSACAO
[      4821]   109-5      						$dsNSU$ = "%%NR_NSU.F_TEF_TRANSACAO"		
[      4822]   110-5      						putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO;"%%$nrNSU$"
[      4823]              						;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO	
[      4824]              						;if (NM_REDETEF.TEF_TRANSACAO = "VISANET")
[      4825]              						;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      4826]              						;endif
[      4827]   111-6      						if (NM_REDETEF.F_TEF_TRANSACAO = "TECBAN")
[      4828]   112-6      							putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      4829]   113-6      						endif
[      4830]   114-5      						putitem/id viParams, "027-000", DS_FINALIZACAO.F_TEF_TRANSACAO
[      4831]   115-5      					endif
[      4832]   116-4      					putitem/id viParams, "999-999", "0"
[      4833]   117-4      					putitem/id viParams, "DS_EXTENSAO", "001"
[      4834]   118-4      					putitem/id viParams, "IN_P1", "F"
[      4835]   119-4      					activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4836]   120-5      					if ($procerror)       
[      4837]   121-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4838]   122-5      					elseif ($status >= 0)
[      4839]   123-5      					elseif ($tpTEF$ = 2)
[      4840]   124-5      						vInLoopConfirmacao = "F"
[      4841]   125-6      						repeat
[      4842]   126-6      							$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4843]   127-6      							message/hint "Aguardando comunicação..."	
[      4844]   128-6      							activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4845]   129-7      							if ($procerror)       
[      4846]   130-7      								$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4847]   131-7      							elseif ($status >= 0)
[      4848]   132-7      								vInLoopConfirmacao = "T"
[      4849]   133-7      							endif
[      4850]   134-6      							message/hint " "
[      4851]   135-6      						until (vInLoopConfirmacao = "T")
[      4852]   136-5      					endif
[      4853]              					;confirma o CNC gerado
[      4854]   137-4      					viParams = ""
[      4855]   138-4      					putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4856]   139-4      					putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4857]   140-4      					putitem/id viParams, "NR_SEQ", vNrSequencia
[      4858]   141-4      					putitem/id viParams, "TP_SITUACAO", 3 ;Transação confirmada
[      4859]   142-4      					newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4860]   143-4      					activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4861]   144-5      					if ($procerror)       
[      4862]   145-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4863]   146-5      					elseif ($status < 0)
[      4864]   147-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4865]   148-5      					endif
[      4867]              					;-=CANONICO=- (21/08/2009) Homologacao	
[      4868]   149-4      					clear/e "TEF_TRANSACAO"
[      4869]   150-4      					CD_EMPRESA.TEF_TRANSACAO/init = CD_EMPRESA.F_TEF_TRANSACAO	
[      4870]   151-4      					DT_MOVIMENTO.TEF_TRANSACAO/init = DT_MOVIMENTO.F_TEF_TRANSACAO
[      4871]   152-4      					CD_ARQUIVO.TEF_TRANSACAO/init = "CRT"	
[      4872]   153-4      					TP_TRANSACAO.TEF_TRANSACAO/init = TP_TRANSACAO.F_TEF_TRANSACAO			
[      4873]   154-4      					NR_NSU.TEF_TRANSACAO/init = NR_NSU.F_TEF_TRANSACAO 
[      4874]   155-4      					retrieve/e "TEF_TRANSACAO"	
[      4876]              					;altera o status da transação CRT para -1. Que outrora estava em pendência = 4
[      4877]   156-4      					viParams = ""
[      4878]   157-4      					putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TEF_TRANSACAO
[      4879]   158-4      					putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.TEF_TRANSACAO
[      4880]   159-4      					putitem/id viParams, "NR_SEQ", NR_SEQ.TEF_TRANSACAO
[      4881]   160-4      					putitem/id viParams, "TP_SITUACAO", -1 ;Não foi possível imprimir o cupom
[      4882]   161-4      					newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4883]   162-4      					activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4884]   163-5      					if ($procerror)       
[      4885]   164-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4886]   165-5      					elseif ($status < 0)
[      4887]   166-5      						$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4888]   167-5      					endif	
[      4889]   168-4      					vInLoopImpressao = "F"
[      4890]   169-4      				endif
[      4891]   170-3      			endif    
[      4892]   171-2      		until (vInLoopImpressao = "F")
[      4893]   172-1      	else
[      4895]              		;-=CANONICO=- (21/08/2009) Homologacao
[      4896]   173-1      		clear/e "TEF_TRANSACAO"	
[      4897]   174-1      		CD_EMPRESA.TEF_TRANSACAO/init = CD_EMPRESA.F_TEF_TRANSACAO	
[      4898]   175-1      		DT_MOVIMENTO.TEF_TRANSACAO/init = DT_MOVIMENTO.F_TEF_TRANSACAO
[      4899]   176-1      		CD_ARQUIVO.TEF_TRANSACAO/init = "CNC"	
[      4900]   177-1      		TP_TRANSACAO.TEF_TRANSACAO/init = TP_TRANSACAO.F_TEF_TRANSACAO
[      4901]   178-1      		TP_SITUACAO.TEF_TRANSACAO/init = 1			
[      4902]   179-1      		NR_NSUAUX.TEF_TRANSACAO/init = NR_NSU.F_TEF_TRANSACAO 
[      4903]   180-1      		retrieve/e "TEF_TRANSACAO"	
[      4904]   181-2      		if ($status >= 0)
[      4905]   182-2      			putitem/id viParams, "000-000", "CNF"
[      4906]   183-2      			putitem/id viParams, "001-000", vNrSequencia
[      4907]   184-2      			putitem/id viParams, "010-000", NM_REDETEF.TEF_TRANSACAO
[      4908]   185-2      			putitem/id viParams, "012-000", NR_NSU.TEF_TRANSACAO
[      4909]   186-2      			putitem/id viParams, "027-000", DS_FINALIZACAO.TEF_TRANSACAO
[      4910]   187-2      		else
[      4911]   188-2      			putitem/id viParams, "000-000", "CNF"
[      4912]   189-2      			putitem/id viParams, "001-000", vNrSequencia
[      4913]   190-2      			putitem/id viParams, "010-000", NM_REDETEF.F_TEF_TRANSACAO
[      4914]              			;$nrNSU$ = NR_NSU.TEF_TRANSACAO
[      4915]              			;ate então a VISA trabalha somente com 6 digitos na NSU
[      4916]   191-2      			$nrNSU6DIG$ = NR_NSU.F_TEF_TRANSACAO
[      4917]   192-2      			$dsNSU$ = "%%NR_NSU.F_TEF_TRANSACAO"		
[      4918]   193-2      			putitem/id viParams, "012-000", NR_NSU.F_TEF_TRANSACAO;"%%$nrNSU$"
[      4919]              			;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO	
[      4920]              			;if (NM_REDETEF.TEF_TRANSACAO = "VISANET")
[      4921]              			;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      4922]              			;endif
[      4923]   194-3      			if (NM_REDETEF.F_TEF_TRANSACAO = "TECBAN")
[      4924]   195-3      				putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      4925]   196-3      			endif
[      4926]   197-2      			putitem/id viParams, "027-000", DS_FINALIZACAO.F_TEF_TRANSACAO
[      4927]   198-2      		endif
[      4929]   199-1      		putitem/id viParams, "999-999", "0"
[      4930]   200-1      		putitem/id viParams, "DS_EXTENSAO", "001"
[      4931]   201-1      		putitem/id viParams, "IN_P1", "F"
[      4932]   202-1      		activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4933]   203-2      		if ($procerror)       
[      4934]   204-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4935]   205-2      		elseif ($status >= 0)
[      4936]   206-2      		elseif ($tpTEF$ = 2)
[      4937]   207-2      			vInLoopConfirmacao = "F"
[      4938]   208-3      			repeat
[      4939]   209-3      			    $instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4940]   210-3      			    message/hint "Aguardando comunicação..."	
[      4941]   211-3      			    activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4942]   212-4      			    if ($procerror)       
[      4943]   213-4      			        $instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      4944]   214-4      			    elseif ($status >= 0)
[      4945]   215-4      					vInLoopConfirmacao = "T"
[      4946]   216-4      				endif
[      4947]   217-3      				message/hint " "
[      4948]   218-3      			until (vInLoopConfirmacao = "T")
[      4949]   219-2      		endif
[      4950]              		;confirma o CNC gerado
[      4951]   220-1      		viParams = ""
[      4952]   221-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4953]   222-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4954]   223-1      		putitem/id viParams, "NR_SEQ", vNrSequencia
[      4955]   224-1      		putitem/id viParams, "TP_SITUACAO", 3 ;Transação confirmada
[      4956]   225-1      		newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4957]   226-1      		activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4958]   227-2      		if ($procerror)       
[      4959]   228-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4960]   229-2      		elseif ($status < 0)
[      4961]   230-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4962]   231-2      		endif
[      4963]              		;altera o status da transação CRT para -1. Que outrora estava em pendência = 4
[      4964]   232-1      		viParams = ""
[      4965]   233-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.F_TEF_TRANSACAO
[      4966]   234-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.F_TEF_TRANSACAO
[      4967]   235-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.F_TEF_TRANSACAO
[      4968]   236-1      		putitem/id viParams, "TP_SITUACAO", -1 ;Não foi possível imprimir o cupom
[      4969]   237-1      		newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      4970]   238-1      		activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      4971]   239-2      		if ($procerror)       
[      4972]   240-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      4973]   241-2      		elseif ($status < 0)
[      4974]   242-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      4975]   243-2      		endif
[      4976]   244-1      	endif 
[      4978]   245        	return(0)
[      4980]   246        end;efetivaTEFPendenteGeral_CNC
[      4982]              ;-----------------------------------
[      4983]******        partner operation efetivaTEFPendente_MSG
[      4984]              ;-----------------------------------
[      4985]              	params
[      4986]              		numeric vCdEmpresa : IN
[      4987]              		numeric vNrSeq : IN
[      4988]              		date vDtMovimento : IN
[      4989]              		numeric vlValor : IN
[      4990]              		string vDsRedeTef : IN
[      4991]              		numeric vCdOperador	: IN	
[      4992]              	endparams
[      4993]              	variables
[      4994]              		string viParams, voParams, vNmLogin
[      4995]              	endvariables
[      4997]     1        	clear/e "TEF_RELTRANSACAO"
[      4998]     2        	CD_EMPTEF.TEF_RELTRANSACAO/init = vCdEmpresa
[      4999]     3        	NR_SEQ.TEF_RELTRANSACAO/init = vNrSeq
[      5000]     4        	DT_MOVIMENTO.TEF_RELTRANSACAO/init = vDtMovimento
[      5001]     5        	retrieve/e "TEF_RELTRANSACAO"
[      5002]              	;if ($status >= 0)
[      5003]              	;	clear/e "TEF_TRANSACAO"
[      5004]              	;	CD_EMPRESA.TEF_TRANSACAO/init = CD_EMPTEF.TEF_RELTRANSACAO
[      5005]              	;	NR_SEQ.TEF_TRANSACAO/init = NR_SEQ.TEF_RELTRANSACAO
[      5006]              	;	DT_MOVIMENTO.TEF_TRANSACAO/init = DT_MOVIMENTO.TEF_RELTRANSACAO
[      5007]              	;	retrieve/e "TEF_TRANSACAO"
[      5008]              	;	if ($status >= 0)
[      5009]              	;		$instancehandle->efetua_NCN()
[      5010]              	;		if ($procerror)
[      5011]              	;			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5012]              	;			return(-1)
[      5013]              	;		elseif ($status < 0)
[      5014]              	;			return(-1)
[      5015]              	;		endif
[      5016]              	;	endif
[      5017]              	;endif
[      5018]              	
[      5019]     6        	clear/e "ADM_USUARIO"
[      5020]     7        	CD_USUARIO.ADM_USUARIO/init = vCdOperador
[      5021]     8        	retrieve/e "ADM_USUARIO"
[      5022]              	;--->MNT - Prj 094/1320 - 18/03/2010
[      5023]     9-1      	if (CD_USUARIO.ADM_USUARIO > 0)
[      5024]    10-1      		viParams = ""
[      5025]    11-1      		voParams = ""
[      5026]    12-1      		putitem/id viParams, "CD_USUARIO", CD_USUARIO.ADM_USUARIO
[      5027]    13-1      		activate "ADMSVCO027".validaUsuarioEspecial($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)	
[      5028]    14-2      		if ($procerror)
[      5029]    15-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5030]    16-2      			return(-1)
[      5031]    17-2      		elseif ($status < 0)
[      5032]    18-2      			$instancehandle->SetStatus("",$xCdErro$, $xCtxErro$, "")
[      5033]    19-2      			return(-1)
[      5034]    20-2      		endif
[      5036]    21-2      		if(voParams != "")
[      5037]    22-2      			vNmLogin = $item("NM_LOGIN", voParams)
[      5038]    23-2      		endif
[      5039]    24-1      	else
[      5040]    25-1      		vNmLogin = ""
[      5041]    26-1      	endif
[      5042]              	;<---
[      5043]              	;foi incluso esta logica, pois na delfiori estava cancelando transações...
[      5044]              	;com essa logica é a Supervisora de caixa que irá determinar o que vai ser feito durante a venda do TEF
[      5045]              	;somente executa essa logica se o parametro $inUltimaPgtoCartaoTEF$ de não homologação estiver setado
[      5046]    27        	message/info "Transacao %%NR_TRANSACAO.TEF_RELTRANSACAO da Empresa %%CD_EMPTRA.TEF_RELTRANSACAO no Valor de %%vlValor da rede %%vDsRedeTef efetuada pelo usuario %%vNmLogin esta pendente na operadora."
[      5047]              	
[      5048]    28        	return(-1)
[      5049]    29        end
[      5053]              ;------------------------
[      5054]******        partner operation efetua_NCN 
[      5055]              	;------------------------
[      5056]              	variables
[      5057]              		string viParams, voParams
[      5058]              		boolean vInLoopConfirmacao, vInLoopImpressao
[      5059]              	endvariables
[      5061]     1        	viParams = ""
[      5062]     2        	putitem/id viParams, "000-000", "NCN"
[      5063]     3        	putitem/id viParams, "001-000", NR_SEQ.TEF_TRANSACAO
[      5064]     4        	putitem/id viParams, "010-000", NM_REDETEF.TEF_TRANSACAO
[      5065]              	;$nrNSU$ = NR_NSU.F_TEF_TRANSACAO
[      5066]              	;ate então a VISA trabalha somente com 6 digitos na NSU
[      5067]     5        	$nrNSU6DIG$ = NR_NSU.TEF_TRANSACAO
[      5068]     6        	$dsNSU$ = "%%NR_NSU.TEF_TRANSACAO"	
[      5069]     7        	putitem/id viParams, "012-000", NR_NSU.TEF_TRANSACAO;"%%$nrNSU$"
[      5070]              	;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO
[      5071]              	;if (NM_REDETEF.TEF_TRANSACAO = "VISANET")
[      5072]              	;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      5073]              	;endif
[      5074]     8-1      	if (NM_REDETEF.TEF_TRANSACAO = "TECBAN")
[      5075]     9-1      		putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      5076]    10-1      	endif
[      5077]    11        	putitem/id viParams, "027-000", DS_FINALIZACAO.TEF_TRANSACAO
[      5078]    12        	putitem/id viParams, "999-999", "0"
[      5079]    13        	putitem/id viParams, "DS_EXTENSAO", "001"
[      5080]    14        	putitem/id viParams, "IN_P1", "F"
[      5081]    15-1      	if ($tpTEF$ = 2)
[      5082]    16-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TEF_TRANSACAO
[      5083]    17-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.TEF_TRANSACAO
[      5084]    18-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.TEF_TRANSACAO
[      5085]    19-1      	endif
[      5086]    20        	activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5087]    21-1      	if ($procerror)       
[      5088]    22-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      5089]    23-1      	elseif ($status >= 0)
[      5090]    24-1      		viParams = ""
[      5091]    25-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TEF_TRANSACAO
[      5092]    26-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.TEF_TRANSACAO
[      5093]    27-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.TEF_TRANSACAO
[      5094]    28-1      		putitem/id viParams, "TP_SITUACAO", -1 ;Não foi possível imprimir o cupom
[      5095]    29-1      		newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      5096]    30-1      		activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5097]    31-2      		if ($procerror)       
[      5098]    32-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5099]    33-2      		elseif ($status < 0)
[      5100]    34-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5101]    35-2      		endif
[      5102]    36-2      		if (VL_TRANSACAO.TEF_TRANSACAO = 0 & NR_NSU.TEF_TRANSACAO = 0)
[      5103]    37-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.TEF_TRANSACAO", "") 
[      5104]    38-2      		elseif (VL_TRANSACAO.TEF_TRANSACAO = 0 & NR_NSU.TEF_TRANSACAO > 0)
[      5105]    39-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.TEF_TRANSACAO", "") 
[      5106]    40-2      		else
[      5107]    41-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.TEF_TRANSACAO%%^Valor: %%VL_TRANSACAO.TEF_TRANSACAO", "") 
[      5108]    42-2      		endif
[      5109]    43-1      	elseif ($tpTEF$ = 2) ;somente TEF DISCADO - Loop aguardando GP ATIVO 
[      5110]    44-1      		vInLoopConfirmacao = "F"
[      5111]    45-2      		repeat
[      5112]    46-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5113]    47-2      			message/hint "Aguardando comunicação..."	
[      5114]    48-2      			activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5115]    49-3      			if ($procerror)       
[      5116]    50-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      5117]    51-3      			elseif ($status >= 0)
[      5118]    52-3      				viParams = ""
[      5119]    53-3      				putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TEF_TRANSACAO
[      5120]    54-3      				putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.TEF_TRANSACAO
[      5121]    55-3      				putitem/id viParams, "NR_SEQ", NR_SEQ.TEF_TRANSACAO
[      5122]    56-3      				putitem/id viParams, "TP_SITUACAO", -1 ;Não foi possível imprimir o cupom
[      5123]    57-3      				newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      5124]    58-3      				activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5125]    59-4      				if ($procerror)       
[      5126]    60-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5127]    61-4      				elseif ($status < 0)
[      5128]    62-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5129]    63-4      				endif
[      5130]    64-4      				if (VL_TRANSACAO.TEF_TRANSACAO = 0 & NR_NSU.TEF_TRANSACAO = 0)
[      5131]    65-4      					$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.TEF_TRANSACAO", "") 
[      5132]    66-4      				elseif (VL_TRANSACAO.F_TEF_TRANSACAO = 0 & NR_NSU.F_TEF_TRANSACAO > 0)
[      5133]    67-4      					$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.TEF_TRANSACAO", "") 
[      5134]    68-4      				else
[      5135]    69-4      					$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Cancelada transação: %%^Rede: %%NM_REDETEF.TEF_TRANSACAO %%^Doc. Nr.: %%NR_NSU.TEF_TRANSACAO%%^Valor: %%VL_TRANSACAO.TEF_TRANSACAO", "") 
[      5136]    70-4      				endif
[      5137]    71-3      				vInLoopConfirmacao = "T"
[      5138]    72-3      			endif
[      5139]    73-2      			message/hint " "
[      5140]    74-2      		until (vInLoopConfirmacao = "T")
[      5141]    75-1      	endif
[      5143]    76        	return(0)
[      5144]    77        End ; operation efetua_NCN
[      5146]              ;------------------------
[      5147]******        partner operation efetua_CNF 
[      5148]              	;------------------------
[      5149]              	variables
[      5150]              		string viParams, voParams
[      5151]              		boolean vInLoopConfirmacao, vInLoopImpressao
[      5152]              	endvariables
[      5154]     1        	viParams = ""
[      5155]     2        	putitem/id viParams, "000-000", "CNF"
[      5156]     3        	putitem/id viParams, "001-000", NR_SEQ.TEF_TRANSACAO
[      5157]     4        	putitem/id viParams, "010-000", NM_REDETEF.TEF_TRANSACAO
[      5158]              	;$nrNSU$ = NR_NSU.TEF_TRANSACAO
[      5159]              	;ate então a VISA trabalha somente com 6 digitos na NSU
[      5160]     5        	$nrNSU6DIG$ = NR_NSU.TEF_TRANSACAO
[      5161]     6        	$dsNSU$ = "%%NR_NSU.TEF_TRANSACAO"	
[      5162]     7        	putitem/id viParams, "012-000", NR_NSU.TEF_TRANSACAO;"%%$nrNSU$"
[      5163]              	;-=CANONICO=- (17/08/2009) HOMOLOGACAO PAY-GO
[      5164]              	;if (NM_REDETEF.TEF_TRANSACAO = "VISANET")
[      5165]              	;	putitem/id viParams, "012-000", "%%$nrNSU6DIG$"
[      5166]              	;endif
[      5167]     8-1      	if (NM_REDETEF.TEF_TRANSACAO = "TECBAN")
[      5168]     9-1      		putitem/id viParams, "012-000", "%%$dsNSU$[1:6]"
[      5169]    10-1      	endif
[      5170]    11        	putitem/id viParams, "027-000", DS_FINALIZACAO.TEF_TRANSACAO
[      5171]    12        	putitem/id viParams, "999-999", "0"
[      5172]    13        	putitem/id viParams, "DS_EXTENSAO", "001"
[      5173]    14        	putitem/id viParams, "IN_P1", "F"
[      5174]    15        	activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5175]    16-1      	if ($procerror)       
[      5176]    17-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      5177]    18-1      	elseif ($status >= 0)
[      5178]    19-1      		viParams = ""
[      5179]    20-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TEF_TRANSACAO
[      5180]    21-1      		putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.TEF_TRANSACAO
[      5181]    22-1      		putitem/id viParams, "NR_SEQ", NR_SEQ.TEF_TRANSACAO
[      5182]    23-1      		putitem/id viParams, "TP_SITUACAO", 3 ;Transação confirmada
[      5183]    24-1      		newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      5184]    25-1      		activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5185]    26-2      		if ($procerror)       
[      5186]    27-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5187]    28-2      		elseif ($status < 0)
[      5188]    29-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5189]    30-2      		endif
[      5190]    31-1      	elseif ($tpTEF$ = 2)
[      5191]    32-1      		vInLoopConfirmacao = "F"
[      5192]    33-2      		repeat
[      5193]    34-2      			$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5194]    35-2      			message/hint "Aguardando comunicação..."	
[      5195]    36-2      			activate "TEFSVCO010".geraArquivoREQ($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5196]    37-3      			if ($procerror)       
[      5197]    38-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")				
[      5198]    39-3      			elseif ($status >= 0)
[      5199]    40-3      				viParams = ""
[      5200]    41-3      				putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TEF_TRANSACAO
[      5201]    42-3      				putitem/id viParams, "DT_MOVIMENTO", DT_MOVIMENTO.TEF_TRANSACAO
[      5202]    43-3      				putitem/id viParams, "NR_SEQ", NR_SEQ.TEF_TRANSACAO
[      5203]    44-3      				putitem/id viParams, "TP_SITUACAO", 3 ;Transação confirmada
[      5204]    45-3      				newinstance "TEFSVCO011", "TEFSVCO011", "TRANSACTION=TRUE"
[      5205]    46-3      				activate "TEFSVCO011".alteraSituacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5206]    47-4      				if ($procerror)       
[      5207]    48-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5208]    49-4      				elseif ($status < 0)
[      5209]    50-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5210]    51-4      				endif
[      5211]    52-3      				vInLoopConfirmacao = "T"
[      5212]    53-3      			endif
[      5213]    54-2      			message/hint " "
[      5214]    55-2      		until (vInLoopConfirmacao = "T")			
[      5215]    56-1      	endif	
[      5217]    57        	return(0)
[      5218]    58        end
[      5220]              ;------------------------------
[      5221]******        partner operation bonusDesconto
[      5222]              ;------------------------------
[      5223]              	variables
[      5224]              		numeric vTpBonus, vVlBonus
[      5225]              		string viParams, voParams
[      5226]              	endvariables
[      5227]              	
[      5228]     1        	vTpBonus = $item("TP_BONUS_DESCONTO", $xlplemp$)
[      5229]              	
[      5230]     2-1      	if (vTpBonus != 1)
[      5231]     3-1      		return(0)
[      5232]     4-1      	endif
[      5234]              	;* Claudemir - Prj/Tarefa: 180/101 - 14/03/2011
[      5235]              	;clear/e "PES_BONUS"
[      5236]              	;CD_EMPRESA.PES_BONUS/init = CD_EMPRESA.TRA_TRANSACAO
[      5237]              	;CD_PESSOA.PES_BONUS/init = CD_PESSOA.TRA_TRANSACAO
[      5238]              	;TP_BONUS.PES_BONUS/init = vTpBonus
[      5239]              	;retrieve/e "PES_BONUS"
[      5240]              	;if ($status < 0) | (VL_BONUS.PES_BONUS <= 0)
[      5241]              	;	return(0)
[      5242]              	;endif
[      5244]     5        	viParams = ""
[      5245]     6        	putitem/id viParams, "CD_PESSOA", CD_PESSOA.TRA_TRANSACAO
[      5246]     7        	activate "PESSVCO035".buscaSaldoBonus($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5247]     8-1      	if ($procerror)       
[      5248]     9-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5249]    10-1      		return(-1)
[      5250]    11-1      	elseif ($status < 0)
[      5251]    12-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5252]    13-1      		return(-1)
[      5253]    14-1      	endif
[      5255]    15        	vVlBonus = $item("VL_BONUS", voParams)
[      5257]    16-1      	if (vVlBonus <= 0)
[      5258]    17-1      		return(0)
[      5259]    18-1      	endif	 ;*
[      5260]              	
[      5261]    19        	viParams = ""
[      5262]    20        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      5263]    21        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      5264]    22        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      5265]    23        	$keyboard = "KB_GLOBAL"
[      5266]    24        	activate "TRAFP060".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      5267]    25        	$keyboard = "KB_PDV"
[      5268]    26-1      	if ($procerror)       
[      5269]    27-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5270]    28-1      		return(-1)
[      5271]    29-1      	elseif ($status < 0)
[      5272]    30-1      		return(-1) 
[      5273]    31-1      	endif
[      5274]              	
[      5275]    32        	return(0)
[      5276]    33        end
[      5278]              ;----------------------------
[      5279]******        partner operation mostraTotal
[      5280]              ;----------------------------
[      5281]              	variables
[      5282]              		numeric vNrOcc, vTpValidacaoConf
[      5283]              	endvariables
[      5284]              	
[      5285]     1        	vTpValidacaoConf = $item("TP_VALIDACAO_CONF_TRA", $xlplemp$)
[      5286]              	
[      5287]     2-1      	if ($empty("TRA_TRANSITEM") = 0)
[      5288]     3-1      		vNrOcc = $curocc("TRA_TRANSITEM")
[      5289]     4-1      		setocc "TRA_TRANSITEM", 1
[      5290]     5-2      		while ($status >= 0)
[      5291]     6-3      			if ($inMostraTotal$ = "T")
[      5292]     7-3      				fieldsyntax NR_ITEM.TRA_TRANSITEM, "HID"
[      5293]     8-3      			else
[      5294]     9-3      				fieldsyntax NR_ITEM.TRA_TRANSITEM, ""
[      5295]    10-3      			endif
[      5296]    11-2      			setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[      5297]    12-2      		endwhile
[      5298]    13-1      		setocc "TRA_TRANSITEM", vNrOcc
[      5299]    14-1      	endif
[      5300]              	
[      5302]    15-1      	if ($inMostraTotal$ = "T")
[      5303]    16-1      		$inMostraTotal$ = "F"
[      5304]    17-1      		BT_MOSTRATOTAL.TRA_TRANSACAO/init = "Mostrar %total"
[      5305]    18-1      		fieldsyntax BT_NRITEM.SIS_BOTOES2, "HID"		
[      5306]    19-1      		fieldsyntax QT_SOLICITADA.TRA_TRANSACAO, "HID"
[      5307]    20-1      		fieldsyntax VL_TRANSACAO.TRA_TRANSACAO, "HID"
[      5308]    21-1      	else
[      5309]    22-1      		$inMostraTotal$ = "T"
[      5310]    23-1      		BT_MOSTRATOTAL.TRA_TRANSACAO/init = "Omitir %total"
[      5311]    24-1      		fieldsyntax BT_NRITEM.SIS_BOTOES2, ""
[      5312]    25-1      		fieldsyntax NR_ITEM.TRA_TRANSITEM, ""
[      5313]    26-2      		if (vTpValidacaoConf = 2) | (vTpValidacaoConf = 3)
[      5314]    27-2      			fieldsyntax QT_SOLICITADA.TRA_TRANSACAO, "HID"
[      5315]    28-2      		else
[      5316]    29-2      			fieldsyntax QT_SOLICITADA.TRA_TRANSACAO, ""
[      5317]    30-2      		endif
[      5318]    31-1      		fieldsyntax VL_TRANSACAO.TRA_TRANSACAO, ""
[      5319]    32-1      	endif
[      5320]              	
[      5321]    33        	$prompt = CD_PRODUTO.TRA_TRANSITEM
[      5322]              	
[      5323]    34        	return(0)
[      5324]    35        end
[      5326]              ;Tarefa 102-939 Hugo em 14/09/2010
[      5327]              ;--------------------------------------
[      5328]******        partner operation validaItemCoeficiente
[      5329]              ;--------------------------------------
[      5330]              	params
[      5331]              		numeric piCdProduto : IN
[      5332]              		numeric pioVlProduto : INOUT
[      5333]              		numeric poQtSolicitada : INOUT
[      5334]              	endparams
[      5335]              	
[      5336]              	variables
[      5337]              		string viParams, voParams
[      5338]              		numeric vTpLote
[      5339]              	endvariables
[      5341]     1-1      	if (piCdProduto = 0)
[      5342]     2-1      		return(0)
[      5343]     3-1      	endif
[      5345]     4        	clear/e "PRD_EMBALAGEM"
[      5346]     5        	CD_PRODUTO.PRD_EMBALAGEM/init = piCdProduto
[      5347]     6        	retrieve/e "PRD_EMBALAGEM"
[      5348]     7-1      	if ($status < 0)
[      5349]     8-1      		return(0)
[      5350]     9-1      	endif
[      5352]    10        	viParams = ""
[      5353]    11        	putitem/id viParams, "CD_PRODUTO", piCdProduto
[      5354]    12        	putitem/id viParams, "VL_PRODUTO", pioVlProduto
[      5355]    13        	putitem/id viParams, "IN_CODIGO", IN_CODIGO.SIS_FILTRO
[      5356]    14        	putitem/id viParams, "CD_BARRAPRD", CD_BARRAPRD.SIS_FILTRO
[      5357]    15        	$keyboard = "KB_GLOBAL"
[      5358]    16        	activate "PRDFP051".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[      5359]    17        	$keyboard = "KB_PDV"
[      5360]    18-1      	if ($procerror)
[      5361]    19-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5362]    20-1      		return (-1)
[      5363]    21-1      	elseif ($status < 0)
[      5364]    22-1      		return(-1)
[      5365]    23-1      	endif
[      5367]    24        	pioVlProduto = $item("VL_UNITARIO", voParams)
[      5368]    25        	poQtSolicitada = $item("QT_EMBALAGEM", voParams)
[      5370]    26        	return(0)
[      5371]    27        end
[      5373]              ;--------------------------------
[      5374]******        partner operation excluiSimulacao
[      5375]              ;--------------------------------
[      5376]              ;Hugo em 30/12/2010 Tarefa 156-494
[      5377]              	variables
[      5378]              		string viParams, voParams
[      5379]              	endvariables
[      5380]              	
[      5381]     1        	viParams = ""
[      5382]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[      5383]     3        	putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[      5384]     4        	putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[      5385]     5        	activate "TRASVCO017".excluiSimulacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5386]     6-1      	if ($procerror)       
[      5387]     7-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5388]     8-1      		return(-1)
[      5389]     9-1      	elseif ($status < 0)
[      5390]    10-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5391]    11-1      		return(-1)
[      5392]    12-1      	endif
[      5393]              	
[      5394]    13        	commit
[      5395]    14-1      	if ($status < 0)
[      5396]    15-1      		rollback
[      5397]    16-1      		return (-1) 
[      5398]    17-1      	else
[      5399]    18-1      		$instancehandle->SetHint("ID=APLINFO002")
[      5400]    19-1      	endif
[      5401]              	
[      5402]    20        	$instancehandle->recarregaTransacao()
[      5403]    21-1      	if ($procerror)
[      5404]    22-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5405]    23-1      	endif
[      5406]              	
[      5407]    24        	return(0)
[      5408]    25        end
[      5411]              ;------------------------;-=CANONICO=- TAR 570 PRJ 156 (10/05/2011) "Inclusao do Portal RFID"
[      5412]******        partner operation portal
[      5413]              ;------------------------------
[      5415]              	variables
[      5416]              		string viParams, voParams, vDsLstProduto
[      5417]              	endvariables
[      5418]              	
[      5419]     1        	viParams = ""
[      5420]     2        	putitem/id viParams, "IN_QUANTIDADEFIXO", "T" ;-=CANONICO=- TAR 663 PRJ 156 (18/11/2011) - Informa para o serviço que os produtos do RFID serão apenas 1, desta forma quando tem kit não é feito a multiplicacao. 
[      5421]     3        	putitem/id viParams, "IN_SOMENTELEITURA", "F"
[      5422]     4        	$keyboard = "KB_GLOBAL"
[      5423]     5        	activate "GERFP042".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$);
[      5424]     6        	$keyboard = "KB_PDV"
[      5425]     7-1      	if ($procerror)
[      5426]     8-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5427]     9-1      		return (-1)
[      5428]    10-1      	elseif ($status < 0)
[      5429]    11-1      		return(-1)
[      5430]    12-1      	endif
[      5432]    13        	vDsLstProduto = $item("DS_LSTPRODUTO", voParams)
[      5434]    14-1      	if (vDsLstProduto != "")
[      5435]    15-1      		$instancehandle->entradaColetor(vDsLstProduto)
[      5436]    16-2      		if ($procerror)
[      5437]    17-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5438]    18-2      			return (-1)
[      5439]    19-2      		endif
[      5441]    20-2      		if ($dbocc("TRA_TRANSACAO"))
[      5442]    21-2      			$instancehandle->recarregaTransacao()
[      5443]    22-3      			if ($procerror)
[      5444]    23-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5445]    24-3      				return (-1)
[      5446]    25-3      			endif	
[      5447]    26-2      		endif
[      5448]    27-1      	endif
[      5450]    28        	return (0)
[      5451]    29        end; operation portal
[      5453]              ;* Claudemir - Prj/Tarefa: 191/2 - 07/10/2011
[      5454]              ; verifica se existe transações em andamento para esse usuário na empresa logada
[      5455]              ; se existir, será feito o cancelamento
[      5456]              ;-----------------------------------------
[      5457]******        partner operation verificaTransacaoAberta
[      5458]              ;----------------------------------------
[      5459]              	variables
[      5460]              		string viParams, voParams
[      5461]              	endvariables
[      5463]     1        	clear/e "F_TRA_TRANSACAO"
[      5464]     2        	CD_EMPRESA.F_TRA_TRANSACAO/init	= $item("CD_EMPRESA", $$gParamGlb)
[      5465]     3        	CD_OPERADOR.F_TRA_TRANSACAO/init	= $item("CD_USUARIO", $$gParamGlb)
[      5466]     4        	DT_TRANSACAO.F_TRA_TRANSACAO/init	= $item("DT_SISTEMA", $$gParamGlb)
[      5467]     5        	TP_SITUACAO.F_TRA_TRANSACAO/init	= 1 ; em andamento
[      5468]     6        	TP_OPERACAO.F_TRA_TRANSACAO/init	= "S" ; em andamento
[      5469]     7        	CD_OPERACAO.F_TRA_TRANSACAO/init	= $cdOperacaoVenda$
[      5470]     8        	retrieve/e "F_TRA_TRANSACAO"
[      5471]     9-1      	if ($status >= 0)
[      5472]    10-1      		setocc "F_TRA_TRANSACAO", 1
[      5473]    11-2      		while ($status > 0)
[      5475]    12-2      			$instancehandle->setDisplay("Aguarde, cancelando transação: %%NR_TRANSACAO.F_TRA_TRANSACAO", "", "")
[      5476]    13-3      			if ($procerror)
[      5477]    14-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5478]    15-3      			endif
[      5480]    16-2      			viParams	= ""
[      5481]    17-2      			putitem/id viParams, "CD_EMPRESA",		CD_EMPRESA.F_TRA_TRANSACAO
[      5482]    18-2      			putitem/id viParams, "NR_TRANSACAO",	NR_TRANSACAO.F_TRA_TRANSACAO
[      5483]    19-2      			putitem/id viParams, "DT_TRANSACAO",	DT_TRANSACAO.F_TRA_TRANSACAO
[      5484]    20-2      			putitem/id viParams, "DS_MOTIVO",		"CANCELAMENTO AUTOMATICO DE TRANSACAO DO USUARIO"
[      5485]    21-2      			putitem/id viParams, "TP_SITUACAONF",	"C"
[      5486]    22-2      			putitem/id viParams, "IN_PEDIDO",		"F"
[      5487]    23-2      			putitem/id viParams, "TP_QUANTIDADEPED", "S"
[      5488]    24-2      			putitem/id viParams, "CD_CONFERENTE",	$item("CD_USUARIO", $$gParamGlb)
[      5489]    25-2      			putitem/id viParams, "CD_COMPONENTE",	$componentname    
[      5490]    26-2      			activate "TRASVCO013".cancelaTransacao($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[      5491]    27-3      			if ($procerror)       
[      5492]    28-3      				$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[      5493]    29-3      				rollback
[      5494]    30-3      				return(-1)
[      5495]    31-3      			elseif ($status < 0)
[      5496]    32-3      				$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[      5497]    33-3      				rollback
[      5498]    34-3      				return(-1)
[      5499]    35-3      			endif
[      5501]    36-2      			setocc "F_TRA_TRANSACAO", $curocc("F_TRA_TRANSACAO") + 1
[      5502]    37-2      		endwhile
[      5504]    38-1      		commit	
[      5505]    39-2      		if ($status < 0)
[      5506]    40-2      			rollback
[      5507]    41-2      		endif
[      5508]    42-1      	endif
[      5510]    43        	return(0)
[      5512]    44        end; verificaTransacaoAberta  ;*

Trigger <DTLE> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_TRANSACAO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_TRANSACAO"))
[I1:      2]     2-1      	$occhandle("TRA_TRANSACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_TRANSACAO")->PrcOGF()

Trigger <RMO > from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_TRANSACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_TRANSACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_TRANSACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_TRANSACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_TRANSACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_TRANSACAO = "")
[I2:      4]    18-1            cd_operador.TRA_TRANSACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_TRANSACAO/init = $datim
[I1:      3]    21        $occhandle("TRA_TRANSACAO")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->VLDK_01()
[         2]     2-1      if ($procerror)
[         3]     3-1          $instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      else
[         6]     5-1      endif

Trigger <EOOP> from Entity: TRA_TRANSACAO.TRA

[         1]              ;------------------------
[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              	;------------------------
[         4]              	;if ($dbocc(TRA_TRANSACAO))
[         5]              	
[         6]              	;else
[         7]              	
[         8]              	;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              	variables
[        15]              		string viParams, voParams, vDsSituacao, vDsRegTroca
[        16]              		numeric vTpValidacaoConf, vNrOcc, vTpVariacao
[        17]              		boolean vInResimula
[        18]              	endvariables
[        20]     1        	vTpValidacaoConf = $item("TP_VALIDACAO_CONF_TRA", $xlplemp$)
[        21]     2        	vInResimula = $item("IN_RESIMULACAO_FAT", $xlplemp$) ;Hugo em 30/12/2010 Tarefa 156-494
[        22]              	
[        23]     3        	DS_TERMINAL.TRA_TRANSACAO/init = $dsTerminal$
[        24]     4        	DS_CAIXA.TRA_TRANSACAO/init = $dsCaixa$
[        25]     5        	DS_CONFERENTE.TRA_TRANSACAO/init = $dsConferente$
[        26]     6        	$cdTabPreco$ = ""
[        27]              	
[        28]     7-1      	if ($dbocc(TRA_TRANSACAO))
[        29]              		;---Elia Proj. 102/85 27/06/07
[        30]     8-1      		clear/e "TRA_LIBERACAO"
[        31]     9-1      		CD_EMPRESA.TRA_LIBERACAO/init = CD_EMPRESA.TRA_TRANSACAO
[        32]    10-1      		NR_TRANSACAO.TRA_LIBERACAO/init = NR_TRANSACAO.TRA_TRANSACAO
[        33]    11-1      		DT_TRANSACAO.TRA_LIBERACAO/init = DT_TRANSACAO.TRA_TRANSACAO
[        34]    12-1      		retrieve/e "TRA_LIBERACAO"
[        35]    13-2      		if ($status >= 0)
[        36]    14-2      			$instancehandle->SetStatus(2, "GEN0001", "DESCRICAO=Transação %%NR_TRANSACAO.TRA_TRANSACAO foi desbloqueada, só poderá ser alterada pelo TRAFP005!", "")
[        37]    15-2      			macro "^CLEAR"
[        38]    16-2      			return(-1)
[        39]    17-2      		endif
[        40]              		;
[        41]    18-1      		clear/e "TRA_TRANSCONDPGTOH"
[        42]    19-1      		CD_EMPRESA.TRA_TRANSCONDPGTOH = CD_EMPRESA.TRA_TRANSACAO
[        43]    20-1      		NR_TRANSACAO.TRA_TRANSCONDPGTOH = NR_TRANSACAO.TRA_TRANSACAO
[        44]    21-1      		DT_TRANSACAO.TRA_TRANSCONDPGTOH = DT_TRANSACAO.TRA_TRANSACAO
[        45]    22-1      		retrieve/e "TRA_TRANSCONDPGTOH"
[        46]    23-2      		if ($status >= 0)
[        47]    24-3      			if (vInResimula = "T") ;Hugo em 23/03/11 Tarefa 156-547
[        48]              			;Hugo em 30/12/2010 Tarefa 156-494
[        49]              			;if (vInResimula = "T") & ($inSimuladorCondPgto$ != "T") ;Hugo em 24/01/11 Tarefa 156-502
[        50]    25-3      				askmess/question "Existe uma simulação de venda para a transação!%%^Deseja refazer a simulação?", "Não,Sim"
[        51]    26-4      				if ($status = 2)
[        52]    27-4      					$instancehandle->excluiSimulacao()
[        53]    28-5      					if ($procerror)
[        54]    29-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        55]    30-5      						return (-1)
[        56]    31-5      					elseif ($status < 0)
[        57]    32-5      						macro "^CLEAR"
[        58]    33-5      						return(-1)
[        59]    34-5      					endif
[        60]    35-4      				else
[        61]    36-4      					macro "^CLEAR"
[        62]    37-4      					return(-1)
[        63]    38-4      				endif
[        64]    39-3      			else
[        65]    40-3      				$instancehandle->SetStatus(2, "GEN0001", "DESCRICAO=Existe uma simulação de venda para a transação!", "")
[        66]    41-3      				macro "^CLEAR"
[        67]    42-3      				return(-1)
[        68]    43-3      			endif
[        69]              			;
[        70]    44-2      		endif
[        71]              	
[        72]    45-1      		clear/e "FIS_ITEMCONSIGTRA"
[        73]    46-1      		CD_EMPTRA.FIS_ITEMCONSIGTRA/init = CD_EMPRESA.TRA_TRANSACAO
[        74]    47-1      		NR_TRANSACAO.FIS_ITEMCONSIGTRA/init = NR_TRANSACAO.TRA_TRANSACAO
[        75]    48-1      		DT_TRANSACAO.FIS_ITEMCONSIGTRA/init = DT_TRANSACAO.TRA_TRANSACAO
[        76]    49-1      		retrieve/e "FIS_ITEMCONSIGTRA"
[        77]    50-2      		if ($status >= 0)
[        78]    51-2      			$instancehandle->SetStatus(2, "GEN0001", "DESCRICAO=Transação de acerto de consignação!", "")
[        79]    52-2      			macro "^CLEAR"
[        80]    53-2      			return(-1)
[        81]    54-2      		endif
[        82]              		
[        83]    55-1      		vTpVariacao = $item("TP_VARIACAO_DESCONTO_VD", $xlplemp$)
[        84]    56-2      		if (vTpVariacao = 1)
[        85]    57-2      			clear/e "TRA_ITEMADIC"
[        86]    58-2      			CD_EMPRESA.TRA_ITEMADIC/init = CD_EMPRESA.TRA_TRANSACAO
[        87]    59-2      			NR_TRANSACAO.TRA_ITEMADIC/init = NR_TRANSACAO.TRA_TRANSACAO
[        88]    60-2      			DT_TRANSACAO.TRA_ITEMADIC/init = DT_TRANSACAO.TRA_TRANSACAO
[        89]    61-2      			retrieve/e "TRA_ITEMADIC"
[        90]    62-3      			if ($status >= 0)
[        91]    63-3      				setocc "TRA_ITEMADIC", 1
[        92]    64-4      				while ($status >= 0)
[        93]    65-5      					if (NR_VARIACAO.TRA_ITEMADIC != 0)
[        94]    66-5      						$instancehandle->SetStatus(2, "GEN0001", "DESCRICAO=Transação já possui desconto por tabela de variação aplicada!", "")
[        95]    67-5      						macro "^CLEAR"
[        96]    68-5      						return(-1)
[        97]    69-5      					endif
[        98]              					
[        99]    70-4      					setocc "TRA_ITEMADIC", $curocc("TRA_ITEMADIC") + 1
[       100]    71-4      				endwhile
[       101]    72-3      			endif
[       102]    73-2      		endif
[       103]              		
[       104]    74-2      		if (TP_SITUACAO.TRA_TRANSACAO != 1)
[       105]    75-2      			$tpSituacao$ = TP_SITUACAO.TRA_TRANSACAO
[       106]    76-2      			vDsSituacao = $valrep(TP_SITUACAO.TRA_TRANSACAO)        
[       107]    77-2      			vDsSituacao = $item("%%$tpSituacao$", vDsSituacao)
[       108]    78-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação está %%vDsSituacao%%%!", "")
[       109]    79-2      			macro "^CLEAR"
[       110]    80-2      			return(-1)
[       111]    81-2      		endif
[       112]              		
[       113]              		;Modalidade Serviço ou Compra
[       114]    82-2      		if (TP_MODALIDADE.GER_OPERACAO = 1) | (TP_MODALIDADE.GER_OPERACAO = 4 & TP_OPERACAO.TRA_TRANSACAO = "E")
[       115]    83-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Não é permitido operação de compra ou serviço!", "")
[       116]    84-2      			macro "^CLEAR"
[       117]    85-2      			return(-1)
[       118]    86-2      		endif
[       120]    87-2      		if (TP_MODALIDADE.GER_OPERACAO = 3) | (TP_MODALIDADE.GER_OPERACAO = 5) ;Devolução / Outras Saídas/Entradas
[       121]    88-2      			TP_ALTERAITEM.TRA_TRANSACAO/init = "T" ;Total
[       122]    89-2      		else
[       123]    90-2      			TP_ALTERAITEM.TRA_TRANSACAO/init = "Q" ;Quantidade
[       124]    91-2      		endif
[       125]              				
[       126]    92-2      		if (CD_EMPFAT.TRA_TRANSACAO != $item("CD_EMPRESA", $$gParamGlb))
[       127]    93-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação inválida!", "")
[       128]    94-2      			macro "^CLEAR"
[       129]    95-2      			return(-1)
[       130]    96-2      		endif		
[       132]    97-2      		if (CD_OPERACAO.TRA_TRANSACAO != $cdOperacaoVenda$) & (CD_OPERACAO.TRA_TRANSACAO != $cdOperacaoValeTroca$) & (CD_OPERACAO.TRA_TRANSACAO != $cdOperacaoTroca$)
[       133]    98-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Operação %%CD_OPERACAO.TRA_TRANSACAO da transação não cadastrada nos parâmetros!", "")
[       134]    99-2      			macro "^CLEAR"
[       135]   100-2      			return(-1)
[       136]   101-2      		endif
[       138]   102-2      		if ($empty("PED_PEDIDOTRA") = 0)
[       139]   103-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação está relacionada ao pedido %%CD_EMPPEDIDO.PED_PEDIDOTRA / %%CD_PEDIDO.PED_PEDIDOTRA%%%!", "")
[       140]   104-2      			macro "^CLEAR"
[       141]   105-2      			return(-1)
[       142]   106-2      		endif
[       144]   107-2      		if ($empty("CDF_REMTRA") = 0)
[       145]   108-2      			$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Transação está relacionada a remessa %%CD_EMPREMESSA.CDF_REMTRA / %%NR_REMESSA.CDF_REMTRA%%%!", "")
[       146]   109-2      			macro "^CLEAR"
[       147]   110-2      			return(-1)
[       148]   111-2      		endif
[       150]   112-2      		if (TP_OPERACAO.TRA_TRANSACAO = "S") & (TP_MODALIDADE.GER_OPERACAO = 8) ;Troca
[       151]   113-3      			if ($empty("TRA_TROCA") != 0)
[       152]   114-3      				$instancehandle->relacionaTroca()
[       153]   115-4      				if ($procerror)
[       154]   116-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       155]   117-4      					macro "^CLEAR"
[       156]   118-4      					return(-1)
[       157]   119-4      				endif
[       158]   120-4      				if ($status < 0)
[       159]   121-4      					macro "^CLEAR"
[       160]   122-4      					return(-1)
[       161]   123-4      				endif
[       162]   124-3      				$instancehandle->recarregaTransacao()
[       163]   125-4      				if ($procerror)
[       164]   126-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       165]   127-4      				endif
[       166]   128-3      			endif
[       167]   129-2      		endif
[       169]   130-2      		if (CD_OPERACAO.TRA_TRANSACAO = $cdOperacaoVenda$)
[       170]   131-2      			TP_TRANSACAO.TRA_TRANSACAO/init = 1 ;Venda
[       171]   132-2      		elseif (CD_OPERACAO.TRA_TRANSACAO = $cdOperacaoValeTroca$) 
[       172]   133-2      			TP_TRANSACAO.TRA_TRANSACAO/init = 2 ;Vale troca
[       173]   134-2      		elseif (CD_OPERACAO.TRA_TRANSACAO = $cdOperacaoTroca$)
[       174]   135-2      			TP_TRANSACAO.TRA_TRANSACAO/init = 3 ;Troca
[       175]   136-2      		endif
[       177]   137-1      		fieldsyntax DT_TRANSACAO.TRA_TRANSACAO, "DIM"
[       178]   138-1      		fieldsyntax NR_TRANSACAO.TRA_TRANSACAO, "DIM"
[       180]   139-2      		if ($empty("TRA_TRANSITEM") = 0)
[       181]   140-2      			fieldsyntax BT_F11.SIS_BOTOES, ""
[       182]   141-2      			$inF11$ = "T"
[       183]   142-3      			if (TP_ALTERAITEM.TRA_TRANSACAO = "T") ;Total
[       184]   143-3      				setocc "TRA_TRANSITEM", -1
[       185]   144-3      				CD_CFOP.TRA_TRANSACAO/init = CD_CFOP.TRA_TRANSITEM
[       186]   145-3      				CD_CST.TRA_TRANSACAO/init = CD_CST.TRA_TRANSITEM
[       187]   146-3      			endif
[       188]   147-2      			fieldsyntax BT_F7.SIS_BOTOES, ""
[       189]   148-2      			$inF7$ = "T"
[       190]   149-2      		else
[       191]   150-2      			fieldsyntax BT_F6.SIS_BOTOES, "DIM"
[       192]   151-2      			$inF6$ = "F"
[       193]   152-2      			fieldsyntax BT_F7.SIS_BOTOES, "DIM"
[       194]   153-2      			$inF7$ = "F"
[       195]   154-3      			if (TP_OPERACAO.TRA_TRANSACAO = "S") & (TP_MODALIDADE.GER_OPERACAO = 8) ;Troca
[       196]   155-3      				fieldsyntax BT_F11.SIS_BOTOES, ""
[       197]   156-3      				$inF11$ = "T"
[       198]   157-3      			else
[       199]   158-3      				fieldsyntax BT_F11.SIS_BOTOES, "DIM"
[       200]   159-3      				$inF11$ = "F"
[       201]   160-3      			endif
[       202]   161-2      			clear/e "SIS_IMAGEM"
[       203]   162-2      		endif
[       205]   163-2      		if ($empty("TRA_TROCA") = 0)
[       206]   164-2      			fieldsyntax VL_TOTAL.R_TRA_TRANSACAO, ""
[       207]   165-2      		else
[       208]   166-2      			fieldsyntax VL_TOTAL.R_TRA_TRANSACAO, "HID"
[       209]   167-2      		endif
[       210]   168-2      		if (TP_FOCO.TRA_TRANSACAO = "")
[       211]   169-2      			TP_FOCO.TRA_TRANSACAO/init = "C"
[       212]   170-2      		endif
[       214]              		;---Elia Proj. 102/317 10/06/08
[       215]   171-1      		$instancehandle->buscaDadosAdicTransacao()
[       216]   172-2      		if ($procerror)
[       217]   173-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")        
[       218]   174-2      			return (-1)
[       219]   175-2      		endif          
[       220]              		;	
[       222]              		;FIUZA 20/12/05 - IMPRESSAO ECF CONCOMITANTE
[       223]   176-2      		if (TP_DOCTO.GER_OPERACAO = 3)
[       224]   177-3      			if ($InCupomAberto$ = "N")
[       225]   178-3      				$vNrItem$ = 0 ;-=LSC=- (17/04/2008) TAR 280 PRJ 102
[       226]   179-3      				viParams = ""
[       227]   180-3      				putitem/id viParams, "CD_EMPRESA",			CD_EMPRESA.TRA_TRANSACAO
[       228]   181-3      				putitem/id viParams, "NR_TRANSACAO",		NR_TRANSACAO.TRA_TRANSACAO
[       229]   182-3      				putitem/id viParams, "DT_TRANSACAO", 		DT_TRANSACAO.TRA_TRANSACAO		
[       230]   183-3      				putitem/id viParams, "IN_GRAVARELACAO",	"T"  ;* Claudemir - Prj/Tarefa: 111/1989 - 20/10/2011
[       231]   184-3      				activate "ECFSVCO010".iniciaCupom($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       232]   185-4      				if ($procerror)       
[       233]   186-4      					$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       234]   187-4      					return(-1)
[       235]   188-4      				elseif ($status = -10)
[       236]   189-4      					viParams = ""
[       237]   190-4      					voParams = ""
[       238]   191-4      					putitem/id viParams,"TITULO", "Erro de comunicação com a ECF"
[       239]   192-4      					putitem/id viParams,"MENSAGEM", $item("DESCRICAO",$xctxerro$)
[       240]   193-4      					activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[       241]   194-5      					if ($procerror)       
[       242]   195-5      						$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       243]   196-5      						return(-1)
[       244]   197-5      					endif
[       245]   198-4      					return(-1)
[       246]   199-4      				elseif ($status < 0)
[       247]   200-4      					$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       248]   201-4      					return(-1)
[       249]   202-4      				endif
[       250]   203-3      				$InCupomAberto$ = "S"
[       251]   204-3      				$CdEmpEcf$ = $item("CD_EMPECF",voParams)
[       252]   205-3      				$NrEcf$ = $item("NR_ECF",voParams)
[       253]   206-3      				$NrCupom$ = $item("NR_CUPOM",voParams)
[       254]   207-3      				setocc "TRA_TRANSITEM", -1
[       255]   208-4      				if ($empty("TRA_TRANSITEM") = 0)
[       256]   209-4      					setocc "TRA_TRANSITEM", 1
[       257]   210-5      					while ($status >= 0)
[       258]   211-5      						viParams = ""
[       259]   212-5      						putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       260]   213-5      						putitem/id viParams, "NR_TRANSACAO", NR_TRANSACAO.TRA_TRANSACAO
[       261]   214-5      						putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       262]   215-5      						putitem/id viParams, "NR_ITEM", NR_ITEM.TRA_TRANSITEM		
[       263]   216-5      						activate "ECFSVCO010".lancaItemConcomitante($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[       264]   217-6      						if ($procerror)       
[       265]   218-6      							$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       266]   219-6      							return(-1)
[       267]   220-6      						elseif ($status = -10)
[       268]   221-6      							viParams = ""
[       269]   222-6      							voParams = ""
[       270]   223-6      							putitem/id viParams,"TITULO", "Erro de comunicação com a ECF"
[       271]   224-6      							putitem/id viParams,"MENSAGEM", $item("DESCRICAO",$xctxerro$)
[       272]   225-6      							activate "GERFP008".EXEC(viParams,voParams,$xCdErro$,$xCtxErro$)
[       273]   226-7      							if ($procerror)       
[       274]   227-7      								$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       275]   228-7      								return(-1)
[       276]   229-7      							endif
[       277]   230-6      							return(-1)
[       278]   231-6      						elseif ($status < 0)
[       279]   232-6      							$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[       280]   233-6      							return(-1)
[       281]   234-6      						endif
[       282]   235-5      						setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[       283]   236-5      					endWhile
[       284]   237-4      				endif	
[       285]   238-3      			endif	
[       286]   239-2      		endif
[       287]              		;-=CANONICO=- (13/06/2011) PRJ 156 TAR 570  - Chamada portal RFID -
[       288]   240-2      		if ($tpUtilizaEtiqRfidPdv$ = 1 | $tpUtilizaEtiqRfidPdv$ = 2 | $tpUtilizaEtiqRfidPdv$ = 3 | $tpUtilizaEtiqRfidPdv$ = 4)
[       289]   241-2      			fieldsyntax BT_PORTAL.TRA_TRANSACAO, ""
[       290]   242-2      		else
[       291]   243-2      			fieldsyntax BT_PORTAL.TRA_TRANSACAO, "DIM"
[       292]   244-2      		endif
[       294]   245-1      	else		
[       296]   246-1      		fieldsyntax DT_TRANSACAO.TRA_TRANSACAO, ""
[       297]   247-1      		fieldsyntax NR_TRANSACAO.TRA_TRANSACAO, ""
[       298]   248-1      		BT_CODIGO.SIS_FILTRO = "%Validar código barras"
[       300]   249-1      		BT_F5.SIS_BOTOES/init = "F5 Lançar item"
[       301]   250-1      		fieldsyntax BT_F7.SIS_BOTOES, "DIM"
[       302]   251-1      		$inF7$ = "F"
[       304]   252-1      		fieldsyntax BT_PORTAL.TRA_TRANSACAO, "DIM" ;-=CANONICO=- (13/06/2011) PRJ 156 TAR 570  - Chamada portal RFID -
[       305]   253-1      		fieldsyntax BT_F11.SIS_BOTOES, "DIM"
[       306]   254-1      		$inF11$ = "F"
[       307]   255-1      		CD_EMPRESA.TRA_TRANSACAO/init = $item("CD_EMPRESA", $$gParamGlb)
[       308]   256-1      		DT_TRANSACAO.TRA_TRANSACAO/init = $item("DT_SISTEMA", $$gParamGlb)
[       309]   257-1      		CD_PESSOA.TRA_TRANSACAO/init = $cdCliente$
[       310]   258-1      		CD_CONDPGTO.TRA_TRANSACAO/init = $cdCondPgto$
[       311]   259-2      		if ($cdVendedor$ > 0)
[       312]   260-2      			CD_VENDEDOR.PES_VENDEDOR/init = $cdVendedor$
[       313]   261-2      			retrieve/e "PES_VENDEDOR"
[       314]   262-2      		endif
[       315]   263-1      		TP_SITUACAO.TRA_TRANSACAO/init = 1 ;Em andamento
[       316]   264-1      		TP_ORIGEMEMISSAO.TRA_TRANSACAO/init = 1 ;Própria
[       317]              ;		TP_OPERACAO.TRA_TRANSACAO/init = "S"
[       318]   265-1      		TP_FOCO.TRA_TRANSACAO/init = "C"
[       319]   266-1      		TP_ALTERAITEM.TRA_TRANSACAO/init = "N" ;Não altera
[       320]   267-1      		TP_TRANSACAO.TRA_TRANSACAO/init = $tpTransacaoPadrao$ ;Carregado pela rotina carregaListas
[       321]   268-2      		selectcase TP_TRANSACAO.TRA_TRANSACAO
[       322]   269-2      			case 1
[       323]   270-2      				CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoVenda$
[       324]   271-2      			case 2
[       325]   272-2      				CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoValeTroca$
[       326]   273-2      			case 3
[       327]   274-2      				CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoTroca$
[       328]   275-2      		endselectcase	
[       329]              ;		CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoVenda$
[       330]   276-1      		CD_USUCONF.TRA_TRANSACAO/init = $item("CD_USUCONF", $$gParamGlb)
[       331]   277-1      		fieldsyntax VL_TOTAL.R_TRA_TRANSACAO, "HID"
[       332]   278-1      	endif
[       333]              	
[       334]   279-1      	if (TP_FOCO.TRA_TRANSACAO = "B")
[       335]   280-1      		fieldsyntax TP_TRANSACAO.TRA_TRANSACAO, "DIM"
[       336]   281-1      		fieldsyntax CD_AUXILIAR.PES_VENDEDOR, "DIM"
[       337]              		;        fieldsyntax CD_PESSOA.PES_S_PESSOA, "DIM"
[       338]   282-1      		fieldsyntax CD_OPERACAO.TRA_TRANSACAO, "DIM"
[       339]   283-1      		fieldsyntax CD_BARRAPRD.SIS_FILTRO, ""
[       340]   284-1      		fieldsyntax IN_CODIGO.SIS_FILTRO, ""
[       341]   285-1      		fieldsyntax QT_SOLICITADA.SIS_FILTRO, ""
[       342]   286-1      		fieldsyntax BT_LTRANSACAO.SIS_BOTOES2, "DIM"
[       343]   287-1      		fieldsyntax BT_F3.SIS_BOTOES, ""
[       344]   288-1      		$inF3$ = "T"
[       345]   289-1      		fieldsyntax BT_F4.SIS_BOTOES, "DIM"
[       346]   290-1      		$inF4$ = "F"
[       347]   291-1      		fieldsyntax BT_F7.SIS_BOTOES, "DIM"
[       348]   292-1      		$inF7$ = "F"
[       349]   293-1      		fieldsyntax BT_F6.SIS_BOTOES, "DIM"
[       350]   294-1      		$inF6$ = "F"
[       351]   295-1      		fieldsyntax BT_F8.SIS_BOTOES, "DIM"
[       352]   296-1      		$inF8$ = "F"
[       353]   297-1      		fieldsyntax BT_F9.SIS_BOTOES, "DIM"
[       354]   298-1      		$inF9$ = "F"
[       355]   299-1      		$instancehandle->posicionaCursor()
[       356]   300-2      		if ($procerror)
[       357]   301-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       358]   302-2      		endif
[       359]   303-1      	else
[       360]   304-1      		fieldsyntax TP_TRANSACAO.TRA_TRANSACAO, ""
[       361]   305-1      		fieldsyntax CD_AUXILIAR.PES_VENDEDOR, ""
[       362]              		;        fieldsyntax CD_PESSOA.PES_S_PESSOA, ""
[       363]   306-1      		fieldsyntax CD_BARRAPRD.SIS_FILTRO, "DIM"
[       364]   307-1      		fieldsyntax IN_CODIGO.SIS_FILTRO, "DIM"
[       365]   308-1      		fieldsyntax QT_SOLICITADA.SIS_FILTRO, "DIM"
[       366]   309-1      		fieldsyntax BT_LTRANSACAO.SIS_BOTOES2, ""
[       367]   310-1      		fieldsyntax BT_F3.SIS_BOTOES, "DIM"
[       368]   311-1      		$inF3$ = "F"
[       370]   312-1      		fieldsyntax BT_F4.SIS_BOTOES, ""
[       371]   313-1      		$inF4$ = "T"
[       372]   314-1      		fieldsyntax BT_F9.SIS_BOTOES, ""
[       373]   315-1      		$inF9$ = "T"
[       374]   316-2      		if (TP_FOCO.TRA_TRANSACAO = "I")
[       375]   317-2      			$prompt = CD_AUXILIAR.PES_VENDEDOR
[       376]   318-2      		else
[       377]   319-3      			if ($empty("TRA_TRANSITEM") = 0)
[       378]   320-3      				setocc "TRA_TRANSITEM", -1
[       379]   321-3      				$prompt = NR_ITEM.TRA_TRANSITEM
[       380]   322-3      			endif			
[       381]   323-2      			$prompt = TP_TRANSACAO.TRA_TRANSACAO
[       382]   324-2      		endif
[       383]              		
[       384]   325-2      		if ($inFocoVendedor$ = "T")
[       385]   326-2      			clear/e "PES_VENDEDOR"
[       386]   327-2      			$prompt = CD_AUXILIAR.PES_VENDEDOR
[       387]   328-2      			$inFocoVendedor$ = "F"
[       388]   329-2      		endif
[       389]              		
[       390]   330-2      		if ($empty("TRA_TRANSITEM") = 0)
[       391]   331-2      			fieldsyntax TP_TRANSACAO.TRA_TRANSACAO, "DIM"
[       392]   332-2      			$prompt = CD_AUXILIAR.PES_VENDEDOR
[       393]   333-2      			fieldsyntax BT_F6.SIS_BOTOES, ""
[       394]   334-2      			$inF6$ = "T"
[       395]   335-2      			fieldsyntax BT_F7.SIS_BOTOES, ""
[       396]   336-2      			$inF7$ = "T"
[       397]   337-2      			fieldsyntax BT_F8.SIS_BOTOES, ""
[       398]   338-2      			$inF8$ = "T"			
[       399]   339-2      		else
[       400]   340-3      			if ($empty("TRA_TROCA") = 0)
[       401]   341-3      				fieldsyntax TP_TRANSACAO.TRA_TRANSACAO, "DIM"
[       402]   342-3      				$prompt = CD_AUXILIAR.PES_VENDEDOR
[       403]   343-3      			endif
[       404]   344-2      			fieldsyntax BT_F6.SIS_BOTOES, "DIM"
[       405]   345-2      			$inF6$ = "F"
[       406]   346-2      			fieldsyntax BT_F8.SIS_BOTOES, "DIM"
[       407]   347-2      			$inF8$ = "F"
[       408]   348-2      		endif
[       409]   349-1      	endif
[       411]              	;* Claudemir - Prj/Tarefa: 191/1 - 27/09/2011 
[       412]              	; permitir desconto no cupom concomitante
[       413]              	;; --- DIONE |102/0961| 14/10/2010
[       414]              	;; Cupom Concomitante desabilita desconto por item.	
[       415]              	;if(TP_DOCTO.GER_OPERACAO = 3) 
[       416]              	;	fieldsyntax BT_F6.SIS_BOTOES, "DIM"
[       417]              	;	$inF6$ = "F"
[       418]              	;endif
[       419]              	;; ---  ;*
[       421]   350-1      	if ($inMostraTotal$ = "F")
[       422]   351-2      		if ($empty("TRA_TRANSITEM") = 0)
[       423]   352-2      			vNrOcc = $curocc("TRA_TRANSITEM")
[       424]   353-2      			setocc "TRA_TRANSITEM", 1
[       425]   354-3      			while ($status >= 0)		
[       426]   355-3      				fieldsyntax NR_ITEM.TRA_TRANSITEM, "HID"		
[       427]   356-3      				setocc "TRA_TRANSITEM", $curocc("TRA_TRANSITEM") + 1
[       428]   357-3      			endwhile
[       429]   358-2      			setocc "TRA_TRANSITEM", vNrOcc
[       430]   359-2      		endif
[       431]   360-1      		fieldsyntax "QT_SOLICITADA.TRA_TRANSACAO", "HID"
[       432]   361-1      		fieldsyntax "VL_TRANSACAO.TRA_TRANSACAO", "HID"
[       433]   362-1      	elseif (vTpValidacaoConf = 2) | (vTpValidacaoConf = 3)
[       434]   363-1      		fieldsyntax "QT_SOLICITADA.TRA_TRANSACAO", "HID"
[       435]   364-1      	endif
[       437]              	;---Elia Proj. 115/3 11/10/07
[       438]   365        	$instancehandle->listaDetalhe()
[       439]   366-1      	if ($procerror)
[       440]   367-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[       441]   368-1      	endif
[       442]              	;
[       443]   369        	return(0)
[       444]   370        End ; operation PrcOGF
[       446]              ;-----------------------------
[       447]******        partner operation posADDINSERT 
[       448]              	;-----------------------------
[       449]              	
[       450]     1        End ; operation posADDINSERT
[       452]              ;------------------------
[       453]******        partner operation posREAD 
[       454]              	;------------------------
[       456]     1        End ; operation posREAD
[       458]              ;--------------------------
[       459]******        partner operation preREMOVE 
[       460]              	;--------------------------
[       461]              	
[       462]     1        End ; operation preREMOVE
[       464]              ;-------------------------
[       465]******        partner operation preWRITE 
[       466]              	;-------------------------
[       467]              	
[       468]     1        End ; operation preWRITE
[       470]              ;-------------------------
[       471]******        partner operation posWRITE 
[       472]              	;-------------------------
[       473]              	
[       474]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_TRANSACAO.TRA

[         1]              ;--------------------------
[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              	;--------------------------
[         4]     1        	creocc "TRA_TRANSACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              	;--------------------------
[        10]     1-1      	if ($dbocc("TRA_TRANSACAO"))
[        11]     2-1      		askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2      		if ($status = 1) 
[        13]     4-2      			remocc "TRA_TRANSACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2      		else
[        16]     7-2      			return (-1)
[        17]     8-2      		endif
[        18]     9-1      	else
[        19]    10-1      		remocc "TRA_TRANSACAO"
[        20]    11-1      	endif 
[        21]    12        	return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              	;-------------------------
[        27]     1-1      	if ($occmod("TRA_TRANSACAO")) & ($dbocc("TRA_TRANSACAO"))
[        28]     2-1      		askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2      		if ($status = 1)
[        30]     4-2      			retrieve/e "TRA_TRANSACAO"
[        31]     5-3      			if ($procerror)
[        32]     6-4      				if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4      				else
[        35]     9-4      					$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4      				endif
[        37]    11-3      			else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3      			endif
[        40]    14-2      		else
[        41]    15-2      			return (-1) 
[        42]    16-2      		endif
[        43]    17-1      	else
[        44]    18-1      		retrieve/e "TRA_TRANSACAO"
[        45]    19-2      		if ($procerror)
[        46]    20-3      			if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3      			else
[        49]    23-3      				$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3      			endif
[        51]    25-2      		else
[        52]    26-2      			$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2      		endif
[        54]    28-1      	endif
[        55]    29        	return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              	;-------------------------
[        61]     1-1      	if ($editmode = 0)
[        62]     2-1      		store/e/complete "TRA_TRANSACAO"
[        63]     3-2      		if ($status < 0)
[        64]     4-2      			$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2      			rollback
[        66]     6-2      			return (-1)
[        67]     7-2      		else
[        68]     8-3      			if ($status = 1)
[        69]     9-3      				$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3      			else
[        71]    11-3      				$instancehandle->PrcCommit("")
[        72]    12-3      			endif
[        73]    13-2      		endif
[        74]    14-1      	else
[        75]    15-1      		$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      	endif
[        77]    17        	return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              	;---------------------------
[        83]     1        	clear/e "TRA_TRANSACAO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              	;---------------------------
[        89]     1        	setocc "TRA_TRANSACAO",-1
[        90]     2        	erase/e "TRA_TRANSACAO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1      		return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif    
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              	;------------------------------- 
[       103]              	variables
[       104]              		string viParams,voParams
[       105]              	endvariables
[       106]              	
[       107]     1-1      	if ($dbocc($entname))
[       108]     2-1      		return (-1)    
[       109]     3-1      	endif    
[       110]              	
[       111]              ;	if ($instancemod) & (!$foreign("TRA_TRANSACAO"))
[       112]              ;		askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       113]              ;	else 
[       114]     4        		$status = 1
[       115]              ;	endif
[       116]              	
[       117]     5-1      	if ($status = 1)
[       118]     6-1      		viParams = ""
[       119]     7-1      		putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[       120]     8-1      		putitem/id viParams, "DT_TRANSACAO", DT_TRANSACAO.TRA_TRANSACAO
[       121]     9-1      		putitem/id viParams, "TP_SITUACAO", 01 ;Em andamento
[       122]    10-1      		$keyboard = "KB_GLOBAL"        
[       123]    11-1      		activate "TRAFL026".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       124]    12-1      		$keyboard = "KB_PDV"
[       125]    13-2      		if ($procerror)
[       126]    14-2      			$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=TRAFL026.EXEC")
[       127]    15-2      		else
[       128]    16-3      			if (voParams != "")
[       129]    17-3      				$collhandle("TRA_TRANSACAO")->Limpar()
[       130]    18-3      				$instancehandle->SetChave("TRA_TRANSACAO",voParams)
[       131]    19-3      				$instancehandle->LMK()
[       132]    20-4      				if ($status < 0)
[       133]    21-4      					set $keycheck("TRA_TRANSACAO",1)
[       134]    22-4      				endif
[       135]    23-3      			endif
[       136]    24-2      		endif
[       137]    25-1      	else
[       138]    26-1      		return (-1)
[       139]    27-1      	endif
[       140]    28        End ; operation ConsultarChave

Trigger <DTLF> from Field: CD_EMPRESA.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: CD_EMPRESA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: DT_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PESSOA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERACAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CONDPGTO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFAT.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GRUPOEMPRESA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_MODELOTRA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <VLDF> from Field: CD_MODELOTRA.TRA_TRANSACAO.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_OPERADOR.TRA_TRANSACAO.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_TRANSACAO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_TRANSACAO = "")
[I1:      4]     4-2            cd_operador.TRA_TRANSACAO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_TRANSACAO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_TRANSACAO.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: TP_ORIGEMEMISSAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_SEQENDERECO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPRESAORI.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAOORI.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_USURELAC.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUCONF.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_GUIA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_REPRESENTANT.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_COMPVEND.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUIMPRESSAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_IMPRESSAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: TP_OPERACAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_FRETE.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_ACEITADEV.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: PR_DESCONTO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: QT_SOLICITADA.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: QT_SOLICITADA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_PREVENTREGA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_VALIDADE.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_ULTATEND.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: VL_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESCONTO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESPACESSOR.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_FRETE.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_SEGURO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEICMS.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ICMS.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEICMSSUBST.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ICMSSUBST.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_IPI.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTAL.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("SIS_IMAGEM")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("SIS_IMAGEM"))
[I1:      2]     2-1      	$occhandle("SIS_IMAGEM")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("SIS_IMAGEM")->PrcOGF()

Trigger <RMO > from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=SIS_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: SIS_IMAGEM.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=SIS_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("SIS_IMAGEM")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("SIS_IMAGEM")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=SIS_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("SIS_IMAGEM")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=SIS_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("SIS_IMAGEM"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.SIS_IMAGEM/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.SIS_IMAGEM = "")
[I2:      4]    18-1            cd_operador.SIS_IMAGEM/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.SIS_IMAGEM/init = $datim
[I1:      3]    21        $occhandle("SIS_IMAGEM")->PrcVLDO()

Trigger <VLDK> from Entity: SIS_IMAGEM.SIS

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: SIS_IMAGEM.SIS

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(SIS_IMAGEM))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(SIS_IMAGEM))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: SIS_IMAGEM.SIS

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "SIS_IMAGEM",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("SIS_IMAGEM"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "SIS_IMAGEM"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "SIS_IMAGEM"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("SIS_IMAGEM")) & ($dbocc("SIS_IMAGEM"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "SIS_IMAGEM"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "SIS_IMAGEM"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "SIS_IMAGEM"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "SIS_IMAGEM"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "SIS_IMAGEM",-1
[        90]     2        	erase/e "SIS_IMAGEM"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("SIS_IMAGEM"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("SIS_IMAGEM")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("SIS_IMAGEM",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("SIS_IMAGEM",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: NR_IMAGEM.SIS_IMAGEM.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.SIS_IMAGEM.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.SIS_IMAGEM.SIS

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.SIS_IMAGEM/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.SIS_IMAGEM = "")
[I1:      4]     4-2            cd_operador.SIS_IMAGEM/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.SIS_IMAGEM/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.SIS_IMAGEM.SIS

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.SIS_IMAGEM.SIS

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: NM_IMAGEM.SIS_IMAGEM.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: DS_IMAGEM.SIS_IMAGEM.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: DS_IMAGEM.SIS_IMAGEM.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <FXTG> from Field: DS_IMAGEM.SIS_IMAGEM.SIS

[         1]              ; -- start triggers for picture widget 
[         3]******        trigger moveTo
[         4]              params
[         5]                string dragvalue: in
[         6]                string dropformat: in
[         7]                string itemvalue: in
[         8]                numeric numberofobjects: in
[         9]                numeric index: in
[        10]              endparams
[        12]     1        end ; trigger moveTo
[        14]******        trigger moveFrom
[        15]              params
[        16]                string dragvalue: in
[        17]                string dropformat: in
[        18]                numeric numberofobjects: in
[        19]                numeric index: in
[        20]              endparams
[        22]     1        end ; trigger moveFrom
[        24]******        trigger moveWithin
[        25]              params
[        26]                string dragvalue: in
[        27]                string dropformat: in
[        28]                string itemvalue: in
[        29]                numeric numberofobjects: in
[        30]                numeric index: in
[        31]              endparams
[        33]     1        end ; trigger moveWithin
[        35]******        trigger copyTo
[        36]              params
[        37]                string dragvalue: in
[        38]                string dropformat: in
[        39]                string itemvalue: in
[        40]                numeric numberofobjects: in
[        41]                numeric index: in
[        42]              endparams
[        44]     1        end ; trigger copyTo
[        46]******        trigger createShortcutTo
[        47]              params
[        48]                string dragvalue: in
[        49]                string dropformat: in
[        50]                string itemvalue: in
[        51]                numeric numberofobjects: in
[        52]                numeric index: in
[        53]              endparams
[        55]     1        end ; trigger createShortcutTo
[        57]              ; -- end triggers for picture widget

Trigger <DTLE> from Entity: TRA_TRANSITEM.TRA

[         1]     1-1      if (TP_FOCO.TRA_TRANSACAO = "B")
[         2]     2-1      	return(-1)
[         3]     3-1      endif
[         5]     4-1      if ($empty("TRA_TRANSITEM") != 0)
[         6]     5-1      	return(-1)
[         7]     6-1      endif
[         9]     7-1      if (TP_ALTERAITEM.TRA_TRANSACAO = "N")
[        10]              ;	$instancehandle->SetStatus(-1, "GEN0001", "DESCRICAO=Alteração do item é permitida somente para operação de Devolução / Outras Saídas/Entradas!", "")
[        11]     8-1      	return(-1)
[        12]     9-1      endif
[        14]    10        $instancehandle->alteraItem()
[        15]    11-1      if ($procerror)
[        16]    12-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        17]    13-1      endif
[        19]    14        return(0)

Trigger <AIO > from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_TRANSITEM"))
[I1:      2]     2-1      	$occhandle("TRA_TRANSITEM")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_TRANSITEM")->PrcOGF()

Trigger <RMO > from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_TRANSITEM")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_TRANSITEM")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_TRANSITEM")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_TRANSITEM"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_TRANSITEM/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_TRANSITEM = "")
[I2:      4]    18-1            cd_operador.TRA_TRANSITEM/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_TRANSITEM/init = $datim
[I1:      3]    21        $occhandle("TRA_TRANSITEM")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_TRANSITEM.TRA

[         1]              ;------------------------
[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              	;------------------------
[         4]              	;if ($dbocc(TRA_TRANSITEM))
[         5]              	
[         6]              	;else
[         7]              	
[         8]              	;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              	;-----------------------
[        14]     1-1      	if (TP_FOCO.TRA_TRANSACAO = "B")
[        15]     2-1      		$instancehandle->posicionaCursor()
[        16]     3-2      		if ($procerror)
[        17]     4-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        18]     5-2      		endif
[        19]     6-1      		return(-1)
[        20]     7-1      	endif
[        22]     8        	curoccvideo/inner $entname, "col=25"
[        24]     9-1      	if ($dbocc(TRA_TRANSITEM))
[        25]    10-1      		TP_FOCO.TRA_TRANSACAO/init = "I"
[        26]    11-2      		if (CD_COMPVEND.TRA_TRANSITEM != CD_VENDEDOR.PES_VENDEDOR)
[        27]    12-2      			clear/e "PES_VENDEDOR"
[        28]    13-2      			CD_VENDEDOR.PES_VENDEDOR/init =CD_COMPVEND.TRA_TRANSITEM
[        29]    14-2      			retrieve/e "PES_VENDEDOR"
[        30]    15-2      		endif	
[        31]              		;---Elia Proj. 115/3 11/10/07
[        32]    16-1      		$instancehandle->listaDetalhe()
[        33]    17-2      		if ($procerror)
[        34]    18-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        35]    19-2      		endif
[        36]              		;
[        38]              		;>-- MAC - PRJ 102 TAR 804 - 11/02/2010 ---
[        39]    20-2      		if (CD_PROMOCAO.TRA_TRANSITEM > 0)
[        40]    21-2      			message/hint "Promoção: %%CD_PROMOCAO.TRA_TRANSITEM"	
[        41]    22-2      		endif
[        42]              		;--<
[        44]              		;>-- MAC - PRJ 156 TAR 175 - 17/02/2010 ---
[        45]    23-1      		CD_PRODUTO.SIS_PRODUTO/init = CD_PRODUTO.TRA_TRANSITEM
[        46]    24-1      		DS_PRODUTO.SIS_PRODUTO/init = DS_PRODUTO.TRA_TRANSITEM
[        47]    25-1      		VL_UNITARIO.SIS_PRODUTO/init = VL_UNITLIQUIDO.TRA_TRANSITEM
[        48]    26-1      		VL_TOTAL.SIS_PRODUTO/init = VL_TOTALLIQUIDO.TRA_TRANSITEM
[        49]    27-1      		QT_SOLICITADA.SIS_PRODUTO/init = QT_SOLICITADA.TRA_TRANSITEM
[        50]              		;--<
[        51]    28-1      	else
[        52]              	
[        53]    29-1      	endif
[        55]    30        	return(0)
[        56]    31        End ; operation PrcOGF
[        58]              ;-----------------------------
[        59]******        partner operation posADDINSERT 
[        60]              	;-----------------------------
[        61]              	
[        62]     1        End ; operation posADDINSERT
[        64]              ;------------------------
[        65]******        partner operation posREAD 
[        66]              	;------------------------
[        67]              		
[        68]              	;>-- MAC - PRJ 102 TAR 804 - 11/02/2010 ---
[        69]     1-1      	if (CD_PROMOCAO.TRA_TRANSITEM > 0)
[        70]     2-1      		fieldvideo "CD_PRODUTO.TRA_TRANSITEM", "col=39"
[        71]     3-1      		fieldvideo "DS_PRODUTO.TRA_TRANSITEM", "col=39"
[        72]     4-1      		fieldvideo "VL_UNITLIQUIDO.TRA_TRANSITEM", "col=39"
[        73]     5-1      	endif
[        75]     6        	return(0)
[        76]     7        End ; operation posREAD
[        78]              ;--------------------------
[        79]******        partner operation preREMOVE 
[        80]              	;--------------------------
[        81]              	
[        82]     1        End ; operation preREMOVE
[        84]              ;-------------------------
[        85]******        partner operation preWRITE 
[        86]              	;-------------------------
[        87]              	
[        88]     1        End ; operation preWRITE
[        90]              ;-------------------------
[        91]******        partner operation posWRITE 
[        92]              	;-------------------------
[        93]              	
[        94]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_TRANSITEM.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_TRANSITEM",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_TRANSITEM"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_TRANSITEM"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_TRANSITEM"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_TRANSITEM")) & ($dbocc("TRA_TRANSITEM"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_TRANSITEM"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_TRANSITEM"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_TRANSITEM"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_TRANSITEM"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_TRANSITEM",-1
[        90]     2        	erase/e "TRA_TRANSITEM"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_TRANSITEM"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_TRANSITEM")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_TRANSITEM",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_TRANSITEM",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_ITEM.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFAT.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GRUPOEMPRESA.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.TRA_TRANSITEM.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_TRANSITEM/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_TRANSITEM = "")
[I1:      4]     4-2            cd_operador.TRA_TRANSITEM/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_TRANSITEM/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_TRANSITEM.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: CD_TIPI.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CFOP.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PRODUTO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PROMOCAO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_DECRETO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: CD_COMPVEND.TRA_TRANSITEM.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: CD_COMPVEND.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_ESPECIE.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CST.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_DESCONTO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: PR_DESCONTO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_PRODUTO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_BARRAPRD.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_SOLICITADA.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_ATENDIDA.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_SALDO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_ANTERIOR.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALBRUTO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALLIQUIDO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALDESC.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALDESCCAB.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITBRUTO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITLIQUIDO.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITDESCCAB.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITDESC.TRA_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PES_PESSOA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PES_PESSOA"))
[I1:      2]     2-1      	$occhandle("PES_PESSOA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PES_PESSOA")->PrcOGF()

Trigger <RMO > from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PES_PESSOA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PES_PESSOA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PES_PESSOA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PES_PESSOA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PES_PESSOA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PES_PESSOA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PES_PESSOA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PES_PESSOA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PES_PESSOA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PES_PESSOA = "")
[I2:      4]    18-1            cd_operador.PES_PESSOA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PES_PESSOA/init = $datim
[I1:      3]    21        $occhandle("PES_PESSOA")->PrcVLDO()

Trigger <VLDK> from Entity: PES_PESSOA.PES

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PES_PESSOA.PES

[         1]              ;------------------------
[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PES_PESSOA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PES_PESSOA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        30]     1-1      	if (CD_PESSOA.PES_PESSOA != $cdCliente$)
[        31]     2-1      		$instancehandle->buscaLimite()
[        32]     3-2      		if ($procerror)
[        33]     4-2      			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        34]     5-2      		endif
[        35]              		
[        36]     6-2      		if ($limiteCredito$ = "S") | ($limiteCredito$ = "V")
[        37]     7-3      			if(TP_PESSOA.PES_PESSOA = "J")
[        38]     8-3      				message/hint "Nome fantasia: %%NM_FANTASIA.PES_PESJURIDICA  Limite cliente: %%$vlLimite$"
[        39]     9-3      			else
[        40]    10-3      				message/hint "Limite cliente: %%$vlLimite$"
[        41]    11-3      			endif
[        42]    12-2      		else
[        43]    13-3      			if(TP_PESSOA.PES_PESSOA = "J")
[        44]    14-3      				message/hint "Nome fantasia: %%NM_FANTASIA.PES_PESJURIDICA"
[        45]    15-3      			endif
[        46]    16-2      		endif
[        47]              		
[        48]              ;		$instancehandle->buscaAniversario()
[        49]              ;		if ($procerror)
[        50]              ;			$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        51]              ;		endif
[        52]    17-1      	endif
[        53]              	
[        54]    18        	return(0)
[        55]    19        End ; operation posREAD
[        57]              ;--------------------------
[        58]******        partner operation preREMOVE 
[        59]              ;--------------------------
[        61]     1        End ; operation preREMOVE
[        63]              ;-------------------------
[        64]******        partner operation preWRITE 
[        65]              ;-------------------------
[        67]     1        End ; operation preWRITE
[        69]              ;-------------------------
[        70]******        partner operation posWRITE 
[        71]              ;-------------------------
[        73]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PES_PESSOA.PES

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PES_PESSOA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PES_PESSOA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PES_PESSOA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PES_PESSOA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PES_PESSOA")) & ($dbocc("PES_PESSOA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PES_PESSOA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PES_PESSOA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PES_PESSOA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PES_PESSOA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PES_PESSOA",-1
[        90]     2        	erase/e "PES_PESSOA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PES_PESSOA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PES_PESSOA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PES_PESSOA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PES_PESSOA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_PESSOA.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_PESSOA.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPRESACAD.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADORCAD.PES_PESSOA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_PESSOA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_PESSOA = "")
[I1:      4]     4-2            cd_operador.PES_PESSOA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_PESSOA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: CD_OPERADOR.PES_PESSOA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_PESSOA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_PESSOA = "")
[I1:      4]     4-2            cd_operador.PES_PESSOA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_PESSOA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PES_PESSOA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: DT_INCLUSAO.PES_PESSOA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_INCLUSAO.PES_PESSOA.PES

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <DTLF> from Field: NM_PESSOA.PES_PESSOA.PES

[         1]     1        return (-1)

Trigger <ERRF> from Field: NM_PESSOA.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_CPFCNPJ.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: IN_CONTRIBUINTE.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_INATIVO.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_PRIVADO.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_COLIGADOR.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQEMAIL.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQEND.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQFONE.PES_PESSOA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_ENDRES.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_ENDCOB.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_ENDCOM.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_ENDENT.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_ENDCOR.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_HOMEPAGE.PES_PESSOA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PES_PESFISICA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PES_PESFISICA"))
[I1:      2]     2-1      	$occhandle("PES_PESFISICA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PES_PESFISICA")->PrcOGF()

Trigger <RMO > from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PES_PESFISICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PES_PESFISICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PES_PESFISICA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PES_PESFISICA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PES_PESFISICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PES_PESFISICA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PES_PESFISICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PES_PESFISICA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PES_PESFISICA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PES_PESFISICA = "")
[I2:      4]    18-1            cd_operador.PES_PESFISICA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PES_PESFISICA/init = $datim
[I1:      3]    21        $occhandle("PES_PESFISICA")->PrcVLDO()

Trigger <VLDK> from Entity: PES_PESFISICA.PES

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PES_PESFISICA.PES

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PES_PESFISICA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PES_PESFISICA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PES_PESFISICA.PES

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PES_PESFISICA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PES_PESFISICA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PES_PESFISICA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PES_PESFISICA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PES_PESFISICA")) & ($dbocc("PES_PESFISICA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PES_PESFISICA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PES_PESFISICA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PES_PESFISICA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PES_PESFISICA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PES_PESFISICA",-1
[        90]     2        	erase/e "PES_PESFISICA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PES_PESFISICA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PES_PESFISICA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PES_PESFISICA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PES_PESFISICA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_PESSOA.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.PES_PESFISICA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_PESFISICA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_PESFISICA = "")
[I1:      4]     4-2            cd_operador.PES_PESFISICA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_PESFISICA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PES_PESFISICA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: IN_INATIVO.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_ESTCIVIL.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_SEXO.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_SERIECTPS.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_ORGEXPEDIDOR.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_CTPS.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_CPF.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_RG.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_RENDAMENSAL.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_CARGO.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_ADMISSAO.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_NASCIMENTO.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_LOCALTRAB.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_LOCALNASC.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_NACIONALIDADE.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NM_MAE.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NM_PAI.PES_PESFISICA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PES_PESJURIDICA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PES_PESJURIDICA"))
[I1:      2]     2-1      	$occhandle("PES_PESJURIDICA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PES_PESJURIDICA")->PrcOGF()

Trigger <RMO > from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PES_PESJURIDICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PES_PESJURIDICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PES_PESJURIDICA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PES_PESJURIDICA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PES_PESJURIDICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PES_PESJURIDICA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PES_PESJURIDICA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PES_PESJURIDICA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PES_PESJURIDICA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PES_PESJURIDICA = "")
[I2:      4]    18-1            cd_operador.PES_PESJURIDICA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PES_PESJURIDICA/init = $datim
[I1:      3]    21        $occhandle("PES_PESJURIDICA")->PrcVLDO()

Trigger <VLDK> from Entity: PES_PESJURIDICA.PES

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PES_PESJURIDICA.PES

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PES_PESJURIDICA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PES_PESJURIDICA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PES_PESJURIDICA.PES

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PES_PESJURIDICA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PES_PESJURIDICA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PES_PESJURIDICA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PES_PESJURIDICA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PES_PESJURIDICA")) & ($dbocc("PES_PESJURIDICA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PES_PESJURIDICA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PES_PESJURIDICA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PES_PESJURIDICA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PES_PESJURIDICA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PES_PESJURIDICA",-1
[        90]     2        	erase/e "PES_PESJURIDICA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PES_PESJURIDICA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PES_PESJURIDICA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PES_PESJURIDICA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PES_PESJURIDICA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_PESSOA.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NM_FANTASIA.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.PES_PESJURIDICA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_PESJURIDICA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_PESJURIDICA = "")
[I1:      4]     4-2            cd_operador.PES_PESJURIDICA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_PESJURIDICA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PES_PESJURIDICA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: IN_INATIVO.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_ATIVIDADE.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_FUNCIONARIO.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_CNPJ.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_FATMENSAL.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_INSCESTL.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_FUNDACAO.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_REGIMETRIB.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_CAPITALSOCIAL.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_UF.PES_PESJURIDICA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("CDF_REMTRA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("CDF_REMTRA"))
[I1:      2]     2-1      	$occhandle("CDF_REMTRA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("CDF_REMTRA")->PrcOGF()

Trigger <RMO > from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=CDF_REMTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=CDF_REMTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("CDF_REMTRA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("CDF_REMTRA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=CDF_REMTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("CDF_REMTRA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=CDF_REMTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("CDF_REMTRA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.CDF_REMTRA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.CDF_REMTRA = "")
[I2:      4]    18-1            cd_operador.CDF_REMTRA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.CDF_REMTRA/init = $datim
[I1:      3]    21        $occhandle("CDF_REMTRA")->PrcVLDO()

Trigger <VLDK> from Entity: CDF_REMTRA.CDF

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: CDF_REMTRA.CDF

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(CDF_REMTRA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(CDF_REMTRA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: CDF_REMTRA.CDF

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "CDF_REMTRA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("CDF_REMTRA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "CDF_REMTRA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "CDF_REMTRA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("CDF_REMTRA")) & ($dbocc("CDF_REMTRA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "CDF_REMTRA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "CDF_REMTRA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "CDF_REMTRA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "CDF_REMTRA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "CDF_REMTRA",-1
[        90]     2        	erase/e "CDF_REMTRA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("CDF_REMTRA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("CDF_REMTRA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("CDF_REMTRA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("CDF_REMTRA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPREMESSA.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_REMESSA.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPTRANSACAO.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.CDF_REMTRA.CDF

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.CDF_REMTRA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.CDF_REMTRA = "")
[I1:      4]     4-2            cd_operador.CDF_REMTRA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.CDF_REMTRA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.CDF_REMTRA.CDF

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.CDF_REMTRA.CDF

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: TP_RELACIONAMENTO.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_SITUACAO.CDF_REMTRA.CDF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PES_VENDEDOR")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PES_VENDEDOR"))
[I1:      2]     2-1      	$occhandle("PES_VENDEDOR")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PES_VENDEDOR")->PrcOGF()

Trigger <RMO > from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PES_VENDEDOR OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PES_VENDEDOR.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PES_VENDEDOR OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PES_VENDEDOR")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PES_VENDEDOR")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PES_VENDEDOR OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PES_VENDEDOR")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PES_VENDEDOR OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PES_VENDEDOR"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PES_VENDEDOR/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PES_VENDEDOR = "")
[I2:      4]    18-1            cd_operador.PES_VENDEDOR/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PES_VENDEDOR/init = $datim
[I1:      3]    21        $occhandle("PES_VENDEDOR")->PrcVLDO()

Trigger <VLDK> from Entity: PES_VENDEDOR.PES

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PES_VENDEDOR.PES

[         1]              ;------------------------
[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              	;------------------------
[         4]              	;if ($dbocc(PES_VENDEDOR))
[         5]              	
[         6]              	;else
[         7]              	
[         8]              	;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              	;-----------------------    
[        14]     1-1      	if ($dbocc(PES_VENDEDOR))
[        15]              		
[        16]     2-1      	else
[        17]              		
[        18]     3-1      	endif
[        19]              	
[        20]     4        	return(0)
[        21]     5        End ; operation PrcOGF
[        23]              ;-----------------------------
[        24]******        partner operation posADDINSERT 
[        25]              	;-----------------------------
[        26]              	
[        27]     1        End ; operation posADDINSERT
[        29]              ;------------------------
[        30]******        partner operation posREAD 
[        31]              	;------------------------
[        32]              	variables
[        33]              		string viParams, voParams
[        34]              	endvariables
[        35]              	
[        36]     1        	viParams = ""
[        37]     2        	putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[        38]     3        	putitem/id viParams, "CD_VENDEDOR", CD_VENDEDOR.PES_VENDEDOR
[        39]     4        	activate "PESSVCO015".validaVendedor($$gParamGlb, viParams, voParams, $xCdErro$, $xCtxErro$)
[        40]     5-1      	if ($procerror)       
[        41]     6-1      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        42]     7-1      	elseif ($status < 0)
[        43]     8-1      		$instancehandle->SetStatus(-1, $xCdErro$, $xCtxErro$, "")
[        44]     9-1      	endif          
[        45]    10        	CD_AUXILIAR.PES_VENDEDOR/init = $item("CD_AUXILIAR", voParams)
[        46]              	
[        47]    11        	return(0)
[        48]    12        End ; operation posREAD
[        50]              ;--------------------------
[        51]******        partner operation preREMOVE 
[        52]              	;--------------------------
[        53]              	
[        54]     1        End ; operation preREMOVE
[        56]              ;-------------------------
[        57]******        partner operation preWRITE 
[        58]              	;-------------------------
[        59]              	
[        60]     1        End ; operation preWRITE
[        62]              ;-------------------------
[        63]******        partner operation posWRITE 
[        64]              	;-------------------------
[        65]              	
[        66]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PES_VENDEDOR.PES

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PES_VENDEDOR",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PES_VENDEDOR"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PES_VENDEDOR"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PES_VENDEDOR"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PES_VENDEDOR")) & ($dbocc("PES_VENDEDOR"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PES_VENDEDOR"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PES_VENDEDOR"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PES_VENDEDOR"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PES_VENDEDOR"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PES_VENDEDOR",-1
[        90]     2        	erase/e "PES_VENDEDOR"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PES_VENDEDOR"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PES_VENDEDOR")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PES_VENDEDOR",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PES_VENDEDOR",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_VENDEDOR.PES_VENDEDOR.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.PES_VENDEDOR.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PESSOA.PES_VENDEDOR.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: NM_VENDEDOR.PES_VENDEDOR.PES

[         1]     1        return (-1)

Trigger <ERRF> from Field: NM_VENDEDOR.PES_VENDEDOR.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.PES_VENDEDOR.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_VENDEDOR/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_VENDEDOR = "")
[I1:      4]     4-2            cd_operador.PES_VENDEDOR/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_VENDEDOR/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PES_VENDEDOR.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <DTLE> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PED_PEDIDOTRA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PED_PEDIDOTRA"))
[I1:      2]     2-1      	$occhandle("PED_PEDIDOTRA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PED_PEDIDOTRA")->PrcOGF()

Trigger <RMO > from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PED_PEDIDOTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PED_PEDIDOTRA.PED

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PED_PEDIDOTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PED_PEDIDOTRA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PED_PEDIDOTRA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PED_PEDIDOTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PED_PEDIDOTRA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PED_PEDIDOTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PED_PEDIDOTRA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PED_PEDIDOTRA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PED_PEDIDOTRA = "")
[I2:      4]    18-1            cd_operador.PED_PEDIDOTRA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PED_PEDIDOTRA/init = $datim
[I1:      3]    21        $occhandle("PED_PEDIDOTRA")->PrcVLDO()

Trigger <VLDK> from Entity: PED_PEDIDOTRA.PED

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PED_PEDIDOTRA.PED

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PED_PEDIDOTRA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PED_PEDIDOTRA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PED_PEDIDOTRA.PED

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PED_PEDIDOTRA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PED_PEDIDOTRA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PED_PEDIDOTRA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PED_PEDIDOTRA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PED_PEDIDOTRA")) & ($dbocc("PED_PEDIDOTRA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PED_PEDIDOTRA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PED_PEDIDOTRA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PED_PEDIDOTRA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PED_PEDIDOTRA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PED_PEDIDOTRA",-1
[        90]     2        	erase/e "PED_PEDIDOTRA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PED_PEDIDOTRA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PED_PEDIDOTRA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PED_PEDIDOTRA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PED_PEDIDOTRA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPPEDIDO.PED_PEDIDOTRA.PED

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_PEDIDO.PED_PEDIDOTRA.PED

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <VLDF> from Field: CD_PEDIDO.PED_PEDIDOTRA.PED

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_EMPTRANSACAO.PED_PEDIDOTRA.PED

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAO.PED_PEDIDOTRA.PED

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.PED_PEDIDOTRA.PED

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.PED_PEDIDOTRA.PED

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PED_PEDIDOTRA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PED_PEDIDOTRA = "")
[I1:      4]     4-2            cd_operador.PED_PEDIDOTRA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PED_PEDIDOTRA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PED_PEDIDOTRA.PED

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.PED_PEDIDOTRA.PED

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <DTLE> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("GER_OPERACAO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("GER_OPERACAO"))
[I1:      2]     2-1      	$occhandle("GER_OPERACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("GER_OPERACAO")->PrcOGF()

Trigger <RMO > from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=GER_OPERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=GER_OPERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("GER_OPERACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("GER_OPERACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=GER_OPERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("GER_OPERACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=GER_OPERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("GER_OPERACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.GER_OPERACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.GER_OPERACAO = "")
[I2:      4]    18-1            cd_operador.GER_OPERACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.GER_OPERACAO/init = $datim
[I1:      3]    21        $occhandle("GER_OPERACAO")->PrcVLDO()

Trigger <VLDK> from Entity: GER_OPERACAO.GER

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: GER_OPERACAO.GER

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(GER_OPERACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(GER_OPERACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: GER_OPERACAO.GER

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "GER_OPERACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("GER_OPERACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "GER_OPERACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "GER_OPERACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("GER_OPERACAO")) & ($dbocc("GER_OPERACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "GER_OPERACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "GER_OPERACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "GER_OPERACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "GER_OPERACAO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "GER_OPERACAO",-1
[        90]     2        	erase/e "GER_OPERACAO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("GER_OPERACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("GER_OPERACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("GER_OPERACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("GER_OPERACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_OPERACAO.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.GER_OPERACAO.GER

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.GER_OPERACAO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.GER_OPERACAO = "")
[I1:      4]     4-2            cd_operador.GER_OPERACAO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.GER_OPERACAO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.GER_OPERACAO.GER

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: DS_OPERACAO.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_FISCAL.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_OPERACAO.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_MODALIDADE.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_COMERCIAL.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_REGRAVENDA.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_REGRACOMPRA.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_DOCTO.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_KARDEX.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_FINANCEIRO.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_CALCIMPOSTO.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERFAT.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CFOP.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_HSTCXA.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_HSTFIN.GER_OPERACAO.GER

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PRD_EMBALAGEM")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PRD_EMBALAGEM"))
[I1:      2]     2-1      	$occhandle("PRD_EMBALAGEM")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PRD_EMBALAGEM")->PrcOGF()

Trigger <RMO > from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PRD_EMBALAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PRD_EMBALAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PRD_EMBALAGEM")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PRD_EMBALAGEM")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PRD_EMBALAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PRD_EMBALAGEM")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PRD_EMBALAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PRD_EMBALAGEM"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PRD_EMBALAGEM/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PRD_EMBALAGEM = "")
[I2:      4]    18-1            cd_operador.PRD_EMBALAGEM/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PRD_EMBALAGEM/init = $datim
[I1:      3]    21        $occhandle("PRD_EMBALAGEM")->PrcVLDO()

Trigger <VLDK> from Entity: PRD_EMBALAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PRD_EMBALAGEM.PRD

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PRD_EMBALAGEM))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PRD_EMBALAGEM))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PRD_EMBALAGEM.PRD

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PRD_EMBALAGEM",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PRD_EMBALAGEM"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PRD_EMBALAGEM"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PRD_EMBALAGEM"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PRD_EMBALAGEM")) & ($dbocc("PRD_EMBALAGEM"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PRD_EMBALAGEM"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PRD_EMBALAGEM"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PRD_EMBALAGEM"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        69]     9-3              else
[        70]    10-3      			$instancehandle->PrcCommit("")
[        71]    11-3              endif
[        72]    12-2          endif
[        73]    13-1      else
[        74]    14-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        75]    15-1      endif
[        76]    16        return ($status)
[        77]    17        End ; Operation Salvar
[        79]              ;---------------------------
[        80]******        partner operation Limpar 
[        81]              ;---------------------------
[        82]     1           clear/e "PRD_EMBALAGEM"
[        83]     2        End ; operation Limpar
[        85]              ;---------------------------
[        86]******        partner operation Excluir 
[        87]              ;---------------------------
[        88]     1        	setocc "PRD_EMBALAGEM",-1
[        89]     2        	erase/e "PRD_EMBALAGEM"
[        90]     3-1      	if ($status < 0)
[        91]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        92]     5-1      		rollback
[        93]     6-1      	elseif ($status = 1)
[        94]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        95]     8-1      	endif	
[        96]     9        End ; operation Excluir
[        98]              ;-------------------------------
[        99]******        partner operation ConsultarChave 
[       100]              ;------------------------------- 
[       101]              variables
[       102]                  string viParams,voParams
[       103]              endvariables
[       104]     1-1      if ($instancemod) & (!$foreign("PRD_EMBALAGEM"))
[       105]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       106]     3-1      else 
[       107]     4-1         $status = 1
[       108]     5-1      endif
[       110]     6-1      if ($status = 1)
[       111]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       112]     8-2          if ($procerror)
[       113]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       114]    10-2          else
[       115]    11-3              if (voParams != "")
[       116]    12-3                  $collhandle("PRD_EMBALAGEM")->Limpar()
[       117]    13-3                  $instancehandle->SetChave("PRD_EMBALAGEM",voParams)
[       118]    14-3                  $instancehandle->LMK()
[       119]    15-4                  if ($status < 0)
[       120]    16-4                      set $keycheck("PRD_EMBALAGEM",1)
[       121]    17-4                  endif
[       122]    18-3              endif
[       123]    19-2          endif
[       124]    20-1      else
[       125]    21-1          return (-1)
[       126]    22-1      endif
[       127]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_PRODUTO.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQUENCIA.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.PRD_EMBALAGEM.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PRD_EMBALAGEM/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PRD_EMBALAGEM = "")
[I1:      4]     4-2            cd_operador.PRD_EMBALAGEM/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PRD_EMBALAGEM/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PRD_EMBALAGEM.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: QT_EMBALAGEM.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_EMBALAGEM.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_BARRA.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_COEFICIENTE.PRD_EMBALAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_TROCA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_TROCA"))
[I1:      2]     2-1      	$occhandle("TRA_TROCA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_TROCA")->PrcOGF()

Trigger <RMO > from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_TROCA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_TROCA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_TROCA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_TROCA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_TROCA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_TROCA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_TROCA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_TROCA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_TROCA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_TROCA = "")
[I2:      4]    18-1            cd_operador.TRA_TROCA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_TROCA/init = $datim
[I1:      3]    21        $occhandle("TRA_TROCA")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_TROCA.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_TROCA.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_TROCA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_TROCA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_TROCA.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_TROCA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_TROCA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_TROCA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_TROCA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_TROCA")) & ($dbocc("TRA_TROCA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_TROCA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_TROCA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_TROCA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_TROCA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_TROCA",-1
[        90]     2        	erase/e "TRA_TROCA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_TROCA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_TROCA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_TROCA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_TROCA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPDEV.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRADEV.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRADEV.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPVEN.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRAVEN.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRAVEN.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFATDEV.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GRUPOEMPDEV.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_EMPFATVEN.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GRUPOEMPVEN.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.TRA_TROCA.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_TROCA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_TROCA = "")
[I1:      4]     4-2            cd_operador.TRA_TROCA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_TROCA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_TROCA.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.TRA_TROCA.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: NR_DIFITEM.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_DIFPECAS.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DIFERENCA.TRA_TROCA.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("R_TRA_TRANSACAO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("R_TRA_TRANSACAO"))
[I1:      2]     2-1      	$occhandle("R_TRA_TRANSACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("R_TRA_TRANSACAO")->PrcOGF()

Trigger <RMO > from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=R_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=R_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("R_TRA_TRANSACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("R_TRA_TRANSACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=R_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("R_TRA_TRANSACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=R_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("R_TRA_TRANSACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.R_TRA_TRANSACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.R_TRA_TRANSACAO = "")
[I2:      4]    18-1            cd_operador.R_TRA_TRANSACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.R_TRA_TRANSACAO/init = $datim
[I1:      3]    21        $occhandle("R_TRA_TRANSACAO")->PrcVLDO()

Trigger <VLDK> from Entity: R_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: R_TRA_TRANSACAO.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(R_TRA_TRANSACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(R_TRA_TRANSACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: R_TRA_TRANSACAO.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "R_TRA_TRANSACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("R_TRA_TRANSACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "R_TRA_TRANSACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "R_TRA_TRANSACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("R_TRA_TRANSACAO")) & ($dbocc("R_TRA_TRANSACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "R_TRA_TRANSACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "R_TRA_TRANSACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "R_TRA_TRANSACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "R_TRA_TRANSACAO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "R_TRA_TRANSACAO",-1
[        90]     2        	erase/e "R_TRA_TRANSACAO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("R_TRA_TRANSACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("R_TRA_TRANSACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("R_TRA_TRANSACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("R_TRA_TRANSACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PESSOA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERACAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CONDPGTO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFAT.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_GRUPOEMPRESA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_MODELOTRA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <VLDF> from Field: CD_MODELOTRA.R_TRA_TRANSACAO.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_OPERADOR.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_CADASTRO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_SITUACAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_ORIGEMEMISSAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQENDERECO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPRESAORI.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAOORI.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAOORI.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USURELAC.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUCONF.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_GUIA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_REPRESENTANT.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_COMPVEND.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUIMPRESSAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_IMPRESSAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_IMPRESSAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_OPERACAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_FRETE.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_ACEITADEV.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_DESCONTO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_SOLICITADA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_PREVENTREGA.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_VALIDADE.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_ULTATEND.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TRANSACAO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESCONTO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESPACESSOR.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_FRETE.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_SEGURO.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEICMS.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ICMS.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEICMSSUBST.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ICMSSUBST.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_IPI.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: VL_TOTAL.R_TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_TOTAL.R_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PES_RELACAOVENDA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PES_RELACAOVENDA"))
[I1:      2]     2-1      	$occhandle("PES_RELACAOVENDA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PES_RELACAOVENDA")->PrcOGF()

Trigger <RMO > from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PES_RELACAOVENDA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PES_RELACAOVENDA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PES_RELACAOVENDA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PES_RELACAOVENDA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PES_RELACAOVENDA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PES_RELACAOVENDA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PES_RELACAOVENDA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PES_RELACAOVENDA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PES_RELACAOVENDA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PES_RELACAOVENDA = "")
[I2:      4]    18-1            cd_operador.PES_RELACAOVENDA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PES_RELACAOVENDA/init = $datim
[I1:      3]    21        $occhandle("PES_RELACAOVENDA")->PrcVLDO()

Trigger <VLDK> from Entity: PES_RELACAOVENDA.PES

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PES_RELACAOVENDA.PES

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PES_RELACAOVENDA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PES_RELACAOVENDA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PES_RELACAOVENDA.PES

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PES_RELACAOVENDA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PES_RELACAOVENDA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PES_RELACAOVENDA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PES_RELACAOVENDA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PES_RELACAOVENDA")) & ($dbocc("PES_RELACAOVENDA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PES_RELACAOVENDA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PES_RELACAOVENDA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PES_RELACAOVENDA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PES_RELACAOVENDA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PES_RELACAOVENDA",-1
[        90]     2        	erase/e "PES_RELACAOVENDA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PES_RELACAOVENDA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PES_RELACAOVENDA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PES_RELACAOVENDA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PES_RELACAOVENDA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_MOVIMENTO.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_SEQUENCIA.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_CLIENTE.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.PES_RELACAOVENDA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_RELACAOVENDA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_RELACAOVENDA = "")
[I1:      4]     4-2            cd_operador.PES_RELACAOVENDA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_RELACAOVENDA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PES_RELACAOVENDA.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.PES_RELACAOVENDA.PES

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_GUIA.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_VENDEDOR.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_REPRESENTANTE.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_TIPO.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_LOCAL.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: HR_HORAENTRADA.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_OBS.PES_RELACAOVENDA.PES

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <VLDF> from Field: DS_OBS.PES_RELACAOVENDA.PES

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <DTLE> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_LIMDESCONTO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_LIMDESCONTO"))
[I1:      2]     2-1      	$occhandle("TRA_LIMDESCONTO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_LIMDESCONTO")->PrcOGF()

Trigger <RMO > from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_LIMDESCONTO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_LIMDESCONTO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_LIMDESCONTO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_LIMDESCONTO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_LIMDESCONTO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_LIMDESCONTO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_LIMDESCONTO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_LIMDESCONTO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_LIMDESCONTO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_LIMDESCONTO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_LIMDESCONTO = "")
[I2:      4]    18-1            cd_operador.TRA_LIMDESCONTO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_LIMDESCONTO/init = $datim
[I1:      3]    21        $occhandle("TRA_LIMDESCONTO")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_LIMDESCONTO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_LIMDESCONTO.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_LIMDESCONTO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_LIMDESCONTO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_LIMDESCONTO.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_LIMDESCONTO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_LIMDESCONTO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_LIMDESCONTO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_LIMDESCONTO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_LIMDESCONTO")) & ($dbocc("TRA_LIMDESCONTO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_LIMDESCONTO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_LIMDESCONTO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_LIMDESCONTO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_LIMDESCONTO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_LIMDESCONTO",-1
[        90]     2        	erase/e "TRA_LIMDESCONTO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_LIMDESCONTO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_LIMDESCONTO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_LIMDESCONTO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_LIMDESCONTO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_OPERACAO.TRA_LIMDESCONTO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUARIO.TRA_LIMDESCONTO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_LIMDESCONTO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_DESCMAX.TRA_LIMDESCONTO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.TRA_LIMDESCONTO.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_LIMDESCONTO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_LIMDESCONTO = "")
[I1:      4]     4-2            cd_operador.TRA_LIMDESCONTO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_LIMDESCONTO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_LIMDESCONTO.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <DTLE> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PRD_PRDIMAGEM")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PRD_PRDIMAGEM"))
[I1:      2]     2-1      	$occhandle("PRD_PRDIMAGEM")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PRD_PRDIMAGEM")->PrcOGF()

Trigger <RMO > from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PRD_PRDIMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PRD_PRDIMAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PRD_PRDIMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PRD_PRDIMAGEM")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PRD_PRDIMAGEM")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PRD_PRDIMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PRD_PRDIMAGEM")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PRD_PRDIMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PRD_PRDIMAGEM"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PRD_PRDIMAGEM/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PRD_PRDIMAGEM = "")
[I2:      4]    18-1            cd_operador.PRD_PRDIMAGEM/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PRD_PRDIMAGEM/init = $datim
[I1:      3]    21        $occhandle("PRD_PRDIMAGEM")->PrcVLDO()

Trigger <VLDK> from Entity: PRD_PRDIMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PRD_PRDIMAGEM.PRD

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PRD_PRDIMAGEM))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PRD_PRDIMAGEM))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PRD_PRDIMAGEM.PRD

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PRD_PRDIMAGEM",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PRD_PRDIMAGEM"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PRD_PRDIMAGEM"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PRD_PRDIMAGEM"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PRD_PRDIMAGEM")) & ($dbocc("PRD_PRDIMAGEM"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PRD_PRDIMAGEM"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PRD_PRDIMAGEM"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PRD_PRDIMAGEM"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        69]     9-3              else
[        70]    10-3      			$instancehandle->PrcCommit("")
[        71]    11-3              endif
[        72]    12-2          endif
[        73]    13-1      else
[        74]    14-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        75]    15-1      endif
[        76]    16        return ($status)
[        77]    17        End ; Operation Salvar
[        79]              ;---------------------------
[        80]******        partner operation Limpar 
[        81]              ;---------------------------
[        82]     1           clear/e "PRD_PRDIMAGEM"
[        83]     2        End ; operation Limpar
[        85]              ;---------------------------
[        86]******        partner operation Excluir 
[        87]              ;---------------------------
[        88]     1        	setocc "PRD_PRDIMAGEM",-1
[        89]     2        	erase/e "PRD_PRDIMAGEM"
[        90]     3-1      	if ($status < 0)
[        91]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        92]     5-1      		rollback
[        93]     6-1      	elseif ($status = 1)
[        94]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        95]     8-1      	endif	
[        96]     9        End ; operation Excluir
[        98]              ;-------------------------------
[        99]******        partner operation ConsultarChave 
[       100]              ;------------------------------- 
[       101]              variables
[       102]                  string viParams,voParams
[       103]              endvariables
[       104]     1-1      if ($instancemod) & (!$foreign("PRD_PRDIMAGEM"))
[       105]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       106]     3-1      else 
[       107]     4-1         $status = 1
[       108]     5-1      endif
[       110]     6-1      if ($status = 1)
[       111]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       112]     8-2          if ($procerror)
[       113]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       114]    10-2          else
[       115]    11-3              if (voParams != "")
[       116]    12-3                  $collhandle("PRD_PRDIMAGEM")->Limpar()
[       117]    13-3                  $instancehandle->SetChave("PRD_PRDIMAGEM",voParams)
[       118]    14-3                  $instancehandle->LMK()
[       119]    15-4                  if ($status < 0)
[       120]    16-4                      set $keycheck("PRD_PRDIMAGEM",1)
[       121]    17-4                  endif
[       122]    18-3              endif
[       123]    19-2          endif
[       124]    20-1      else
[       125]    21-1          return (-1)
[       126]    22-1      endif
[       127]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_PRODUTO.PRD_PRDIMAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.PRD_PRDIMAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.PRD_PRDIMAGEM.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PRD_PRDIMAGEM/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PRD_PRDIMAGEM = "")
[I1:      4]     4-2            cd_operador.PRD_PRDIMAGEM/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PRD_PRDIMAGEM/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PRD_PRDIMAGEM.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.PRD_PRDIMAGEM.PRD

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: IN_PADRAO.PRD_PRDIMAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PRD_IMAGEM")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PRD_IMAGEM"))
[I1:      2]     2-1      	$occhandle("PRD_IMAGEM")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PRD_IMAGEM")->PrcOGF()

Trigger <RMO > from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PRD_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PRD_IMAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PRD_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PRD_IMAGEM")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PRD_IMAGEM")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PRD_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PRD_IMAGEM")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PRD_IMAGEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PRD_IMAGEM"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PRD_IMAGEM/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PRD_IMAGEM = "")
[I2:      4]    18-1            cd_operador.PRD_IMAGEM/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PRD_IMAGEM/init = $datim
[I1:      3]    21        $occhandle("PRD_IMAGEM")->PrcVLDO()

Trigger <VLDK> from Entity: PRD_IMAGEM.PRD

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PRD_IMAGEM.PRD

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PRD_IMAGEM))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PRD_IMAGEM))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PRD_IMAGEM.PRD

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PRD_IMAGEM",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PRD_IMAGEM"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PRD_IMAGEM"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PRD_IMAGEM"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PRD_IMAGEM")) & ($dbocc("PRD_IMAGEM"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PRD_IMAGEM"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PRD_IMAGEM"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PRD_IMAGEM"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        69]     9-3              else
[        70]    10-3      			$instancehandle->PrcCommit("")
[        71]    11-3              endif
[        72]    12-2          endif
[        73]    13-1      else
[        74]    14-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        75]    15-1      endif
[        76]    16        return ($status)
[        77]    17        End ; Operation Salvar
[        79]              ;---------------------------
[        80]******        partner operation Limpar 
[        81]              ;---------------------------
[        82]     1           clear/e "PRD_IMAGEM"
[        83]     2        End ; operation Limpar
[        85]              ;---------------------------
[        86]******        partner operation Excluir 
[        87]              ;---------------------------
[        88]     1        	setocc "PRD_IMAGEM",-1
[        89]     2        	erase/e "PRD_IMAGEM"
[        90]     3-1      	if ($status < 0)
[        91]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        92]     5-1      		rollback
[        93]     6-1      	elseif ($status = 1)
[        94]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        95]     8-1      	endif	
[        96]     9        End ; operation Excluir
[        98]              ;-------------------------------
[        99]******        partner operation ConsultarChave 
[       100]              ;------------------------------- 
[       101]              variables
[       102]                  string viParams,voParams
[       103]              endvariables
[       104]     1-1      if ($instancemod) & (!$foreign("PRD_IMAGEM"))
[       105]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       106]     3-1      else 
[       107]     4-1         $status = 1
[       108]     5-1      endif
[       110]     6-1      if ($status = 1)
[       111]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       112]     8-2          if ($procerror)
[       113]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       114]    10-2          else
[       115]    11-3              if (voParams != "")
[       116]    12-3                  $collhandle("PRD_IMAGEM")->Limpar()
[       117]    13-3                  $instancehandle->SetChave("PRD_IMAGEM",voParams)
[       118]    14-3                  $instancehandle->LMK()
[       119]    15-4                  if ($status < 0)
[       120]    16-4                      set $keycheck("PRD_IMAGEM",1)
[       121]    17-4                  endif
[       122]    18-3              endif
[       123]    19-2          endif
[       124]    20-1      else
[       125]    21-1          return (-1)
[       126]    22-1      endif
[       127]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: U_VERSION.PRD_IMAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.PRD_IMAGEM.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PRD_IMAGEM/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PRD_IMAGEM = "")
[I1:      4]     4-2            cd_operador.PRD_IMAGEM/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PRD_IMAGEM/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PRD_IMAGEM.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.PRD_IMAGEM.PRD

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: NM_IMAGEM.PRD_IMAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_IMAGEM.PRD_IMAGEM.PRD

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: S_DS_ARQUIVO.PRD_IMAGEM.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <FXTG> from Field: S_DS_ARQUIVO.PRD_IMAGEM.PRD

[         1]              ; -- start triggers for picture widget 
[         3]******        trigger moveTo
[         4]              params
[         5]                string dragvalue: in
[         6]                string dropformat: in
[         7]                string itemvalue: in
[         8]                numeric numberofobjects: in
[         9]                numeric index: in
[        10]              endparams
[        12]     1        end ; trigger moveTo
[        14]******        trigger moveFrom
[        15]              params
[        16]                string dragvalue: in
[        17]                string dropformat: in
[        18]                numeric numberofobjects: in
[        19]                numeric index: in
[        20]              endparams
[        22]     1        end ; trigger moveFrom
[        24]******        trigger moveWithin
[        25]              params
[        26]                string dragvalue: in
[        27]                string dropformat: in
[        28]                string itemvalue: in
[        29]                numeric numberofobjects: in
[        30]                numeric index: in
[        31]              endparams
[        33]     1        end ; trigger moveWithin
[        35]******        trigger copyTo
[        36]              params
[        37]                string dragvalue: in
[        38]                string dropformat: in
[        39]                string itemvalue: in
[        40]                numeric numberofobjects: in
[        41]                numeric index: in
[        42]              endparams
[        44]     1        end ; trigger copyTo
[        46]******        trigger createShortcutTo
[        47]              params
[        48]                string dragvalue: in
[        49]                string dropformat: in
[        50]                string itemvalue: in
[        51]                numeric numberofobjects: in
[        52]                numeric index: in
[        53]              endparams
[        55]     1        end ; trigger createShortcutTo
[        57]              ; -- end triggers for picture widget

Trigger <DTLE> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("FIS_ITEMCONSIGTRA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("FIS_ITEMCONSIGTRA"))
[I1:      2]     2-1      	$occhandle("FIS_ITEMCONSIGTRA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("FIS_ITEMCONSIGTRA")->PrcOGF()

Trigger <RMO > from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=FIS_ITEMCONSIGTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=FIS_ITEMCONSIGTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("FIS_ITEMCONSIGTRA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("FIS_ITEMCONSIGTRA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=FIS_ITEMCONSIGTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("FIS_ITEMCONSIGTRA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=FIS_ITEMCONSIGTRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("FIS_ITEMCONSIGTRA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.FIS_ITEMCONSIGTRA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.FIS_ITEMCONSIGTRA = "")
[I2:      4]    18-1            cd_operador.FIS_ITEMCONSIGTRA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.FIS_ITEMCONSIGTRA/init = $datim
[I1:      3]    21        $occhandle("FIS_ITEMCONSIGTRA")->PrcVLDO()

Trigger <VLDK> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(FIS_ITEMCONSIGTRA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(FIS_ITEMCONSIGTRA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: FIS_ITEMCONSIGTRA.FIS

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "FIS_ITEMCONSIGTRA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("FIS_ITEMCONSIGTRA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "FIS_ITEMCONSIGTRA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "FIS_ITEMCONSIGTRA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("FIS_ITEMCONSIGTRA")) & ($dbocc("FIS_ITEMCONSIGTRA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "FIS_ITEMCONSIGTRA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "FIS_ITEMCONSIGTRA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "FIS_ITEMCONSIGTRA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "FIS_ITEMCONSIGTRA"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "FIS_ITEMCONSIGTRA",-1
[        90]     2        	erase/e "FIS_ITEMCONSIGTRA"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("FIS_ITEMCONSIGTRA"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("FIS_ITEMCONSIGTRA")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("FIS_ITEMCONSIGTRA",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("FIS_ITEMCONSIGTRA",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_FATURA.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_FATURA.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_ITEM.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PRODUTO.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPTRA.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.FIS_ITEMCONSIGTRA.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.FIS_ITEMCONSIGTRA.FIS

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.FIS_ITEMCONSIGTRA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.FIS_ITEMCONSIGTRA = "")
[I1:      4]     4-2            cd_operador.FIS_ITEMCONSIGTRA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.FIS_ITEMCONSIGTRA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.FIS_ITEMCONSIGTRA.FIS

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.FIS_ITEMCONSIGTRA.FIS

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <DTLE> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("ADM_USUOPERCMP")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("ADM_USUOPERCMP"))
[I1:      2]     2-1      	$occhandle("ADM_USUOPERCMP")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("ADM_USUOPERCMP")->PrcOGF()

Trigger <RMO > from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=ADM_USUOPERCMP OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: ADM_USUOPERCMP.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=ADM_USUOPERCMP OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("ADM_USUOPERCMP")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("ADM_USUOPERCMP")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=ADM_USUOPERCMP OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("ADM_USUOPERCMP")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=ADM_USUOPERCMP OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("ADM_USUOPERCMP"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.ADM_USUOPERCMP/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.ADM_USUOPERCMP = "")
[I2:      4]    18-1            cd_operador.ADM_USUOPERCMP/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.ADM_USUOPERCMP/init = $datim
[I1:      3]    21        $occhandle("ADM_USUOPERCMP")->PrcVLDO()

Trigger <VLDK> from Entity: ADM_USUOPERCMP.ADM

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: ADM_USUOPERCMP.ADM

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(ADM_USUOPERCMP))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(ADM_USUOPERCMP))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: ADM_USUOPERCMP.ADM

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "ADM_USUOPERCMP",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("ADM_USUOPERCMP"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "ADM_USUOPERCMP"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "ADM_USUOPERCMP"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("ADM_USUOPERCMP")) & ($dbocc("ADM_USUOPERCMP"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "ADM_USUOPERCMP"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "ADM_USUOPERCMP"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "ADM_USUOPERCMP"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "ADM_USUOPERCMP"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "ADM_USUOPERCMP",-1
[        90]     2        	erase/e "ADM_USUOPERCMP"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("ADM_USUOPERCMP"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("ADM_USUOPERCMP")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("ADM_USUOPERCMP",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("ADM_USUOPERCMP",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.ADM_USUOPERCMP.ADM

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_USUARIO.ADM_USUOPERCMP.ADM

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_COMPONENTE.ADM_USUOPERCMP.ADM

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERACAO.ADM_USUOPERCMP.ADM

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.ADM_USUOPERCMP.ADM

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.ADM_USUOPERCMP.ADM

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.ADM_USUOPERCMP/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.ADM_USUOPERCMP = "")
[I1:      4]     4-2            cd_operador.ADM_USUOPERCMP/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.ADM_USUOPERCMP/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.ADM_USUOPERCMP.ADM

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.ADM_USUOPERCMP.ADM

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <DTLE> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("ADM_USUARIO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("ADM_USUARIO"))
[I1:      2]     2-1      	$occhandle("ADM_USUARIO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("ADM_USUARIO")->PrcOGF()

Trigger <RMO > from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=ADM_USUARIO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=ADM_USUARIO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("ADM_USUARIO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("ADM_USUARIO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=ADM_USUARIO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("ADM_USUARIO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=ADM_USUARIO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("ADM_USUARIO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.ADM_USUARIO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.ADM_USUARIO = "")
[I2:      4]    18-1            cd_operador.ADM_USUARIO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.ADM_USUARIO/init = $datim
[I1:      3]    21        $occhandle("ADM_USUARIO")->PrcVLDO()

Trigger <VLDK> from Entity: ADM_USUARIO.ADM

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: ADM_USUARIO.ADM

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(ADM_USUARIO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(ADM_USUARIO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: ADM_USUARIO.ADM

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "ADM_USUARIO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("ADM_USUARIO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "ADM_USUARIO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "ADM_USUARIO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("ADM_USUARIO")) & ($dbocc("ADM_USUARIO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "ADM_USUARIO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "ADM_USUARIO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "ADM_USUARIO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "ADM_USUARIO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "ADM_USUARIO",-1
[        90]     2        	erase/e "ADM_USUARIO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("ADM_USUARIO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("ADM_USUARIO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("ADM_USUARIO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("ADM_USUARIO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_USUARIO.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_SENHA.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NM_LOGIN.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NM_USUARIO.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_BLOQUEIO.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_PRIVILEGIO.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.ADM_USUARIO.ADM

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.ADM_USUARIO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.ADM_USUARIO = "")
[I1:      4]     4-2            cd_operador.ADM_USUARIO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.ADM_USUARIO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.ADM_USUARIO.ADM

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: DT_BLOQUEIO.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_FUNCIONARIO.ADM_USUARIO.ADM

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("GER_TERMINAL")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("GER_TERMINAL"))
[I1:      2]     2-1      	$occhandle("GER_TERMINAL")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("GER_TERMINAL")->PrcOGF()

Trigger <RMO > from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=GER_TERMINAL OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: GER_TERMINAL.GER

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=GER_TERMINAL OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("GER_TERMINAL")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("GER_TERMINAL")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=GER_TERMINAL OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("GER_TERMINAL")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=GER_TERMINAL OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("GER_TERMINAL"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.GER_TERMINAL/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.GER_TERMINAL = "")
[I2:      4]    18-1            cd_operador.GER_TERMINAL/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.GER_TERMINAL/init = $datim
[I1:      3]    21        $occhandle("GER_TERMINAL")->PrcVLDO()

Trigger <VLDK> from Entity: GER_TERMINAL.GER

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: GER_TERMINAL.GER

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(GER_TERMINAL))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(GER_TERMINAL))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: GER_TERMINAL.GER

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "GER_TERMINAL",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("GER_TERMINAL"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "GER_TERMINAL"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "GER_TERMINAL"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("GER_TERMINAL")) & ($dbocc("GER_TERMINAL"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "GER_TERMINAL"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "GER_TERMINAL"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "GER_TERMINAL"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "GER_TERMINAL"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "GER_TERMINAL",-1
[        90]     2        	erase/e "GER_TERMINAL"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("GER_TERMINAL"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("GER_TERMINAL")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("GER_TERMINAL",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("GER_TERMINAL",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.GER_TERMINAL.GER

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.GER_TERMINAL.GER

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.GER_TERMINAL.GER

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.GER_TERMINAL/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.GER_TERMINAL = "")
[I1:      4]     4-2            cd_operador.GER_TERMINAL/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.GER_TERMINAL/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.GER_TERMINAL.GER

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.GER_TERMINAL.GER

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: DS_TERMINAL.GER_TERMINAL.GER

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TMP_NR09")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TMP_NR09"))
[I1:      2]     2-1      	$occhandle("TMP_NR09")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TMP_NR09")->PrcOGF()

Trigger <RMO > from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TMP_NR09 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TMP_NR09.TMP

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TMP_NR09 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TMP_NR09")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TMP_NR09")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TMP_NR09 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TMP_NR09")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TMP_NR09 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDK> from Entity: TMP_NR09.TMP

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TMP_NR09.TMP

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TMP_NR09))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TMP_NR09))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TMP_NR09.TMP

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TMP_NR09",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TMP_NR09"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TMP_NR09"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TMP_NR09"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TMP_NR09")) & ($dbocc("TMP_NR09"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TMP_NR09"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TMP_NR09"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TMP_NR09"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        69]     9-3              else
[        70]    10-3      			$instancehandle->PrcCommit("")
[        71]    11-3              endif
[        72]    12-2          endif
[        73]    13-1      else
[        74]    14-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        75]    15-1      endif
[        76]    16        return ($status)
[        77]    17        End ; Operation Salvar
[        79]              ;---------------------------
[        80]******        partner operation Limpar 
[        81]              ;---------------------------
[        82]     1           clear/e "TMP_NR09"
[        83]     2        End ; operation Limpar
[        85]              ;---------------------------
[        86]******        partner operation Excluir 
[        87]              ;---------------------------
[        88]     1        	setocc "TMP_NR09",-1
[        89]     2        	erase/e "TMP_NR09"
[        90]     3-1      	if ($status < 0)
[        91]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        92]     5-1      		rollback
[        93]     6-1      	elseif ($status = 1)
[        94]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        95]     8-1      	endif	
[        96]     9        End ; operation Excluir
[        98]              ;-------------------------------
[        99]******        partner operation ConsultarChave 
[       100]              ;------------------------------- 
[       101]              variables
[       102]                  string viParams,voParams
[       103]              endvariables
[       104]     1-1      if ($instancemod) & (!$foreign("TMP_NR09"))
[       105]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       106]     3-1      else 
[       107]     4-1         $status = 1
[       108]     5-1      endif
[       110]     6-1      if ($status = 1)
[       111]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       112]     8-2          if ($procerror)
[       113]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       114]    10-2          else
[       115]    11-3              if (voParams != "")
[       116]    12-3                  $collhandle("TMP_NR09")->Limpar()
[       117]    13-3                  $instancehandle->SetChave("TMP_NR09",voParams)
[       118]    14-3                  $instancehandle->LMK()
[       119]    15-4                  if ($status < 0)
[       120]    16-4                      set $keycheck("TMP_NR09",1)
[       121]    17-4                  endif
[       122]    18-3              endif
[       123]    19-2          endif
[       124]    20-1      else
[       125]    21-1          return (-1)
[       126]    22-1      endif
[       127]    23        End ; operation ConsultarChave

Trigger <DTLE> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_TRANSCONDPGTOH")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_TRANSCONDPGTOH"))
[I1:      2]     2-1      	$occhandle("TRA_TRANSCONDPGTOH")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_TRANSCONDPGTOH")->PrcOGF()

Trigger <RMO > from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_TRANSCONDPGTOH OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_TRANSCONDPGTOH OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_TRANSCONDPGTOH")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_TRANSCONDPGTOH")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_TRANSCONDPGTOH OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_TRANSCONDPGTOH")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_TRANSCONDPGTOH OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_TRANSCONDPGTOH"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_TRANSCONDPGTOH/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_TRANSCONDPGTOH = "")
[I2:      4]    18-1            cd_operador.TRA_TRANSCONDPGTOH/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_TRANSCONDPGTOH/init = $datim
[I1:      3]    21        $occhandle("TRA_TRANSCONDPGTOH")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_TRANSCONDPGTOH))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_TRANSCONDPGTOH))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_TRANSCONDPGTOH.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_TRANSCONDPGTOH",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_TRANSCONDPGTOH"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_TRANSCONDPGTOH"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_TRANSCONDPGTOH"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_TRANSCONDPGTOH")) & ($dbocc("TRA_TRANSCONDPGTOH"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_TRANSCONDPGTOH"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_TRANSCONDPGTOH"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_TRANSCONDPGTOH"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_TRANSCONDPGTOH"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_TRANSCONDPGTOH",-1
[        90]     2        	erase/e "TRA_TRANSCONDPGTOH"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_TRANSCONDPGTOH"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_TRANSCONDPGTOH")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_TRANSCONDPGTOH",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_TRANSCONDPGTOH",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_CONDPGTO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_SEQHISTRELSUB.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.TRA_TRANSCONDPGTOH.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_TRANSCONDPGTOH/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_TRANSCONDPGTOH = "")
[I1:      4]     4-2            cd_operador.TRA_TRANSCONDPGTOH/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_TRANSCONDPGTOH/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_TRANSCONDPGTOH.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: VL_ENTRADA.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_CREDEV.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ADIANTAMENTO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESCONTO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_DESCONTO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_BASE.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ACRESCIMO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_ACRESCIMO.TRA_TRANSCONDPGTOH.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_LIBERACAO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_LIBERACAO"))
[I1:      2]     2-1      	$occhandle("TRA_LIBERACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_LIBERACAO")->PrcOGF()

Trigger <RMO > from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_LIBERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_LIBERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_LIBERACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_LIBERACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_LIBERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_LIBERACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_LIBERACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_LIBERACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_LIBERACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_LIBERACAO = "")
[I2:      4]    18-1            cd_operador.TRA_LIBERACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_LIBERACAO/init = $datim
[I1:      3]    21        $occhandle("TRA_LIBERACAO")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_LIBERACAO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_LIBERACAO.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_LIBERACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_LIBERACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_LIBERACAO.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_LIBERACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_LIBERACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_LIBERACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_LIBERACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_LIBERACAO")) & ($dbocc("TRA_LIBERACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_LIBERACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_LIBERACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_LIBERACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_LIBERACAO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_LIBERACAO",-1
[        90]     2        	erase/e "TRA_LIBERACAO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_LIBERACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_LIBERACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_LIBERACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_LIBERACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFAT.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GRUPOEMPRESA.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.TRA_LIBERACAO.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_LIBERACAO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_LIBERACAO = "")
[I1:      4]     4-2            cd_operador.TRA_LIBERACAO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_LIBERACAO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_LIBERACAO.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: CD_LIBERADOR.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_LIBERACAO.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TRANSACAO.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_LIMITE.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_LIMLIBERADOR.TRA_LIBERACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PRD_CODIGOBARRA")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PRD_CODIGOBARRA"))
[I1:      2]     2-1      	$occhandle("PRD_CODIGOBARRA")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PRD_CODIGOBARRA")->PrcOGF()

Trigger <RMO > from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PRD_CODIGOBARRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PRD_CODIGOBARRA.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PRD_CODIGOBARRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PRD_CODIGOBARRA")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PRD_CODIGOBARRA")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PRD_CODIGOBARRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PRD_CODIGOBARRA")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PRD_CODIGOBARRA OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PRD_CODIGOBARRA"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PRD_CODIGOBARRA/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PRD_CODIGOBARRA = "")
[I2:      4]    18-1            cd_operador.PRD_CODIGOBARRA/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PRD_CODIGOBARRA/init = $datim
[I1:      3]    21        $occhandle("PRD_CODIGOBARRA")->PrcVLDO()

Trigger <VLDK> from Entity: PRD_CODIGOBARRA.PRD

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PRD_CODIGOBARRA.PRD

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PRD_CODIGOBARRA))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PRD_CODIGOBARRA))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PRD_CODIGOBARRA.PRD

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PRD_CODIGOBARRA",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PRD_CODIGOBARRA"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PRD_CODIGOBARRA"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PRD_CODIGOBARRA"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PRD_CODIGOBARRA")) & ($dbocc("PRD_CODIGOBARRA"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PRD_CODIGOBARRA"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PRD_CODIGOBARRA"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PRD_CODIGOBARRA"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        69]     9-3              else
[        70]    10-3      			$instancehandle->PrcCommit("")
[        71]    11-3              endif
[        72]    12-2          endif
[        73]    13-1      else
[        74]    14-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        75]    15-1      endif
[        76]    16        return ($status)
[        77]    17        End ; Operation Salvar
[        79]              ;---------------------------
[        80]******        partner operation Limpar 
[        81]              ;---------------------------
[        82]     1           clear/e "PRD_CODIGOBARRA"
[        83]     2        End ; operation Limpar
[        85]              ;---------------------------
[        86]******        partner operation Excluir 
[        87]              ;---------------------------
[        88]     1        	setocc "PRD_CODIGOBARRA",-1
[        89]     2        	erase/e "PRD_CODIGOBARRA"
[        90]     3-1      	if ($status < 0)
[        91]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        92]     5-1      		rollback
[        93]     6-1      	elseif ($status = 1)
[        94]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        95]     8-1      	endif	
[        96]     9        End ; operation Excluir
[        98]              ;-------------------------------
[        99]******        partner operation ConsultarChave 
[       100]              ;------------------------------- 
[       101]              variables
[       102]                  string viParams,voParams
[       103]              endvariables
[       104]     1-1      if ($instancemod) & (!$foreign("PRD_CODIGOBARRA"))
[       105]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       106]     3-1      else 
[       107]     4-1         $status = 1
[       108]     5-1      endif
[       110]     6-1      if ($status = 1)
[       111]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       112]     8-2          if ($procerror)
[       113]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       114]    10-2          else
[       115]    11-3              if (voParams != "")
[       116]    12-3                  $collhandle("PRD_CODIGOBARRA")->Limpar()
[       117]    13-3                  $instancehandle->SetChave("PRD_CODIGOBARRA",voParams)
[       118]    14-3                  $instancehandle->LMK()
[       119]    15-4                  if ($status < 0)
[       120]    16-4                      set $keycheck("PRD_CODIGOBARRA",1)
[       121]    17-4                  endif
[       122]    18-3              endif
[       123]    19-2          endif
[       124]    20-1      else
[       125]    21-1          return (-1)
[       126]    22-1      endif
[       127]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: U_VERSION.PRD_CODIGOBARRA.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PRODUTO.PRD_CODIGOBARRA.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_EMBALAGEM.PRD_CODIGOBARRA.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.PRD_CODIGOBARRA.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PRD_CODIGOBARRA/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PRD_CODIGOBARRA = "")
[I1:      4]     4-2            cd_operador.PRD_CODIGOBARRA/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PRD_CODIGOBARRA/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PRD_CODIGOBARRA.PRD

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: IN_PADRAO.PRD_CODIGOBARRA.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_BARRA.PRD_CODIGOBARRA.PRD

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_S_TRANSITEM")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_S_TRANSITEM"))
[I1:      2]     2-1      	$occhandle("TRA_S_TRANSITEM")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_S_TRANSITEM")->PrcOGF()

Trigger <RMO > from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_S_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_S_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_S_TRANSITEM")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_S_TRANSITEM")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_S_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_S_TRANSITEM")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_S_TRANSITEM OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_S_TRANSITEM"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_S_TRANSITEM/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_S_TRANSITEM = "")
[I2:      4]    18-1            cd_operador.TRA_S_TRANSITEM/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_S_TRANSITEM/init = $datim
[I1:      3]    21        $occhandle("TRA_S_TRANSITEM")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_S_TRANSITEM.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_S_TRANSITEM.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_S_TRANSITEM))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_S_TRANSITEM))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_S_TRANSITEM.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_S_TRANSITEM",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_S_TRANSITEM"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_S_TRANSITEM"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_S_TRANSITEM"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_S_TRANSITEM")) & ($dbocc("TRA_S_TRANSITEM"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_S_TRANSITEM"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_S_TRANSITEM"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_S_TRANSITEM"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_S_TRANSITEM"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_S_TRANSITEM",-1
[        90]     2        	erase/e "TRA_S_TRANSITEM"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_S_TRANSITEM"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_S_TRANSITEM")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_S_TRANSITEM",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_S_TRANSITEM",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_ITEM.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFAT.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_GRUPOEMPRESA.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_CADASTRO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_TIPI.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CFOP.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PRODUTO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PROMOCAO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_DECRETO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_COMPVEND.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_ESPECIE.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CST.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_DESCONTO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_DESCONTO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_PRODUTO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_BARRAPRD.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_SOLICITADA.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_ATENDIDA.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_SALDO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_ANTERIOR.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALBRUTO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALLIQUIDO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALDESC.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTALDESCCAB.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITBRUTO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITLIQUIDO.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITDESCCAB.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITDESC.TRA_S_TRANSITEM.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TMP_NR10")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TMP_NR10"))
[I1:      2]     2-1      	$occhandle("TMP_NR10")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TMP_NR10")->PrcOGF()

Trigger <RMO > from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TMP_NR10 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TMP_NR10.TMP

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TMP_NR10 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TMP_NR10")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TMP_NR10")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TMP_NR10 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TMP_NR10")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TMP_NR10 OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDK> from Entity: TMP_NR10.TMP

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TMP_NR10.TMP

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TMP_NR10))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TMP_NR10))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TMP_NR10.TMP

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TMP_NR10",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TMP_NR10"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TMP_NR10"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TMP_NR10"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TMP_NR10")) & ($dbocc("TMP_NR10"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TMP_NR10"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TMP_NR10"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TMP_NR10"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        69]     9-3              else
[        70]    10-3      			$instancehandle->PrcCommit("")
[        71]    11-3              endif
[        72]    12-2          endif
[        73]    13-1      else
[        74]    14-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        75]    15-1      endif
[        76]    16        return ($status)
[        77]    17        End ; Operation Salvar
[        79]              ;---------------------------
[        80]******        partner operation Limpar 
[        81]              ;---------------------------
[        82]     1           clear/e "TMP_NR10"
[        83]     2        End ; operation Limpar
[        85]              ;---------------------------
[        86]******        partner operation Excluir 
[        87]              ;---------------------------
[        88]     1        	setocc "TMP_NR10",-1
[        89]     2        	erase/e "TMP_NR10"
[        90]     3-1      	if ($status < 0)
[        91]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        92]     5-1      		rollback
[        93]     6-1      	elseif ($status = 1)
[        94]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        95]     8-1      	endif	
[        96]     9        End ; operation Excluir
[        98]              ;-------------------------------
[        99]******        partner operation ConsultarChave 
[       100]              ;------------------------------- 
[       101]              variables
[       102]                  string viParams,voParams
[       103]              endvariables
[       104]     1-1      if ($instancemod) & (!$foreign("TMP_NR10"))
[       105]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       106]     3-1      else 
[       107]     4-1         $status = 1
[       108]     5-1      endif
[       110]     6-1      if ($status = 1)
[       111]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       112]     8-2          if ($procerror)
[       113]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       114]    10-2          else
[       115]    11-3              if (voParams != "")
[       116]    12-3                  $collhandle("TMP_NR10")->Limpar()
[       117]    13-3                  $instancehandle->SetChave("TMP_NR10",voParams)
[       118]    14-3                  $instancehandle->LMK()
[       119]    15-4                  if ($status < 0)
[       120]    16-4                      set $keycheck("TMP_NR10",1)
[       121]    17-4                  endif
[       122]    18-3              endif
[       123]    19-2          endif
[       124]    20-1      else
[       125]    21-1          return (-1)
[       126]    22-1      endif
[       127]    23        End ; operation ConsultarChave

Trigger <DTLE> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("V_FIS_NFITEMPROD")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("V_FIS_NFITEMPROD"))
[I1:      2]     2-1      	$occhandle("V_FIS_NFITEMPROD")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("V_FIS_NFITEMPROD")->PrcOGF()

Trigger <RMO > from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=V_FIS_NFITEMPROD OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=V_FIS_NFITEMPROD OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("V_FIS_NFITEMPROD")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("V_FIS_NFITEMPROD")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=V_FIS_NFITEMPROD OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("V_FIS_NFITEMPROD")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=V_FIS_NFITEMPROD OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDK> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(V_FIS_NFITEMPROD))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(V_FIS_NFITEMPROD))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: V_FIS_NFITEMPROD.FIS

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "V_FIS_NFITEMPROD",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("V_FIS_NFITEMPROD"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "V_FIS_NFITEMPROD"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "V_FIS_NFITEMPROD"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("V_FIS_NFITEMPROD")) & ($dbocc("V_FIS_NFITEMPROD"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "V_FIS_NFITEMPROD"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "V_FIS_NFITEMPROD"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "V_FIS_NFITEMPROD"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "V_FIS_NFITEMPROD"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "V_FIS_NFITEMPROD",-1
[        90]     2        	erase/e "V_FIS_NFITEMPROD"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("V_FIS_NFITEMPROD"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("V_FIS_NFITEMPROD")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("V_FIS_NFITEMPROD",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("V_FIS_NFITEMPROD",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_FATURA.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_ITEM.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_PRODUTO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_EMPFAT.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_NF.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_SERIE.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_EMISSAO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_SAIDAENTRADA.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: TP_SITUACAO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: TP_OPERACAO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: TP_MODALIDADE.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_PESSOA.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERACAO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_REPRESENTANT.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GUIA.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_EMPTRANSACAO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_TRANSPORT.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NM_TRANSPORT.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: QT_VOLUME.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_PESOBRUTO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_PESOLIQUIDO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITBRUTO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_UNITDESC.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_UNITLIQUIDO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_TOTALBRUTO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_TOTALDESC.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_TOTALLIQUIDO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: QT_FATURADO.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_GRUPOS.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_GRUPOS.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: VL_ICMS.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CFOP.V_FIS_NFITEMPROD.FIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_ITEMADIC")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_ITEMADIC"))
[I1:      2]     2-1      	$occhandle("TRA_ITEMADIC")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_ITEMADIC")->PrcOGF()

Trigger <RMO > from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_ITEMADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_ITEMADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_ITEMADIC")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_ITEMADIC")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_ITEMADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_ITEMADIC")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_ITEMADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_ITEMADIC"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_ITEMADIC/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_ITEMADIC = "")
[I2:      4]    18-1            cd_operador.TRA_ITEMADIC/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_ITEMADIC/init = $datim
[I1:      3]    21        $occhandle("TRA_ITEMADIC")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_ITEMADIC.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_ITEMADIC.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_ITEMADIC))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_ITEMADIC))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_ITEMADIC.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_ITEMADIC",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_ITEMADIC"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_ITEMADIC"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_ITEMADIC"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_ITEMADIC")) & ($dbocc("TRA_ITEMADIC"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_ITEMADIC"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_ITEMADIC"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_ITEMADIC"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_ITEMADIC"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_ITEMADIC",-1
[        90]     2        	erase/e "TRA_ITEMADIC"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_ITEMADIC"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_ITEMADIC")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_ITEMADIC",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_ITEMADIC",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_ITEM.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.TRA_ITEMADIC.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_ITEMADIC/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_ITEMADIC = "")
[I1:      4]     4-2            cd_operador.TRA_ITEMADIC/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_ITEMADIC/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_ITEMADIC.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.TRA_ITEMADIC.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: VL_BONUSCARTAO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_SIMULADOR.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_SIMULADOR.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_UNITBRUTOORI.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_PROTOCOLO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_CHEQUEBONUS.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_VARIACAO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_ITEMVAR.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_VARIACAO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESCVAR.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_VARIACAO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_CONDPGTO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_VARCONDPGTO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASE.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_PESOBRUTO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_PESOLIQUIDO.TRA_ITEMADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TRA_TRANSACADIC")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TRA_TRANSACADIC"))
[I1:      2]     2-1      	$occhandle("TRA_TRANSACADIC")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TRA_TRANSACADIC")->PrcOGF()

Trigger <RMO > from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TRA_TRANSACADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TRA_TRANSACADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TRA_TRANSACADIC")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TRA_TRANSACADIC")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TRA_TRANSACADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TRA_TRANSACADIC")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TRA_TRANSACADIC OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TRA_TRANSACADIC"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TRA_TRANSACADIC/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TRA_TRANSACADIC = "")
[I2:      4]    18-1            cd_operador.TRA_TRANSACADIC/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TRA_TRANSACADIC/init = $datim
[I1:      3]    21        $occhandle("TRA_TRANSACADIC")->PrcVLDO()

Trigger <VLDK> from Entity: TRA_TRANSACADIC.TRA

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TRA_TRANSACADIC.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TRA_TRANSACADIC))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TRA_TRANSACADIC))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TRA_TRANSACADIC.TRA

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TRA_TRANSACADIC",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TRA_TRANSACADIC"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TRA_TRANSACADIC"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TRA_TRANSACADIC"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TRA_TRANSACADIC")) & ($dbocc("TRA_TRANSACADIC"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TRA_TRANSACADIC"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TRA_TRANSACADIC"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TRA_TRANSACADIC"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TRA_TRANSACADIC"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TRA_TRANSACADIC",-1
[        90]     2        	erase/e "TRA_TRANSACADIC"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TRA_TRANSACADIC"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TRA_TRANSACADIC")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TRA_TRANSACADIC",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TRA_TRANSACADIC",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAO.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.TRA_TRANSACADIC.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_TRANSACADIC/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_TRANSACADIC = "")
[I1:      4]     4-2            cd_operador.TRA_TRANSACADIC/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_TRANSACADIC/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TRA_TRANSACADIC.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.TRA_TRANSACADIC.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: DT_INCLUSAO.TRA_TRANSACADIC.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_INCLUSAO.TRA_TRANSACADIC.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_USUEMAIL.TRA_TRANSACADIC.TRA

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TRA_TRANSACADIC/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TRA_TRANSACADIC = "")
[I1:      4]     4-2            cd_operador.TRA_TRANSACADIC/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TRA_TRANSACADIC/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_ULTEMAIL.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_PARAULTEMAIL.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NM_CHECKOUT.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_BASEPARCELA.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPAGRUP.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_AGRUPADOR.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_DESPESA.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PESSOAPROP.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PROPRIEDADE.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_BONUSDESC.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BONUSDESC.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEBONUSDESC.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_FAMILIAR.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_SIMULADOR.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_SIMULADOR.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_TRANSACAO.TRA_TRANSACADIC.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TEF_TRANSACAO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TEF_TRANSACAO"))
[I1:      2]     2-1      	$occhandle("TEF_TRANSACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TEF_TRANSACAO")->PrcOGF()

Trigger <RMO > from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TEF_TRANSACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TEF_TRANSACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TEF_TRANSACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TEF_TRANSACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TEF_TRANSACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TEF_TRANSACAO = "")
[I2:      4]    18-1            cd_operador.TEF_TRANSACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TEF_TRANSACAO/init = $datim
[I1:      3]    21        $occhandle("TEF_TRANSACAO")->PrcVLDO()

Trigger <VLDK> from Entity: TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TEF_TRANSACAO.TEF

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TEF_TRANSACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TEF_TRANSACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TEF_TRANSACAO.TEF

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TEF_TRANSACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TEF_TRANSACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TEF_TRANSACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TEF_TRANSACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TEF_TRANSACAO")) & ($dbocc("TEF_TRANSACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TEF_TRANSACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TEF_TRANSACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TEF_TRANSACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TEF_TRANSACAO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TEF_TRANSACAO",-1
[        90]     2        	erase/e "TEF_TRANSACAO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TEF_TRANSACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TEF_TRANSACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TEF_TRANSACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TEF_TRANSACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_MOVIMENTO.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_SEQ.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.TEF_TRANSACAO.TEF

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TEF_TRANSACAO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TEF_TRANSACAO = "")
[I1:      4]     4-2            cd_operador.TEF_TRANSACAO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TEF_TRANSACAO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TEF_TRANSACAO.TEF

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.TEF_TRANSACAO.TEF

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: VL_TRANSACAO.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: HR_TRANSACAO.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAO.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_NSUAUX.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NM_REDETEF.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: TP_STATUS.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_FINALIZACAO.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DS_MENSAGEM.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_LINHASCUPOM.TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLE> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("TEF_RELTRANSACAO")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("TEF_RELTRANSACAO"))
[I1:      2]     2-1      	$occhandle("TEF_RELTRANSACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("TEF_RELTRANSACAO")->PrcOGF()

Trigger <RMO > from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=TEF_RELTRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=TEF_RELTRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("TEF_RELTRANSACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("TEF_RELTRANSACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=TEF_RELTRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("TEF_RELTRANSACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=TEF_RELTRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("TEF_RELTRANSACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.TEF_RELTRANSACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.TEF_RELTRANSACAO = "")
[I2:      4]    18-1            cd_operador.TEF_RELTRANSACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.TEF_RELTRANSACAO/init = $datim
[I1:      3]    21        $occhandle("TEF_RELTRANSACAO")->PrcVLDO()

Trigger <VLDK> from Entity: TEF_RELTRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: TEF_RELTRANSACAO.TEF

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(TEF_RELTRANSACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(TEF_RELTRANSACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: TEF_RELTRANSACAO.TEF

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "TEF_RELTRANSACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("TEF_RELTRANSACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "TEF_RELTRANSACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "TEF_RELTRANSACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("TEF_RELTRANSACAO")) & ($dbocc("TEF_RELTRANSACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "TEF_RELTRANSACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "TEF_RELTRANSACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "TEF_RELTRANSACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "TEF_RELTRANSACAO"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "TEF_RELTRANSACAO",-1
[        90]     2        	erase/e "TEF_RELTRANSACAO"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("TEF_RELTRANSACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("TEF_RELTRANSACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("TEF_RELTRANSACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("TEF_RELTRANSACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPTEF.TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_MOVIMENTO.TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: NR_SEQ.TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_EMPTRA.TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: DT_TRANSACAO.TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: U_VERSION.TEF_RELTRANSACAO.TEF

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <ERRF> from Field: CD_OPERADOR.TEF_RELTRANSACAO.TEF

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.TEF_RELTRANSACAO/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.TEF_RELTRANSACAO = "")
[I1:      4]     4-2            cd_operador.TEF_RELTRANSACAO/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.TEF_RELTRANSACAO/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.TEF_RELTRANSACAO.TEF

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)
[         5]     5-1      endif

Trigger <VLDF> from Field: DT_CADASTRO.TEF_RELTRANSACAO.TEF

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <DTLE> from Entity: F_TEF_TRANSACAO.TEF

[         1]     1        $occhandle("F_TEF_TRANSACAO")->ConsultarChave()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[         4]     4-1      elseif ($status < 0)
[         5]     5-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[         6]     6-1      else
[         7]              	;Colocar o código aqui.
[         8]     7-1      endif

Trigger <AIO > from Entity: F_TEF_TRANSACAO.TEF

[         4]     1         $instancehandle->Adicionar()
[         6]     2-1       if ($procerror)
[         7]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->Adicionar")
[         8]     4-1       endif

Trigger <HLPE> from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("F_TEF_TRANSACAO"))
[I1:      2]     2-1      	$occhandle("F_TEF_TRANSACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("F_TEF_TRANSACAO")->PrcOGF()

Trigger <RMO > from Entity: F_TEF_TRANSACAO.TEF

[         1]     1-1      if ($xCdNivel$ < 5) 
[         2]                 #include LIB_PADRAO:ENT_REMOCC_PFL
[I1:      1]     2-2      if ($editmode = 0)
[I1:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0012","","")
[I1:      3]     4-2      	reload/nolock
[I1:      4]     5-2      	return -1
[I1:      5]     6-2      else
[I1:      6]     7-2      	$instancehandle->Remover()
[I1:      7]     8-3      	if ($procerror)
[I1:      8]     9-3      		$instancehandle->SetErroProc($procerrorcontext,$xcderro$,$xctxerro$)
[I1:      9]    10-3      	else
[I1:     11]    11-3      	endif
[I1:     12]    12-2      endif
[         3]    13-1      else
[         7]    14-1          $instancehandle->Remover()
[         9]    15-2         if ($procerror)
[        10]    16-2      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->Remover")
[        11]    17-2         endif
[        12]    18-1      endif

Trigger <LOCK> from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=F_TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->LMK()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[         4]     4-1      elseif ($status < 0)
[         5]     5-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[         6]     6-1      else
[         7]              	;Colocar o código aqui.
[         8]     7-1      endif

Trigger <READ> from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=F_TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("F_TEF_TRANSACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("F_TEF_TRANSACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=F_TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("F_TEF_TRANSACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=F_TEF_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: F_TEF_TRANSACAO.TEF

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("F_TEF_TRANSACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.F_TEF_TRANSACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.F_TEF_TRANSACAO = "")
[I2:      4]    18-1            cd_operador.F_TEF_TRANSACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.F_TEF_TRANSACAO/init = $datim
[I1:      3]    21        $occhandle("F_TEF_TRANSACAO")->PrcVLDO()

Trigger <VLDK> from Entity: F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->VLDK()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[         4]     4-1      endif

Trigger <EOOP> from Entity: F_TEF_TRANSACAO.TEF

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(F_TEF_TRANSACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(F_TEF_TRANSACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: F_TEF_TRANSACAO.TEF

[         1]              ;--------------------------
[         2]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("F_TEF_TRANSACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("F_TEF_TRANSACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("F_TEF_TRANSACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("F_TEF_TRANSACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave
[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "F_TEF_TRANSACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("F_TEF_TRANSACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "F_TEF_TRANSACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APLINFO007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "F_TEF_TRANSACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("F_TEF_TRANSACAO")) & ($dbocc("F_TEF_TRANSACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "F_TEF_TRANSACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APLINFO008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APLINFO008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "F_TEF_TRANSACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APLINFO008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APLINFO001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "F_TEF_TRANSACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APLINFO003","","")
[        69]     9-3              else
[        70]    10-3                  commit
[        71]    11-4                  if ($status < 0)
[        72]    12-4                      rollback
[        73]    13-4                      return (-1) 
[        74]    14-4                  else
[        75]    15-4      				$instancehandle->SetStatus(1,"APLINFO002","","")
[        76]    16-4                  endif
[        77]    17-3              endif
[        78]    18-2          endif
[        79]    19-1      else
[        80]    20-1      	$instancehandle->SetStatus(1,"APLINFO014","","")
[        81]    21-1      endif
[        82]    22        return ($status)
[        83]    23        End ; Operation Salvar
[        85]              ;---------------------------
[        86]******        partner operation Limpar 
[        87]              ;---------------------------
[        88]     1           clear/e "F_TEF_TRANSACAO"
[        89]     2        End ; operation Limpar
[        91]              ;---------------------------
[        92]******        partner operation Excluir 
[        93]              ;---------------------------
[        94]     1        	setocc "F_TEF_TRANSACAO",-1
[        95]     2        	erase/e "F_TEF_TRANSACAO"
[        96]     3-1      	if ($status < 0)
[        97]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        98]     5-1      		rollback
[        99]     6-1      	elseif ($status = 1)
[       100]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[       101]     8-1      	endif	
[       102]     9        End ; operation Excluir

Trigger <ERRF> from Field: CD_EMPRESA.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_MOVIMENTO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQ.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_CADASTRO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <VLDF> from Field: DT_CADASTRO.F_TEF_TRANSACAO.TEF

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_ARQUIVO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_TEF.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_SITUACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_TRANSACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_REDETEF.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TRANSACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: HR_TRANSACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_NSU.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_TERMINAL.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_DOCVINC.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_NSUAUX.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_AUTORIZACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NM_REDETEF.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_STATUS.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_FINALIZACAO.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DS_MENSAGEM.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_LINHASCUPOM.F_TEF_TRANSACAO.TEF

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_GDETAIL
[I1:      1]     1        $collhandle("PES_BONUS")->ConsultarChave()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[I1:      4]     4-1      endif

Trigger <AIO > from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_ADDINSOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Adicionar ocorrência")
[I1:      3]     2        	return (-1)

Trigger <HLPE> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("PES_BONUS"))
[I1:      2]     2-1      	$occhandle("PES_BONUS")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("PES_BONUS")->PrcOGF()

Trigger <RMO > from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_REMOVEOCC
[I1:      2]     1        	$instancehandle->SetStatus(1,"APL0015","","ADICIONAL=Remover ocorrência")
[I1:      3]     2        	return (-1)

Trigger <LOCK> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=PES_BONUS OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: PES_BONUS.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_LEAVEMODKEY
[I1:      1]     1        $instancehandle->LMK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[I1:      4]     4-1      	return (-1)
[I1:      5]     5-1      elseif ($status < 0)
[I1:      6]     6-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[I1:      7]     7-1      	return (-1)
[I1:      8]     8-1      endif

Trigger <READ> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=PES_BONUS OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("PES_BONUS")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("PES_BONUS")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=PES_BONUS OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("PES_BONUS")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=PES_BONUS OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("PES_BONUS"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.PES_BONUS/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.PES_BONUS = "")
[I2:      4]    18-1            cd_operador.PES_BONUS/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.PES_BONUS/init = $datim
[I1:      3]    21        $occhandle("PES_BONUS")->PrcVLDO()

Trigger <VLDK> from Entity: PES_BONUS.PES

[         1]              #include LIB_PADRAO:DEF_VLDK
[I1:      1]     1        $instancehandle->VLDK()
[I1:      2]     2-1      if ($procerror)
[I1:      3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[I1:      4]     4-1      endif

Trigger <EOOP> from Entity: PES_BONUS.PES

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(PES_BONUS))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(PES_BONUS))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: PES_BONUS.PES

[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "PES_BONUS",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("PES_BONUS"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "PES_BONUS"
[        14]     5-2      			$instancehandle->SetStatus(1,"APL0007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "PES_BONUS"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("PES_BONUS")) & ($dbocc("PES_BONUS"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "PES_BONUS"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APL0008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "PES_BONUS"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APL0008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APL0001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "PES_BONUS"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2              return (-1)
[        67]     7-2          else
[        68]     8-3              if ($status = 1)
[        69]     9-3      			$instancehandle->SetStatus(1,"APL0003","","")
[        70]    10-3              else
[        71]    11-3      			$instancehandle->PrcCommit("")
[        72]    12-3              endif
[        73]    13-2          endif
[        74]    14-1      else
[        75]    15-1      	$instancehandle->SetStatus(1,"APL0014","","")
[        76]    16-1      endif
[        77]    17        return ($status)
[        78]    18        End ; Operation Salvar
[        80]              ;---------------------------
[        81]******        partner operation Limpar 
[        82]              ;---------------------------
[        83]     1           clear/e "PES_BONUS"
[        84]     2        End ; operation Limpar
[        86]              ;---------------------------
[        87]******        partner operation Excluir 
[        88]              ;---------------------------
[        89]     1        	setocc "PES_BONUS",-1
[        90]     2        	erase/e "PES_BONUS"
[        91]     3-1      	if ($status < 0)
[        92]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        93]     5-1      		rollback
[        94]     6-1              return (-1)
[        95]     7-1      	elseif ($status = 1)
[        96]     8-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[        97]     9-1      	endif	
[        98]    10        End ; operation Excluir
[       100]              ;-------------------------------
[       101]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("PES_BONUS"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("PES_BONUS")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("PES_BONUS",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("PES_BONUS",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave

Trigger <ERRF> from Field: CD_EMPRESA.PES_BONUS.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PESSOA.PES_BONUS.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_BONUS.PES_BONUS.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.PES_BONUS.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERADOR.PES_BONUS.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_OPERADOR
[I1:      2]     2-1        cd_operador.PES_BONUS/init = $$GCDUSUARIO
[I1:      3]     3-2        if (cd_operador.PES_BONUS = "")
[I1:      4]     4-2            cd_operador.PES_BONUS/init = 1
[I1:      5]     5-2        endif
[I1:      6]     6-1        dt_cadastro.PES_BONUS/init = $datim
[         3]     7-1      else
[         4]     8-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     9-1      endif

Trigger <ERRF> from Field: DT_CADASTRO.PES_BONUS.PES

[         1]     1-1      if ($error = 129)
[         2]                  #include LIB_PADRAO:SET_DATA 
[I1:      1]     2-1      @$fieldname = $datim
[         3]     3-1      else
[         4]     4-1          $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")
[         5]     5-1      endif

Trigger <ERRF> from Field: VL_BONUS.PES_BONUS.PES

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLE> from Entity: F_TRA_TRANSACAO.TRA

[         1]     1        $occhandle("F_TRA_TRANSACAO")->ConsultarChave()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->ConsultarChave")
[         4]     4-1      elseif ($status < 0)
[         5]     5-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[         6]     6-1      else
[         7]              	;Colocar o código aqui.
[         8]     7-1      endif

Trigger <AIO > from Entity: F_TRA_TRANSACAO.TRA

[         4]     1         $instancehandle->Adicionar()
[         6]     2-1       if ($procerror)
[         7]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->Adicionar")
[         8]     4-1       endif

Trigger <HLPE> from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_FHELP
[I1:      1]     1        	$instancehandle->Ajuda()
[I1:      2]     2-1      	if ($procerror)
[I1:      3]     3-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"")
[I1:      4]     4-1      	endif

Trigger <OGF > from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_OCCBECCUR
[I1:      1]     1-1      if (!$dbocc("F_TRA_TRANSACAO"))
[I1:      2]     2-1      	$occhandle("F_TRA_TRANSACAO")->VlrIniOGF()
[I1:      3]     3-1      endif
[I1:      4]     4        $occhandle("F_TRA_TRANSACAO")->PrcOGF()

Trigger <RMO > from Entity: F_TRA_TRANSACAO.TRA

[         1]     1-1      if ($xCdNivel$ < 5) 
[         2]                 #include LIB_PADRAO:ENT_REMOCC_PFL
[I1:      1]     2-2      if ($editmode = 0)
[I1:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0012","","")
[I1:      3]     4-2      	reload/nolock
[I1:      4]     5-2      	return -1
[I1:      5]     6-2      else
[I1:      6]     7-2      	$instancehandle->Remover()
[I1:      7]     8-3      	if ($procerror)
[I1:      8]     9-3      		$instancehandle->SetErroProc($procerrorcontext,$xcderro$,$xctxerro$)
[I1:      9]    10-3      	else
[I1:     11]    11-3      	endif
[I1:     12]    12-2      endif
[         3]    13-1      else
[         7]    14-1          $instancehandle->Remover()
[         9]    15-2         if ($procerror)
[        10]    16-2      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->Remover")
[        11]    17-2         endif
[        12]    18-1      endif

Trigger <LOCK> from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_LOCK
[I1:     11]     1         lock
[I1:     12]     2         if ($status = -10) reload
[I1:     13]               #include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     5-1      if ($procerror) & ($procerror != -8)
[I2:      2]     6-1          $xCdErro$  = $procerror
[I2:      3]     7-1          $xCtxErro$ = "TRIGGER=LOCK ENTIDADE=F_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     8-1      endif

Trigger <ERRE> from Entity: F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <LMK > from Entity: F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->LMK()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operacao->LMK")
[         4]     4-1      elseif ($status < 0)
[         5]     5-1      	$instancehandle->SetStatus("",$xcderro$,$xctxerro$,"")
[         6]     6-1      else
[         7]              	;Colocar o código aqui.
[         8]     7-1      endif

Trigger <READ> from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_READ
[I1:      1]     1        read
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=READ ENTIDADE=F_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      else
[I1:      5]     8-1      	$occhandle("F_TRA_TRANSACAO")->PosREAD()
[I1:      6]     9-1      endif

Trigger <WRIT> from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_WRITE
[I1:      1]     1        $occhandle("F_TRA_TRANSACAO")->PreWRITE()
[I1:      2]     2        write
[I1:      3]     3-1      if ($status < 0)
[I1:      4]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     4-2      if ($procerror) & ($procerror != -8)
[I2:      2]     5-2          $xCdErro$  = $procerror
[I2:      3]     6-2          $xCtxErro$ = "TRIGGER=WRIT ENTIDADE=F_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     7-2      endif
[I1:      5]     8-1      else
[I1:      6]     9-1      	$occhandle("F_TRA_TRANSACAO")->PosWRITE()
[I1:      7]    10-1      endif

Trigger <DELE> from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_DELETE
[I1:      1]     1        delete
[I1:      2]     2-1      if ($status < 0)
[I1:      3]              	#include LIB_PADRAO:ZSET_CTXERRO
[I2:      1]     3-2      if ($procerror) & ($procerror != -8)
[I2:      2]     4-2          $xCdErro$  = $procerror
[I2:      3]     5-2          $xCtxErro$ = "TRIGGER=DELE ENTIDADE=F_TRA_TRANSACAO OCORRENCIA=%%$curocc COMPONENTE=%%$componentname"
[I2:      4]     6-2      endif
[I1:      4]     7-1      endif

Trigger <VLDO> from Entity: F_TRA_TRANSACAO.TRA

[         1]              #include LIB_PADRAO:DEF_VLDO
[I1:      1]              #include LIB_PADRAO:VLD_NIVEL_USR
[I2:     14]     1-1      			if ($dbocc("F_TRA_TRANSACAO"))
[I2:     15]              				#include LIB_PADRAO:ENT_MODIFY_PFL
[I3:      1]     2-2      if ($xCdNivel$< 4) & ($editmode = 0) 
[I3:      2]     3-2      	$instancehandle->SetStatus(-1,"APL0011","","")
[I3:      3]     4-2      	reload/nolock
[I3:      4]     5-2      	return -1
[I3:      5]     6-2      endif  
[I2:     16]     7-1      			else
[I2:     17]     8-2      				if ($xCdNivel$ < 3)
[I2:     18]              					#include LIB_PADRAO:ENT_ADDOCC_PFL
[I3:      1]     9-3      if ($xCdNivel$< 3) & ($editmode = 0) 
[I3:      2]    10-3      	$instancehandle->SetStatus(-1,"APL0010","","")
[I3:      3]    11-3      	remocc $entname
[I3:      4]    12-3      	return -1
[I3:      5]    13-3      endif
[I2:     19]    14-2      				endif
[I2:     20]    15-1      			endif
[I1:      2]              #include LIB_PADRAO:SET_OPERADOR
[I2:      2]    16          cd_operador.F_TRA_TRANSACAO/init = $$GCDUSUARIO
[I2:      3]    17-1        if (cd_operador.F_TRA_TRANSACAO = "")
[I2:      4]    18-1            cd_operador.F_TRA_TRANSACAO/init = 1
[I2:      5]    19-1        endif
[I2:      6]    20          dt_cadastro.F_TRA_TRANSACAO/init = $datim
[I1:      3]    21        $occhandle("F_TRA_TRANSACAO")->PrcVLDO()

Trigger <VLDK> from Entity: F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->VLDK()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"ADICIONAL=Operação->VLDK")
[         4]     4-1      endif

Trigger <EOOP> from Entity: F_TRA_TRANSACAO.TRA

[         1]              ;------------------------
[         2]******        partner operation PrcVLDO 
[         3]              ;------------------------
[         4]              ;if ($dbocc(F_TRA_TRANSACAO))
[         6]              ;else
[         8]              ;endif
[         9]     1        End ; operation PrcVLDO
[        11]              ;-----------------------
[        12]******        partner operation PrcOGF 
[        13]              ;-----------------------
[        14]              ;if ($dbocc(F_TRA_TRANSACAO))
[        16]              ;else
[        18]              ;endif
[        19]     1        End ; operation PrcOGF
[        21]              ;-----------------------------
[        22]******        partner operation posADDINSERT 
[        23]              ;-----------------------------
[        25]     1        End ; operation posADDINSERT
[        27]              ;------------------------
[        28]******        partner operation posREAD 
[        29]              ;------------------------
[        31]     1        End ; operation posREAD
[        33]              ;--------------------------
[        34]******        partner operation preREMOVE 
[        35]              ;--------------------------
[        37]     1        End ; operation preREMOVE
[        39]              ;-------------------------
[        40]******        partner operation preWRITE 
[        41]              ;-------------------------
[        43]     1        End ; operation preWRITE
[        45]              ;-------------------------
[        46]******        partner operation posWRITE 
[        47]              ;-------------------------
[        49]     1        End ; operation posWRITE

Trigger <ECOP> from Entity: F_TRA_TRANSACAO.TRA

[         1]              ;--------------------------
[         2]******        partner operation ConsultarChave 
[       102]              ;------------------------------- 
[       103]              variables
[       104]                  string viParams,voParams
[       105]              endvariables
[       106]     1-1      if ($instancemod) & (!$foreign("F_TRA_TRANSACAO"))
[       107]     2-1          askmess "Existem manutenções pendentes. Deseja Consultar e perder as alterações?","Consultar,Cancelar" 
[       108]     3-1      else 
[       109]     4-1         $status = 1
[       110]     5-1      endif
[       112]     6-1      if ($status = 1)
[       113]     7-1          activate "".EXEC(viParams,voParams,$xcs$,$xlcs$)
[       114]     8-2          if ($procerror)
[       115]     9-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"MSG=.EXEC")
[       116]    10-2          else
[       117]    11-3              if (voParams != "")
[       118]    12-3                  $collhandle("F_TRA_TRANSACAO")->Limpar()
[       119]    13-3                  $instancehandle->SetChave("F_TRA_TRANSACAO",voParams)
[       120]    14-3                  $instancehandle->LMK()
[       121]    15-4                  if ($status < 0)
[       122]    16-4                      set $keycheck("F_TRA_TRANSACAO",1)
[       123]    17-4                  endif
[       124]    18-3              endif
[       125]    19-2          endif
[       126]    20-1      else
[       127]    21-1          return (-1)
[       128]    22-1      endif
[       129]    23        End ; operation ConsultarChave
[         1]              ;--------------------------
[         2]******        partner operation Adicionar 
[         3]              ;--------------------------
[         4]     1           creocc "F_TRA_TRANSACAO",-1
[         5]     2        End ; operation Adicionar
[         7]              ;--------------------------
[         8]******        partner operation Remover 
[         9]              ;--------------------------
[        10]     1-1         if ($dbocc("F_TRA_TRANSACAO"))
[        11]     2-1              askmess "Deseja realmente remover o registro do banco de dados?","Remover,Cancelar"
[        12]     3-2              if ($status = 1) 
[        13]     4-2                  remocc "F_TRA_TRANSACAO"
[        14]     5-2      			$instancehandle->SetStatus(1,"APLINFO007","","")
[        15]     6-2              else
[        16]     7-2                  return (-1)
[        17]     8-2              endif
[        18]     9-1         else
[        19]    10-1              remocc "F_TRA_TRANSACAO"
[        20]    11-1         endif 
[        21]    12           return ($status)
[        22]    13        End ; operation Remover
[        24]              ;-------------------------
[        25]******        partner Operation Consultar 
[        26]              ;-------------------------
[        27]     1-1        if ($occmod("F_TRA_TRANSACAO")) & ($dbocc("F_TRA_TRANSACAO"))
[        28]     2-1            askmess "Existem manutenções pendentes.Deseja consultar e perder as alterações?","Consultar,Cancelar" 
[        29]     3-2            if ($status = 1)
[        30]     4-2                retrieve/e "F_TRA_TRANSACAO"
[        31]     5-3                if ($procerror)
[        32]     6-4                    if ($procerror = -2)
[        33]     7-4      					$instancehandle->SetStatus(1,"APLINFO008","","")
[        34]     8-4                    else
[        35]     9-4      				  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        36]    10-4                    endif
[        37]    11-3                else
[        38]    12-3      				$instancehandle->SetStatus(1,"APLINFO008","","")
[        39]    13-3                endif
[        40]    14-2            else
[        41]    15-2                return (-1) 
[        42]    16-2            endif
[        43]    17-1        else
[        44]    18-1            retrieve/e "F_TRA_TRANSACAO"
[        45]    19-2            if ($procerror)
[        46]    20-3                if ($procerror = -2)
[        47]    21-3      				$instancehandle->SetStatus(1,"APLINFO008","","")
[        48]    22-3                else
[        49]    23-3      			  $instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        50]    24-3                endif
[        51]    25-2            else
[        52]    26-2      		$instancehandle->SetStatus(1,"APLINFO001","","")
[        53]    27-2            endif
[        54]    28-1        endif
[        55]    29          return ($status)
[        56]    30        End ; Operation Consultar
[        58]              ;-------------------------
[        59]******        partner Operation Salvar 
[        60]              ;-------------------------
[        61]     1-1      if ($editmode = 0)
[        62]     2-1          store/e/complete "F_TRA_TRANSACAO"
[        63]     3-2          if ($status < 0)
[        64]     4-2      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=$xctxerro$")
[        65]     5-2              rollback
[        66]     6-2          else
[        67]     7-3              if ($status = 1)
[        68]     8-3      			$instancehandle->SetStatus(1,"APLINFO003","","")
[        69]     9-3              else
[        70]    10-3                  commit
[        71]    11-4                  if ($status < 0)
[        72]    12-4                      rollback
[        73]    13-4                      return (-1) 
[        74]    14-4                  else
[        75]    15-4      				$instancehandle->SetStatus(1,"APLINFO002","","")
[        76]    16-4                  endif
[        77]    17-3              endif
[        78]    18-2          endif
[        79]    19-1      else
[        80]    20-1      	$instancehandle->SetStatus(1,"APLINFO014","","")
[        81]    21-1      endif
[        82]    22        return ($status)
[        83]    23        End ; Operation Salvar
[        85]              ;---------------------------
[        86]******        partner operation Limpar 
[        87]              ;---------------------------
[        88]     1           clear/e "F_TRA_TRANSACAO"
[        89]     2        End ; operation Limpar
[        91]              ;---------------------------
[        92]******        partner operation Excluir 
[        93]              ;---------------------------
[        94]     1        	setocc "F_TRA_TRANSACAO",-1
[        95]     2        	erase/e "F_TRA_TRANSACAO"
[        96]     3-1      	if ($status < 0)
[        97]     4-1      		$instancehandle->SetStatus(-1,$procerror,$procerrorcontext,"LOG=%%$xctxerro$")
[        98]     5-1      		rollback
[        99]     6-1      	elseif ($status = 1)
[       100]     7-1      		$instancehandle->SetStatus(-1,"ENT0001","","")
[       101]     8-1      	endif	
[       102]     9        End ; operation Excluir

Trigger <ERRF> from Field: CD_EMPRESA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: U_VERSION.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_PESSOA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_OPERACAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_CONDPGTO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPFAT.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_GRUPOEMPRESA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_MODELOTRA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <VLDF> from Field: CD_MODELOTRA.F_TRA_TRANSACAO.TRA

[         1]     1        fieldvideo $fieldname, "COL=0"
[         2]     2-1      if ($dbocc($entname))
[         4]     3-1      else
[         6]     4-1      endif

Trigger <ERRF> from Field: CD_OPERADOR.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_CADASTRO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_SITUACAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_ORIGEMEMISSAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_SEQENDERECO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_EMPRESAORI.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_TRANSACAOORI.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_TRANSACAOORI.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USURELAC.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUCONF.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_GUIA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_REPRESENTANT.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_COMPVEND.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: CD_USUIMPRESSAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_IMPRESSAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: NR_IMPRESSAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: TP_OPERACAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_FRETE.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: IN_ACEITADEV.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: PR_DESCONTO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: QT_SOLICITADA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_PREVENTREGA.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_VALIDADE.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: DT_ULTATEND.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TRANSACAO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESCONTO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_DESPACESSOR.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_FRETE.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_SEGURO.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEICMS.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ICMS.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_BASEICMSSUBST.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_ICMSSUBST.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_IPI.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <ERRF> from Field: VL_TOTAL.F_TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: BT_LTRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        $prompt = NR_TRANSACAO.TRA_TRANSACAO
[         2]     2        macro "^DETAIL"

Trigger <DTLF> from Field: DS_CAIXA.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: DS_CAIXA.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: DS_TERMINAL.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: DS_TERMINAL.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: DS_CONFERENTE.TRA_TRANSACAO.TRA

[         1]              variables
[         2]              	string viparams,voParams
[         3]              endvariables
[         5]     1        $keyboard = "KB_GLOBAL"
[         6]     2        activate "GERFM039".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[         7]     3        $keyboard = "KB_PDV"
[         8]     4-1      if ($procerror)
[         9]     5-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        10]     6-1      	return(-1)
[        11]     7-1      endif
[        13]     8-1      if($status >= 0)
[        14]     9-1      	$dsConferente$ = $item("DS_CONFERENTE", voParams)
[        15]    10-1      	DS_CONFERENTE.TRA_TRANSACAO/init = $dsConferente$
[        16]    11-1      	$prompt = CD_AUXILIAR.PES_VENDEDOR
[        17]    12-1      endif
[        19]    13        return (0)

Trigger <ERRF> from Field: DS_CONFERENTE.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: TP_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <NFLD> from Field: TP_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1        $prompt = CD_AUXILIAR.PES_VENDEDOR
[         3]     2        return(0)

Trigger <FGF > from Field: TP_TRANSACAO.TRA_TRANSACAO.TRA

[         1]              variables
[         2]              	string vDsPropriedade
[         3]              endvariables
[         5]     1-1      if ($qtOperacao$ <= 1)
[         6]     2-1      	macro "^NEXT_FIELD"
[         7]     3-1      endif
[         8]              ;$fieldproperties(TP_TRANSACAO.TRA_TRANSACAO) = "columns=2"
[        10]     4        return(0)

Trigger <VALC> from Field: TP_TRANSACAO.TRA_TRANSACAO.TRA

[         1]     1-1      selectcase TP_TRANSACAO.TRA_TRANSACAO
[         2]     2-1      	case 1
[         3]     3-1      		CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoVenda$
[         4]     4-1      	case 2
[         5]     5-1      		CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoValeTroca$
[         6]     6-1      	case 3
[         7]     7-1      		CD_OPERACAO.TRA_TRANSACAO/init = $cdOperacaoTroca$
[         8]     8-1      endselectcase
[        10]     9        return(0)

Trigger <DTLF> from Field: BT_LVENDEDOR.TRA_TRANSACAO.TRA

[         1]     1        $prompt = CD_AUXILIAR.PES_VENDEDOR
[         2]     2        macro "^DETAIL"

Trigger <DTLF> from Field: TP_ALTERAITEM.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: TP_ALTERAITEM.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: TP_INCLUSAO.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: TP_INCLUSAO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: TP_FOCO.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: TP_FOCO.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: CD_CFOP.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: CD_CFOP.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: CD_CST.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <ERRF> from Field: CD_CST.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: BT_BARRAPRD.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_BRUTO.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_PR.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_DESC.TRA_TRANSACAO.TRA

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_MOSTRATOTAL.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->mostraTotal()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_PORTAL.TRA_TRANSACAO.TRA

[         1]     1        $instancehandle->portal()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      	return (-1)
[         5]     5-1      endif    
[         7]     6        return(0)

Trigger <DTLF> from Field: BT_NRITEM.SIS_BOTOES2.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_PRODUTO.SIS_BOTOES2.SIS

[         2]     1-1      if ($dsOrdem$ = "CD_PRODUTO.TRA_TRANSITEM")
[         3]     2-1      	$dsOrdem$ = "CD_PRODUTO.TRA_TRANSITEM desc"
[         4]     3-1      else
[         5]     4-1      	$dsOrdem$ = "CD_PRODUTO.TRA_TRANSITEM"
[         6]     5-1      endif
[         8]     6        sort/e "TRA_TRANSITEM", $dsOrdem$
[        10]     7        $prompt = NR_ITEM.TRA_TRANSITEM
[        12]     8        return(0)

Trigger <DTLF> from Field: BT_VENDEDOR.SIS_BOTOES2.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_ESPECIE.SIS_BOTOES2.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_QTSOLICITADA.SIS_BOTOES2.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_VLUNITARIO.SIS_BOTOES2.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_TITULO.SIS_BOTOES2.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_LTRANSACAO.SIS_BOTOES2.SIS

[         1]     1        $prompt = NR_ITEM.TRA_TRANSITEM
[         2]     2        macro "^DETAIL"

Trigger <DTLF> from Field: CD_AUXILIAR.PES_VENDEDOR.PES

[         1]              variables
[         2]              	string viParams, voParams
[         3]              endvariables
[         5]     1        viParams = ""
[         6]     2        putitem/id viParams, "CD_EMPRESA", CD_EMPRESA.TRA_TRANSACAO
[         7]     3        $keyboard = "KB_GLOBAL"
[         8]     4        activate "PESFL011".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[         9]     5        $keyboard = "KB_PDV"
[        10]     6-1      if ($procerror)       
[        11]     7-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        12]     8-1      	return(-1)
[        13]     9-1      endif    
[        15]    10-1      if ($status < 0)
[        16]    11-1      	return(-1)
[        17]    12-1      endif
[        19]    13        CD_AUXILIAR.PES_VENDEDOR = $item("CD_AUXILIAR", voParams)
[        21]    14        return(0)

Trigger <NFLD> from Field: CD_AUXILIAR.PES_VENDEDOR.PES

[         1]     1        $instancehandle->validaVendedor()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif
[         6]     5-1      if ($status < 0)
[         7]     6-1      	return(-1)
[         8]     7-1      endif
[        10]     8        $instancehandle->BT_05()
[        11]     9-1      if ($procerror)
[        12]    10-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        13]    11-1      endif    
[        15]    12        return(0)

Trigger <DTLF> from Field: BT_CODIGO.SIS_FILTRO.SIS

[         1]     1-1      if (IN_CODIGO.SIS_FILTRO = "T")
[         2]     2-1      	IN_CODIGO.SIS_FILTRO = "F"
[         3]     3-1      	BT_CODIGO.SIS_FILTRO = "%Validar código barras"
[         4]     4-1      else
[         5]     5-1      	IN_CODIGO.SIS_FILTRO = "T"
[         6]     6-1      	BT_CODIGO.SIS_FILTRO = "%Validar código produto"
[         7]     7-1      endif
[         9]     8        $prompt = CD_BARRAPRD.SIS_FILTRO
[        11]     9        return(0)

Trigger <DTLF> from Field: BT_QUANTIDADE.SIS_FILTRO.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: CD_BARRAPRD.SIS_FILTRO.SIS

[         1]              variables
[         2]              	string  viParams, voParams
[         3]              endvariables
[         5]     1        $keyboard = "KB_GLOBAL"
[         6]              ;---Elia Proj. 115/4 11/10/07
[         7]     2-1      if ($inHomologacaoAm$ = "T") 
[         8]     3-1      	activate "PRDFL010".exec(viParams, voParams, $xCdErro$, $xCtxErro$)
[         9]     4-1      elseif ($tpConsultaPrdPdv$ = 1) | ($tpConsultaPrdPdv$ = 2) | ($tpconsultaprdpdv$ = 11)
[        10]     5-2      	if ($tpConsultaPrdPdv$ = 1)
[        11]     6-2      		putitem/id viParams, "IN_SEMSALDO", "T"
[        12]     7-2      	endif
[        14]     8-2      	if ($tpconsultaprdpdv$ = 11) ;<ANO Pjt130 Trf1049 - 26/04/2010
[        15]     9-2      		putitem/id viParams, "IN_VALIDALOCAL", "F"
[        16]    10-2      	endif
[        17]    11-1      	activate "PRDFL054".exec(viParams, voParams, $xCdErro$, $xCtxErro$)
[        18]    12-1      elseif ($tpConsultaPrdPdv$ = 3)
[        19]    13-1      	activate "PRDFL105".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[        20]    14-1      elseif ($tpConsultaPrdPdv$ = 4)
[        21]    15-1      	activate "PRDFL044".exec(viParams, voParams, $xCdErro$, $xCtxErro$) ;
[        22]    16-1      else
[        23]    17-1      	activate "PRDFL001".EXEC(viParams, voParams, $xCdErro$, $xCtxErro$)
[        24]    18-1      endif
[        25]              ;
[        26]    19-1      if ($procerror)
[        27]    20-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        28]    21-1      endif
[        29]    22        $keyboard = "KB_PDV"
[        31]    23-1      if (voParams != "")
[        32]    24-1      	getItem/id CD_BARRAPRD.SIS_FILTRO, voParams , "CD_PRODUTO"
[        33]    25-1      endif
[        35]    26        IN_CODIGO.SIS_FILTRO = "T"
[        36]    27        BT_CODIGO.SIS_FILTRO = "%Validar código produto"
[        39]    28        return(0)

Trigger <NFLD> from Field: CD_BARRAPRD.SIS_FILTRO.SIS

[         1]     1        $instancehandle->validaItem()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_LCDBARRAPRD.SIS_FILTRO.SIS

[         1]     1        $prompt = CD_BARRAPRD.SIS_FILTRO
[         2]     2        macro "^DETAIL"

Trigger <DTLF> from Field: IN_CODIGO.SIS_FILTRO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: IN_CODIGO.SIS_FILTRO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <VALC> from Field: IN_CODIGO.SIS_FILTRO.SIS

[         1]     1        $prompt = CD_BARRAPRD.SIS_FILTRO
[         3]     2        return(0)

Trigger <DTLF> from Field: QT_SOLICITADA.SIS_FILTRO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: QT_SOLICITADA.SIS_FILTRO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <NFLD> from Field: QT_SOLICITADA.SIS_FILTRO.SIS

[         1]     1        $instancehandle->validaQuantidade()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif
[         6]     5        $prompt = CD_BARRAPRD.SIS_FILTRO
[         8]     6        return(0)

Trigger <VALC> from Field: QT_SOLICITADA.SIS_FILTRO.SIS

[         1]     1        QT_SOLICITADA.SIS_FILTRO = $abs(QT_SOLICITADA.SIS_FILTRO)
[         3]     2        return(0)

Trigger <AIO > from Entity: DETALHE.SIS

[         1]     1        return (-1)

Trigger <RMO > from Entity: DETALHE.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: CD_BARRAPRD.DETALHE.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: CD_BARRAPRD.DETALHE.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: VL_UNITBRUTO.DETALHE.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_UNITBRUTO.DETALHE.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: PR_DESCONTO.DETALHE.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: PR_DESCONTO.DETALHE.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: VL_UNITDESC.DETALHE.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_UNITDESC.DETALHE.SIS

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: CD_PRODUTO.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: CD_PRODUTO.SIS_PRODUTO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: DS_PRODUTO.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: DS_PRODUTO.SIS_PRODUTO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: BT_QTSOLICITADA.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_VLUNITARIO.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: BT_VLTOTAL.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <DTLF> from Field: QT_SOLICITADA.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: QT_SOLICITADA.SIS_PRODUTO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: VL_UNITARIO.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_UNITARIO.SIS_PRODUTO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: VL_TOTAL.SIS_PRODUTO.SIS

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_TOTAL.SIS_PRODUTO.SIS

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: DS_PRODUTO.TMP_NR10.TMP

[         1]     1        return (-1)

Trigger <ERRF> from Field: DS_PRODUTO.TMP_NR10.TMP

[         1]     1        $instancehandle->SetErroVldFld($dataerrorcontext,$xCdErro$,$xCtxErro$)

Trigger <DTLF> from Field: QT_DESCONTO.TMP_NR10.TMP

[         1]     1        return (-1)

Trigger <DTLF> from Field: VL_UNITARIO.TMP_NR10.TMP

[         1]     1        return (-1)

Trigger <ERRF> from Field: VL_UNITARIO.TMP_NR10.TMP

[         1]     1        $instancehandle->SetStatus(-1,$error,$dataerrorcontext,"")

Trigger <DTLF> from Field: BT_F2.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_02()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_F3.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_03()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_F4.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_04()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_F5.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_05()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_F11.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_11()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif
[         5]     5-1      if($status < 0)
[         6]              	;---Elia Proj. 133/007 15/08/08
[         7]     6-1      	$instancehandle->recarregaTransacao()
[         8]     7-2      	if ($procerror)
[         9]     8-2      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        10]     9-2      	endif	
[        11]              	;
[        12]    10-1      	$prompt = TP_TRANSACAO.TRA_TRANSACAO	
[        13]    11-1      endif    
[        15]    12        return(0)

Trigger <DTLF> from Field: BT_F6.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_06()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]              ;--- Elia 16/09/2010 Proj. 156/408
[         7]     5-1      if ($status < 0)
[         8]     6-1      	$instancehandle->recarregaTransacao()
[         9]     7-2      	if ($procerror)
[        10]     8-2      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        11]     9-2      	endif    
[        12]    10-1      endif
[        13]              ;
[        15]    11        return(0)

Trigger <DTLF> from Field: BT_F7.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_07()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         5]              ;thamati 12/05/2010 [Proj. 0156 - Tar. 0305]
[         6]     5-1      if ($status < 0)
[         7]     6-1      	$instancehandle->recarregaTransacao()
[         8]     7-2      	if ($procerror)
[         9]     8-2      		$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[        10]     9-2      	endif    
[        11]    10-1      endif
[        12]              ;
[        14]    11        return(0)

Trigger <DTLF> from Field: BT_F8.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_08()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_F9.SIS_BOTOES.SIS

[         1]     1        $instancehandle->BT_09()
[         2]     2-1      if ($procerror)
[         3]     3-1      	$instancehandle->SetStatus(-1, $procerror, $procerrorcontext, "")
[         4]     4-1      endif    
[         6]     5        return(0)

Trigger <DTLF> from Field: BT_ESC.SIS_BOTOES.SIS

[         1]     1        macro "^QUIT"
[         3]     2        return(0)
